<!DOCTYPE html> <html><head>
		<title>Portable Executable - Formato PE</title>
		<base href="..\..\..\..\../">
		<meta id="root-path" root-path="..\..\..\..\../">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=1.0, maximum-scale=5.0">
		<meta charset="UTF-8">
		<meta name="description" content="Hacking - Portable Executable - Formato PE">
		<meta property="og:title" content="Portable Executable - Formato PE">
		<meta property="og:description" content="Hacking - Portable Executable - Formato PE">
		<meta property="og:type" content="website">
		<meta property="og:url" content="https://dobliuw.com/notes/3.-system/global-concepts/executable-formats/windows/portable-executable-formato-pe.html">
		<meta property="og:image" content="https://dobliuw.com/lib/media/pe_format.png">
		<meta property="og:site_name" content="Hacking">
		<meta name="author" content="Dobliuw"><link rel="alternate" type="application/rss+xml" title="RSS Feed" href="https://dobliuw.com/lib/rss.xml"><script async="" id="webpage-script" src="lib/scripts/webpage.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script type="module" async="" id="graph-view-script" src="lib/scripts/graph-view.js"></script><script async="" id="graph-wasm-script" src="lib/scripts/graph-wasm.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="graph-render-worker-script" src="lib/scripts/graph-render-worker.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="tinycolor-script" src="lib/scripts/tinycolor.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="pixi-script" src="lib/scripts/pixi.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="minisearch-script" src="lib/scripts/minisearch.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><link rel="icon" href="lib/media/favicon.png"><script async="" id="graph-data-script" src="lib/scripts/graph-data.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><style>body{--line-width:40em;--line-width-adaptive:40em;--file-line-width:40em;--sidebar-width:min(20em, 80vw);--collapse-arrow-size:11px;--tree-horizontal-spacing:0.6em;--tree-vertical-spacing:0.6em;--sidebar-margin:12px}.sidebar{height:100%;min-width:calc(var(--sidebar-width) + var(--divider-width-hover));max-width:calc(var(--sidebar-width) + var(--divider-width-hover));font-size:14px;z-index:10;position:relative;overflow:hidden;transition:min-width ease-in-out,max-width ease-in-out;transition-duration:.2s;contain:size}.sidebar-left{left:0}.sidebar-right{right:0}.sidebar.is-collapsed{min-width:0;max-width:0}body.floating-sidebars .sidebar{position:absolute}.sidebar-content{height:100%;min-width:calc(var(--sidebar-width) - var(--divider-width-hover));top:0;padding:var(--sidebar-margin);padding-top:4em;line-height:var(--line-height-tight);background-color:var(--background-secondary);transition:background-color,border-right,border-left,box-shadow;transition-duration:var(--color-fade-speed);transition-timing-function:ease-in-out;position:absolute;display:flex;flex-direction:column}.sidebar:not(.is-collapsed) .sidebar-content{min-width:calc(max(100%,var(--sidebar-width)) - 3px);max-width:calc(max(100%,var(--sidebar-width)) - 3px)}.sidebar-left .sidebar-content{left:0;border-top-right-radius:var(--radius-l);border-bottom-right-radius:var(--radius-l)}.sidebar-right .sidebar-content{right:0;border-top-left-radius:var(--radius-l);border-bottom-left-radius:var(--radius-l)}.sidebar:has(.sidebar-content:empty):has(.topbar-content:empty){display:none}.sidebar-topbar{height:2em;width:var(--sidebar-width);top:var(--sidebar-margin);padding-inline:var(--sidebar-margin);z-index:1;position:fixed;display:flex;align-items:center;transition:width ease-in-out;transition-duration:inherit}.sidebar.is-collapsed .sidebar-topbar{width:calc(2.3em + var(--sidebar-margin) * 2)}.sidebar .sidebar-topbar.is-collapsed{width:0}.sidebar-left .sidebar-topbar{left:0}.sidebar-right .sidebar-topbar{right:0}.topbar-content{overflow:hidden;overflow:clip;width:100%;height:100%;display:flex;align-items:center;transition:inherit}.sidebar.is-collapsed .topbar-content{width:0;transition:inherit}.clickable-icon.sidebar-collapse-icon{background-color:transparent;color:var(--icon-color-focused);padding:0!important;margin:0!important;height:100%!important;width:2.3em!important;margin-inline:0.14em!important;position:absolute}.sidebar-left .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);right:var(--sidebar-margin)}.sidebar-right .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);left:var(--sidebar-margin)}.clickable-icon.sidebar-collapse-icon svg.svg-icon{width:100%;height:100%}.sidebar-section-header{margin:0 0 1em 0;text-transform:uppercase;letter-spacing:.06em;font-weight:600}body{transition:background-color var(--color-fade-speed) ease-in-out}.webpage-container{display:flex;flex-direction:row;height:100%;width:100%;align-items:stretch;justify-content:center}.document-container{opacity:1;flex-basis:100%;max-width:100%;width:100%;height:100%;display:flex;flex-direction:column;align-items:center;transition:opacity .2s ease-in-out;contain:inline-size}.hide{opacity:0;transition:opacity .2s ease-in-out}.document-container>.markdown-preview-view{margin:var(--sidebar-margin);margin-bottom:0;width:100%;width:-webkit-fill-available;width:-moz-available;width:fill-available;background-color:var(--background-primary);transition:background-color var(--color-fade-speed) ease-in-out;border-top-right-radius:var(--window-radius,var(--radius-m));border-top-left-radius:var(--window-radius,var(--radius-m));overflow-x:hidden!important;overflow-y:auto!important;display:flex!important;flex-direction:column!important;align-items:center!important;contain:inline-size}.document-container>.markdown-preview-view>.markdown-preview-sizer{padding-bottom:80vh!important;width:100%!important;max-width:var(--line-width)!important;flex-basis:var(--line-width)!important;transition:background-color var(--color-fade-speed) ease-in-out;contain:inline-size}.markdown-rendered img:not([width]),.view-content img:not([width]){max-width:100%;outline:0}.document-container>.view-content.embed{display:flex;padding:1em;height:100%;width:100%;align-items:center;justify-content:center}.document-container>.view-content.embed>*{max-width:100%;max-height:100%;object-fit:contain}:has(> :is(.math,table)){overflow-x:auto!important}.document-container>.view-content{overflow-x:auto;contain:content;padding:0;margin:0;height:100%}.scroll-highlight{position:absolute;width:100%;height:100%;pointer-events:none;z-index:1000;background-color:hsla(var(--color-accent-hsl),.25);opacity:0;padding:1em;inset:50%;translate:-50% -50%;border-radius:var(--radius-s)}</style><script defer="">async function loadIncludes(){if("file:"!=location.protocol){let e=document.querySelectorAll("include");for(let t=0;t<e.length;t++){let o=e[t],l=o.getAttribute("src");try{const e=await fetch(l);if(!e.ok){console.log("Could not include file: "+l),o?.remove();continue}let t=await e.text(),n=document.createRange().createContextualFragment(t),i=Array.from(n.children);for(let e of i)e.classList.add("hide"),e.style.transition="opacity 0.5s ease-in-out",setTimeout((()=>{e.classList.remove("hide")}),10);o.before(n),o.remove(),console.log("Included file: "+l)}catch(e){o?.remove(),console.log("Could not include file: "+l,e);continue}}}else{if(document.querySelectorAll("include").length>0){var e=document.createElement("div");e.id="error",e.textContent="Web server exports must be hosted on an http / web server to be viewed correctly.",e.style.position="fixed",e.style.top="50%",e.style.left="50%",e.style.transform="translate(-50%, -50%)",e.style.fontSize="1.5em",e.style.fontWeight="bold",e.style.textAlign="center",document.body.appendChild(e),document.querySelector(".document-container")?.classList.remove("hide")}}}document.addEventListener("DOMContentLoaded",(()=>{loadIncludes()}));let isFileProtocol="file:"==location.protocol;function waitLoadScripts(e,t){let o=e.map((e=>document.getElementById(e+"-script"))),l=0;!function e(){let n=o[l];l++,n&&"true"!=n.getAttribute("loaded")||l<o.length&&e(),l<o.length?n.addEventListener("load",e):t()}()}</script><link rel="stylesheet" href="lib/styles/obsidian.css"><link rel="stylesheet" href="lib/styles/theme.css"><link rel="preload" href="lib/styles/global-variable-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/global-variable-styles.css"></noscript><link rel="preload" href="lib/styles/main-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/main-styles.css"></noscript></head><body class="publish css-settings-manager theme-dark show-inline-title show-ribbon"><script defer="">let theme=localStorage.getItem("theme")||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light");"dark"==theme?(document.body.classList.add("theme-dark"),document.body.classList.remove("theme-light")):(document.body.classList.add("theme-light"),document.body.classList.remove("theme-dark")),window.innerWidth<480?document.body.classList.add("is-phone"):window.innerWidth<768?document.body.classList.add("is-tablet"):window.innerWidth<1024?document.body.classList.add("is-small-screen"):document.body.classList.add("is-large-screen")</script><div class="webpage-container workspace"><div class="sidebar-left sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"><label class="theme-toggle-container" for="theme_toggle"><input class="theme-toggle-input" type="checkbox" id="theme_toggle"><div class="toggle-background"></div></label></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content"><div class="search-input-container"><input enterkeyhint="search" type="search" spellcheck="false" placeholder="Search..."><div class="search-input-clear-button" aria-label="Clear search"></div></div><include src="lib/html/file-tree.html"></include></div><script defer="">let ls = document.querySelector(".sidebar-left"); ls.classList.add("is-collapsed"); if (window.innerWidth > 768) ls.classList.remove("is-collapsed"); ls.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-left-width"));</script></div><div class="document-container markdown-reading-view hide"><div class="markdown-preview-view markdown-rendered allow-fold-headings allow-fold-lists is-readable-line-width"><style id="MJX-CHTML-styles">mjx-container[jax=CHTML]{line-height:0}mjx-container [space="1"]{margin-left:.111em}mjx-container [space="2"]{margin-left:.167em}mjx-container [space="3"]{margin-left:.222em}mjx-container [space="4"]{margin-left:.278em}mjx-container [space="5"]{margin-left:.333em}mjx-container [rspace="1"]{margin-right:.111em}mjx-container [rspace="2"]{margin-right:.167em}mjx-container [rspace="3"]{margin-right:.222em}mjx-container [rspace="4"]{margin-right:.278em}mjx-container [rspace="5"]{margin-right:.333em}mjx-container [size="s"]{font-size:70.7%}mjx-container [size=ss]{font-size:50%}mjx-container [size=Tn]{font-size:60%}mjx-container [size=sm]{font-size:85%}mjx-container [size=lg]{font-size:120%}mjx-container [size=Lg]{font-size:144%}mjx-container [size=LG]{font-size:173%}mjx-container [size=hg]{font-size:207%}mjx-container [size=HG]{font-size:249%}mjx-container [width=full]{width:100%}mjx-box{display:inline-block}mjx-block{display:block}mjx-itable{display:inline-table}mjx-row{display:table-row}mjx-row>*{display:table-cell}mjx-mtext{display:inline-block}mjx-mstyle{display:inline-block}mjx-merror{display:inline-block;color:red;background-color:#ff0}mjx-mphantom{visibility:hidden}mjx-assistive-mml{top:0;left:0;clip:rect(1px,1px,1px,1px);user-select:none;position:absolute!important;padding:1px 0 0!important;border:0!important;display:block!important;width:auto!important;overflow:hidden!important}mjx-assistive-mml[display=block]{width:100%!important}mjx-math{display:inline-block;text-align:left;line-height:0;text-indent:0;font-style:normal;font-weight:400;font-size:100%;letter-spacing:normal;border-collapse:collapse;overflow-wrap:normal;word-spacing:normal;white-space:nowrap;direction:ltr;padding:1px 0}mjx-container[jax=CHTML][display=true]{display:block;text-align:center;margin:1em 0}mjx-container[jax=CHTML][display=true][width=full]{display:flex}mjx-container[jax=CHTML][display=true] mjx-math{padding:0}mjx-container[jax=CHTML][justify=left]{text-align:left}mjx-container[jax=CHTML][justify=right]{text-align:right}mjx-mn{display:inline-block;text-align:left}mjx-c{display:inline-block}mjx-utext{display:inline-block;padding:.75em 0 .2em}mjx-mo{display:inline-block;text-align:left}mjx-stretchy-h{display:inline-table;width:100%}mjx-stretchy-h>*{display:table-cell;width:0}mjx-stretchy-h>*>mjx-c{display:inline-block;transform:scaleX(1)}mjx-stretchy-h>*>mjx-c::before{display:inline-block;width:initial}mjx-stretchy-h>mjx-ext{overflow:clip visible;width:100%}mjx-stretchy-h>mjx-ext>mjx-c::before{transform:scaleX(500)}mjx-stretchy-h>mjx-ext>mjx-c{width:0}mjx-stretchy-h>mjx-beg>mjx-c{margin-right:-.1em}mjx-stretchy-h>mjx-end>mjx-c{margin-left:-.1em}mjx-stretchy-v{display:inline-block}mjx-stretchy-v>*{display:block}mjx-stretchy-v>mjx-beg{height:0}mjx-stretchy-v>mjx-end>mjx-c{display:block}mjx-stretchy-v>*>mjx-c{transform:scaleY(1);transform-origin:left center;overflow:hidden}mjx-stretchy-v>mjx-ext{display:block;height:100%;box-sizing:border-box;border:0 solid transparent;overflow:visible clip}mjx-stretchy-v>mjx-ext>mjx-c::before{width:initial;box-sizing:border-box}mjx-stretchy-v>mjx-ext>mjx-c{transform:scaleY(500) translateY(.075em);overflow:visible}mjx-mark{display:inline-block;height:0}mjx-c::before{display:block;width:0}.MJX-TEX{font-family:MJXZERO,MJXTEX}.TEX-B{font-family:MJXZERO,MJXTEX-B}.TEX-I{font-family:MJXZERO,MJXTEX-I}.TEX-MI{font-family:MJXZERO,MJXTEX-MI}.TEX-BI{font-family:MJXZERO,MJXTEX-BI}.TEX-S1{font-family:MJXZERO,MJXTEX-S1}.TEX-S2{font-family:MJXZERO,MJXTEX-S2}.TEX-S3{font-family:MJXZERO,MJXTEX-S3}.TEX-S4{font-family:MJXZERO,MJXTEX-S4}.TEX-A{font-family:MJXZERO,MJXTEX-A}.TEX-C{font-family:MJXZERO,MJXTEX-C}.TEX-CB{font-family:MJXZERO,MJXTEX-CB}.TEX-FR{font-family:MJXZERO,MJXTEX-FR}.TEX-FRB{font-family:MJXZERO,MJXTEX-FRB}.TEX-SS{font-family:MJXZERO,MJXTEX-SS}.TEX-SSB{font-family:MJXZERO,MJXTEX-SSB}.TEX-SSI{font-family:MJXZERO,MJXTEX-SSI}.TEX-SC{font-family:MJXZERO,MJXTEX-SC}.TEX-T{font-family:MJXZERO,MJXTEX-T}.TEX-V{font-family:MJXZERO,MJXTEX-V}.TEX-VB{font-family:MJXZERO,MJXTEX-VB}mjx-stretchy-h mjx-c,mjx-stretchy-v mjx-c{font-family:MJXZERO,MJXTEX-S1,MJXTEX-S4,MJXTEX,MJXTEX-A!important}@font-face{font-family:MJXZERO;src:url("lib/fonts/mathjax_zero.woff") format("woff")}@font-face{font-family:MJXTEX;src:url("lib/fonts/mathjax_main-regular.woff") format("woff")}@font-face{font-family:MJXTEX-B;src:url("lib/fonts/mathjax_main-bold.woff") format("woff")}@font-face{font-family:MJXTEX-I;src:url("lib/fonts/mathjax_math-italic.woff") format("woff")}@font-face{font-family:MJXTEX-MI;src:url("lib/fonts/mathjax_main-italic.woff") format("woff")}@font-face{font-family:MJXTEX-BI;src:url("lib/fonts/mathjax_math-bolditalic.woff") format("woff")}@font-face{font-family:MJXTEX-S1;src:url("lib/fonts/mathjax_size1-regular.woff") format("woff")}@font-face{font-family:MJXTEX-S2;src:url("lib/fonts/mathjax_size2-regular.woff") format("woff")}@font-face{font-family:MJXTEX-S3;src:url("lib/fonts/mathjax_size3-regular.woff") format("woff")}@font-face{font-family:MJXTEX-S4;src:url("lib/fonts/mathjax_size4-regular.woff") format("woff")}@font-face{font-family:MJXTEX-A;src:url("lib/fonts/mathjax_ams-regular.woff") format("woff")}@font-face{font-family:MJXTEX-C;src:url("lib/fonts/mathjax_calligraphic-regular.woff") format("woff")}@font-face{font-family:MJXTEX-CB;src:url("lib/fonts/mathjax_calligraphic-bold.woff") format("woff")}@font-face{font-family:MJXTEX-FR;src:url("lib/fonts/mathjax_fraktur-regular.woff") format("woff")}@font-face{font-family:MJXTEX-FRB;src:url("lib/fonts/mathjax_fraktur-bold.woff") format("woff")}@font-face{font-family:MJXTEX-SS;src:url("lib/fonts/mathjax_sansserif-regular.woff") format("woff")}@font-face{font-family:MJXTEX-SSB;src:url("lib/fonts/mathjax_sansserif-bold.woff") format("woff")}@font-face{font-family:MJXTEX-SSI;src:url("lib/fonts/mathjax_sansserif-italic.woff") format("woff")}@font-face{font-family:MJXTEX-SC;src:url("lib/fonts/mathjax_script-regular.woff") format("woff")}@font-face{font-family:MJXTEX-T;src:url("lib/fonts/mathjax_typewriter-regular.woff") format("woff")}@font-face{font-family:MJXTEX-V;src:url("lib/fonts/mathjax_vector-regular.woff") format("woff")}@font-face{font-family:MJXTEX-VB;src:url("lib/fonts/mathjax_vector-bold.woff") format("woff")}mjx-c.mjx-c31::before{padding:.666em .5em 0 0;content:"1"}mjx-c.mjx-c2217::before{padding:.465em .5em 0 0;content:"∗"}mjx-c.mjx-c38::before{padding:.666em .5em .022em 0;content:"8"}mjx-c.mjx-c2B::before{padding:.583em .778em .082em 0;content:"+"}mjx-c.mjx-c30::before{padding:.666em .5em .022em 0;content:"0"}mjx-c.mjx-c34::before{padding:.677em .5em 0 0;content:"4"}mjx-c.mjx-c32::before{padding:.666em .5em 0 0;content:"2"}mjx-c.mjx-c3D::before{padding:.583em .778em .082em 0;content:"="}</style><div class="markdown-preview-sizer markdown-preview-section"><h1 class="page-title heading inline-title" id="Portable Executable - Formato PE"><p dir="auto">Portable Executable - Formato PE</p></h1><div class="el-hr"><hr></div><div class="el-ul"><ul>
<li data-line="0" dir="auto">Tags: <a href="?query=tag:teoria" class="tag" target="_blank" rel="noopener nofollow">#teoria</a> <a href="?query=tag:sistemas" class="tag" target="_blank" rel="noopener nofollow">#sistemas</a> <a href="?query=tag:ejecutables" class="tag" target="_blank" rel="noopener nofollow">#ejecutables</a></li>
</ul></div><div class="el-hr"><hr></div><div class="el-h1 heading-wrapper"><h1 data-heading="Portable Executable" dir="auto" class="heading" id="Portable_Executable">Portable Executable</h1><div class="heading-children"><div class="el-p"><p dir="auto"><strong>PE</strong> proviene de <strong>Portable Executable</strong>, el cual es un formato de archivo para ejecutables utilizados en los sistemas operativos Windows, se basa en el formato de archivo <em>COFF</em> (Common Object File Format).</p></div><div class="el-p"><p dir="auto">No solo los arhciovs <em>.exe</em> son archivos PE, las bibliotecas de enlaces dinámicos (<em>.dll</em>), los módulos del kernel (<em>.srv</em>), las aplicaciones del panel de control (<em>.cpl</em>) y muchos otros también son archivos PE. Un archivo PE es una estructura de datos que contiene la información necesaria para que el cargador del sistema operativo pueda cargar ese ejecutable en la memoria y ejecutarlo.</p></div><div class="el-hr"><hr></div></div></div><div class="el-h1 heading-wrapper"><h1 data-heading="[Estructura](http://www.openrce.org/reference_library/files/reference/PE%20Format.pdf)" dir="auto" class="heading" id="[Estructura](http://www.openrce.org/reference_library/files/reference/PE%20Format.pdf)"><a data-tooltip-position="top" aria-label="http://www.openrce.org/reference_library/files/reference/PE%20Format.pdf" rel="noopener nofollow" class="external-link" href="http://www.openrce.org/reference_library/files/reference/PE%20Format.pdf" target="_blank">Estructura</a></h1><div class="heading-children"><div class="el-p"><p dir="auto">Un archivo <strong>PE</strong> consiste de una serie de <strong>headers</strong> y <strong>secciones</strong> que indican al <strong>enlazador dinámico</strong> <sup data-footnote-id="fnref-1-deedc4a96e077d7b" class="footnote-ref" id="fnref-1-deedc4a96e077d7b"><a data-footref="1" href="#fn-1-deedc4a96e077d7b" class="footnote-link" target="_self" rel="noopener nofollow">[1]</a></sup> cómo asignar el archivo en memoria.<br>
Recordemos que un archivo de formato PE sirve para decirle a enlazadores dinámicos qué información necesitan para administrar el código ejecutable empaquetado. La información que requiere el sistema se puede mencionar como:</p></div><div class="el-ul"><ul>
<li data-line="0" dir="auto">Referencias a DLLs a importar.</li>
<li data-line="1" dir="auto">Importar/Exportar tablas de API.</li>
<li data-line="2" dir="auto">Cuánto espacio de memoria reservar. (En la memoria irán el código, los datos y los recursos que necesitará el proceso en el sistema. El PE nunca se mapea entero, solo por partes).</li>
</ul></div><div class="el-p"><p dir="auto">Teniendo en cuenta esto, la <strong>estructura</strong> de esta información se puede encontrar de la siguiente manera:</p></div><div class="el-p"><p dir="auto">Imagén de capturada del <a data-href="PE_Format.draw" href="notes/3.-system/global-concepts/executable-formats/windows/graficos/pe_format.draw.html" class="internal-link" target="_self" rel="noopener nofollow">PE_Format.draw</a>.<br>
<span alt="PE_Format.png" src="PE_Format.png" class="internal-embed media-embed image-embed is-loaded"><img alt="PE_Format.png" src="lib/media/pe_format.png"></span></p></div><div class="el-hr"><hr></div><div class="el-h4 heading-wrapper"><h4 data-heading="**DOS**[^2] Header:" dir="auto" class="heading" id="**DOS**[^2]_Header:"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><strong>DOS</strong><sup data-footnote-id="fnref-2-deedc4a96e077d7b" class="footnote-ref" id="fnref-2-deedc4a96e077d7b"><a data-footref="2" href="#fn-2-deedc4a96e077d7b" class="footnote-link" target="_self" rel="noopener nofollow">[2]</a></sup> Header:</h4><div class="heading-children"><div class="el-p"><p dir="auto">Cada arachivo PE comienza con una estructura de <em>64 bytes</em> de largo llamada DOS Header, es lo que hace que el archivo PE sea un ejecutable de MS-DOS.</p></div><div class="el-p"><p dir="auto"><strong>IMAGE</strong><sup data-footnote-id="fnref-3-deedc4a96e077d7b" class="footnote-ref" id="fnref-3-deedc4a96e077d7b"><a data-footref="3" href="#fn-3-deedc4a96e077d7b" class="footnote-link" target="_self" rel="noopener nofollow">[3]</a></sup> del DOS Header</p></div><div class="el-pre"><pre class="language-c" tabindex="0"><code data-line="0" class="language-c is-loaded"><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">_IMAGE_DOS_HEADER</span> <span class="token punctuation">{</span> 
<span class="token number">0x00</span> WORD e_magic<span class="token punctuation">;</span> 
<span class="token number">0x02</span> WORD e_cblp<span class="token punctuation">;</span> 
<span class="token number">0x04</span> WORD e_cp<span class="token punctuation">;</span>
<span class="token number">0x06</span> WORD e_crlc<span class="token punctuation">;</span> 
<span class="token number">0x08</span> WORD e_cparhdr<span class="token punctuation">;</span> 
<span class="token number">0x0a</span> WORD e_minalloc<span class="token punctuation">;</span> 
<span class="token number">0x0c</span> WORD e_maxalloc<span class="token punctuation">;</span> 
<span class="token number">0x0e</span> WORD e_ss<span class="token punctuation">;</span> 
<span class="token number">0x10</span> WORD e_sp<span class="token punctuation">;</span> 
<span class="token number">0x12</span> WORD e_csum<span class="token punctuation">;</span>
<span class="token number">0x14</span> WORD e_ip<span class="token punctuation">;</span>
<span class="token number">0x16</span> WORD e_cs<span class="token punctuation">;</span>
<span class="token number">0x18</span> WORD e_lfarlc<span class="token punctuation">;</span> 
<span class="token number">0x1a</span> WORD e_ovno<span class="token punctuation">;</span> 
<span class="token number">0x1c</span> WORD e_res<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token number">0x24</span> WORD e_oemid<span class="token punctuation">;</span> 
<span class="token number">0x26</span> WORD e_oeminfo<span class="token punctuation">;</span>
<span class="token number">0x28</span> WORD e_res2<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token number">0x3c</span> DWORD e_lfanew<span class="token punctuation">;</span> 
<span class="token punctuation">}</span> IMAGE_DOS_HEADER<span class="token punctuation">,</span> <span class="token operator">*</span>PIMAGE_DOS_HEADER<span class="token punctuation">;</span>
</code><button class="copy-code-button">Copy</button></pre></div><div class="el-p"><p dir="auto">Los miembros más importantes de esta estructura son <em>e_magic</em> y <em>e_lfanew</em>.  Siendo el <em>e_magic</em> 2 bytes con el valor <em>0x5A4D</em> (<em>MZ</em>) y <em>e_lfanew</em> un valor de 4 bytes que contiene el <strong>offset</strong> hasta el inicio del NT Header (Siempre <em>e_lfanew</em> se encuentra en el <strong>offset</strong> <em>0x3C</em>).</p></div><div class="el-hr"><hr></div></div></div><div class="el-h4 heading-wrapper"><h4 data-heading="DOS Stub" dir="auto" class="heading" id="DOS_Stub"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>DOS Stub</h4><div class="heading-children"><div class="el-p"><p dir="auto">El código auxiliar de DOS, es un pequeño ejecutable compatible con MS-DOS 2.0 que simplemente imrpime un mensaje de error que dice <strong>This Program Cannot Run in DOS Mode</strong> y suele ocupar <em>57 bytes</em>.</p></div><div class="el-hr"><hr></div></div></div><div class="el-h4 heading-wrapper"><h4 data-heading="NT Headers" dir="auto" class="heading" id="NT_Headers"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>NT Headers</h4><div class="heading-children"><div class="el-p"><p dir="auto">Parte fundamental de la estructura de los archivos PE. Este encabezado proporciona información esencial sobre la organización y el contenido del archivo ejecutable, lo que permite al sistema operativo y a otros programas comprender cómo cargar y ejecutar el archivo de manera adecuada. </p></div><div class="el-p"><p dir="auto">IMAGE del NT Headers x86</p></div><div class="el-pre"><pre class="language-c" tabindex="0"><code data-line="0" class="language-c is-loaded"><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">_IMAGE_NT_HEADERS</span> <span class="token punctuation">{</span> 
<span class="token number">0x00</span> DWORD Signature<span class="token punctuation">;</span>
<span class="token number">0x04</span> _IMAGE_FILE_HEADER FileHeader<span class="token punctuation">;</span> 
<span class="token number">0x18</span> _IMAGE_OPTIONAL_HEADER32 OptionalHeader<span class="token punctuation">;</span> 
<span class="token punctuation">}</span> IMAGE_NT_HEADERS32<span class="token punctuation">,</span> <span class="token operator">*</span>PIMAGE_NT_HEADERS32<span class="token punctuation">;</span>
</code><button class="copy-code-button">Copy</button></pre></div><div class="el-p"><p dir="auto">IMAGE del NT Headers x64</p></div><div class="el-pre"><pre class="language-c" tabindex="0"><code data-line="0" class="language-c is-loaded"><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">_IMAGE_NT_HEADERS</span> <span class="token punctuation">{</span> 
<span class="token number">0x00</span> DWORD Signature<span class="token punctuation">;</span>
<span class="token number">0x04</span> _IMAGE_FILE_HEADER FileHeader<span class="token punctuation">;</span> 
<span class="token number">0x18</span> _IMAGE_OPTIONAL_HEADER64 OptionalHeader<span class="token punctuation">;</span> 
<span class="token punctuation">}</span> IMAGE_NT_HEADERS64<span class="token punctuation">,</span> <span class="token operator">*</span>PIMAGE_NT_HEADERS54<span class="token punctuation">;</span>
</code><button class="copy-code-button">Copy</button></pre></div><div class="el-p"><p dir="auto">Este Header es esencial ya que incorpora otros dos Headers que son estructuras de datos (<em>FileHeader</em> y <em>OptionalHeader</em>).</p></div><div class="el-h5 heading-wrapper"><h5 data-heading="**File Header**" dir="auto" class="heading" id="**File_Header**"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><strong>File Header</strong></h5><div class="heading-children"><div class="el-p"><p dir="auto">Header de archivo COFF estándar. Contiene información sobre el archivo PE.</p></div><div class="el-p"><p dir="auto">IMAGE del File Header</p></div><div class="el-pre"><pre class="language-c" tabindex="0"><code data-line="0" class="language-c is-loaded"><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">_IMAGE_FILE_HEADER</span> <span class="token punctuation">{</span> 
<span class="token number">0x00</span> WORD Machine<span class="token punctuation">;</span>
<span class="token number">0x02</span> WORD NumberOfSections<span class="token punctuation">;</span>
<span class="token number">0x04</span> DWORD TimeDateStamp<span class="token punctuation">;</span>
<span class="token number">0x08</span> DWORD PointerToSymbolTable<span class="token punctuation">;</span> 
<span class="token number">0x0c</span> DWORD NumberOfSymbols<span class="token punctuation">;</span>
<span class="token number">0x10</span> WORD SizeOfOptionalHeader<span class="token punctuation">;</span>
<span class="token number">0x12</span> WORD Characteristics<span class="token punctuation">;</span> 
<span class="token punctuation">}</span> IMAGE_FILE_HEADER<span class="token punctuation">,</span> <span class="token operator">*</span>PIMAGE_FILE_HEADER<span class="token punctuation">;</span>
</code><button class="copy-code-button">Copy</button></pre></div><div class="el-p"><p dir="auto">Los miembros más importantes de esta estructura son:</p></div><div class="el-ul"><ul>
<li data-line="0" dir="auto"><strong>NumberOfSections</strong>: El number de secciones en el archivo PE.</li>
<li data-line="1" dir="auto"><strong>Characteristics</strong>: Flags que especifican ciertos atributos sobre el archivo ejecutable, como si es una DLL o una aplicación de consola.</li>
<li data-line="2" dir="auto"><strong>SizeOfOptinalHeader</strong>: El tamaño del siguiente Optional Header</li>
</ul></div></div></div><div class="el-h5 heading-wrapper"><h5 data-heading="**Optional Header**:" dir="auto" class="heading" id="**Optional_Header**:"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><strong>Optional Header</strong>:</h5><div class="heading-children"><div class="el-p"><p dir="auto">El Header más importante en los NT Headers, su nombre es Optional Header porque algunos archivos, como los archivos objeto, no lo tienen, es necesario para los archivos de imagen (Archivos como .exe). Este encabezado proporciona información importante al cargador del sistema operativo.</p></div><div class="el-p"><p dir="auto">IMAGE del Optional Header</p></div><div class="el-pre"><pre class="language-c" tabindex="0"><code data-line="0" class="language-c is-loaded"><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">_IMAGE_OPTIONAL_HEADER</span> <span class="token punctuation">{</span> 
<span class="token number">0x00</span> WORD Magic<span class="token punctuation">;</span> 
<span class="token number">0x02</span> BYTE MajorLinkerVersion<span class="token punctuation">;</span> 
<span class="token number">0x03</span> BYTE MinorLinkerVersion<span class="token punctuation">;</span>
<span class="token number">0x04</span> DWORD SizeOfCode<span class="token punctuation">;</span> 
<span class="token number">0x08</span> DWORD SizeOfInitializedData<span class="token punctuation">;</span>
<span class="token number">0x0c</span> DWORD SizeOfUninitializedData<span class="token punctuation">;</span>
<span class="token number">0x10</span> DWORD AddressOfEntryPoint<span class="token punctuation">;</span> 
<span class="token number">0x14</span> DWORD BaseOfCode<span class="token punctuation">;</span> 
<span class="token number">0x18</span> DWORD BaseOfData<span class="token punctuation">;</span> 
<span class="token number">0x1c</span> DWORD ImageBase<span class="token punctuation">;</span> 
<span class="token number">0x20</span> DWORD SectionAlignment<span class="token punctuation">;</span>
<span class="token number">0x24</span> DWORD FileAlignment<span class="token punctuation">;</span>
<span class="token number">0x28</span> WORD MajorOperatingSystemVersion<span class="token punctuation">;</span> 
<span class="token number">0x2a</span> WORD MinorOperatingSystemVersion<span class="token punctuation">;</span>
<span class="token number">0x2c</span> WORD MajorImageVersion<span class="token punctuation">;</span> 
<span class="token number">0x2e</span> WORD MinorImageVersion<span class="token punctuation">;</span> 
<span class="token number">0x30</span> WORD MajorSubsystemVersion<span class="token punctuation">;</span> 
<span class="token number">0x32</span> WORD MinorSubsystemVersion<span class="token punctuation">;</span>
<span class="token number">0x34</span> DWORD Win32VersionValue<span class="token punctuation">;</span>
<span class="token number">0x38</span> DWORD SizeOfImage<span class="token punctuation">;</span> 
<span class="token number">0x3c</span> DWORD SizeOfHeaders<span class="token punctuation">;</span> 
<span class="token number">0x40</span> DWORD CheckSum<span class="token punctuation">;</span> 
<span class="token number">0x44</span> WORD Subsystem<span class="token punctuation">;</span> 
<span class="token number">0x46</span> WORD DllCharacteristics<span class="token punctuation">;</span>
<span class="token number">0x48</span> DWORD SizeOfStackReserve<span class="token punctuation">;</span>
<span class="token number">0x4c</span> DWORD SizeOfStackCommit<span class="token punctuation">;</span>
<span class="token number">0x50</span> DWORD SizeOfHeapReserve<span class="token punctuation">;</span>
<span class="token number">0x54</span> DWORD SizeOfHeapCommit<span class="token punctuation">;</span> 
<span class="token number">0x58</span> DWORD LoaderFlags<span class="token punctuation">;</span>
<span class="token number">0x5c</span> DWORD NumberOfRvaAndSizes<span class="token punctuation">;</span>
<span class="token number">0x60</span> _IMAGE_DATA_DIRECTORY DataDirectory<span class="token punctuation">[</span>IMAGE_NUMBEROF_DIRECTORY_ENTRIES<span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token comment">// IMAGE_NUMBEROF_DIRECTORY_ENTRIES = 16</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code><button class="copy-code-button">Copy</button></pre></div><div class="el-hr"><hr></div></div></div></div></div><div class="el-h4 heading-wrapper"><h4 data-heading="Data Directory" dir="auto" class="heading" id="Data_Directory"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Data Directory</h4><div class="heading-children"><div class="el-p"><p dir="auto">Este apartado se encuentra dentro del <em>Optional Header</em>, y las entradas de este Array de un total de <em>IMAGE_NUMBEROF_DIRECTORY_ENTRIES</em> = <em>16</em> posiciones apunta a diferentes tablas y estrucutas de datos importantes que se almacenan en secciones específicas del archivo PE. </p></div><div class="el-p"><p dir="auto">Cada posición del array representa un Data Directory especifico que puede incluir algo de data de la <strong>PE Section</strong> o <strong>Data Table</strong>.</p></div><div class="el-p"><p dir="auto">IMAGE de cada Data Directory</p></div><div class="el-pre"><pre class="language-c" tabindex="0"><code data-line="0" class="language-c is-loaded"><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">_IMAGE_DATA_DIRECTORY</span> <span class="token punctuation">{</span> 
<span class="token number">0x00</span> DWORD VirtualAddress<span class="token punctuation">;</span> 
<span class="token number">0x04</span> DWORD Size<span class="token punctuation">;</span> 
<span class="token punctuation">}</span> IMAGE_DATA_DIRECTORY<span class="token punctuation">,</span> <span class="token operator">*</span>PIMAGE_DATA_DIRECTORY<span class="token punctuation">;</span>
</code><button class="copy-code-button">Copy</button></pre></div><div class="el-p"><p dir="auto">Indices del Array</p></div><div class="el-pre"><pre class="language-c" tabindex="0"><code data-line="0" class="language-c is-loaded">define IMAGE_DIRECTORY_ENTRY_EXPORT          <span class="token number">0</span>   <span class="token comment">// Export Directory</span>
define IMAGE_DIRECTORY_ENTRY_IMPORT          <span class="token number">1</span>   <span class="token comment">// Import Directory</span>
define IMAGE_DIRECTORY_ENTRY_RESOURCE        <span class="token number">2</span>   <span class="token comment">// Resource Directory</span>
define IMAGE_DIRECTORY_ENTRY_EXCEPTION       <span class="token number">3</span>   <span class="token comment">// Exception Directory</span>
define IMAGE_DIRECTORY_ENTRY_SECURITY        <span class="token number">4</span>   <span class="token comment">// Security Directory</span>
define IMAGE_DIRECTORY_ENTRY_BASERELOC       <span class="token number">5</span>   <span class="token comment">// Base Relocation Table</span>
define IMAGE_DIRECTORY_ENTRY_DEBUG           <span class="token number">6</span>   <span class="token comment">// Debug Directory</span>
define IMAGE_DIRECTORY_ENTRY_ARCHITECTURE    <span class="token number">7</span>   <span class="token comment">// Architecture Specific Data</span>
define IMAGE_DIRECTORY_ENTRY_GLOBALPTR       <span class="token number">8</span>   <span class="token comment">// RVA of GP</span>
define IMAGE_DIRECTORY_ENTRY_TLS             <span class="token number">9</span>   <span class="token comment">// TLS Directory</span>
define IMAGE_DIRECTORY_ENTRY_LOAD_CONFIG    <span class="token number">10</span>   <span class="token comment">// Load Configuration Directory</span>
define IMAGE_DIRECTORY_ENTRY_BOUND_IMPORT   <span class="token number">11</span>   <span class="token comment">// Bound Import Directory in headers</span>
define IMAGE_DIRECTORY_ENTRY_IAT            <span class="token number">12</span>   <span class="token comment">// Import Address Table</span>
define IMAGE_DIRECTORY_ENTRY_DELAY_IMPORT   <span class="token number">13</span>   <span class="token comment">// Delay Load Import Descriptors</span>
define IMAGE_DIRECTORY_ENTRY_COM_DESCRIPTOR <span class="token number">14</span>   <span class="token comment">// COM Runtime descriptor</span>
</code><button class="copy-code-button">Copy</button></pre></div><div class="el-p"><p dir="auto">Dos <em>Data Directories</em> importanes son el de la posición 0 y 12, es decir <strong>Export Directory</strong> y <strong>Import Address Table</strong>. </p></div><div class="el-h6 heading-wrapper"><h6 data-heading="Export Directory" dir="auto" class="heading" id="Export_Directory"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Export Directory</h6><div class="heading-children"><div class="el-p"><p dir="auto">El <em>Export Directory</em> de un archivo de formato PE es una estructura de datos que contiene información sobre funciones y variables exportadas desde el ejecutable. Contiene direcciones de las funciones y variables exportadas, las cuales puede ser usadas por otros archivos ejecutables para acceder a las funciones o datos.<br>
El <em>Export Directory</em> es generalmente encontrado en DLLs que exportan funciones, por ejemplo <em>kernel32.dll</em> exportando <em>CreateFileA</em>.</p></div></div></div><div class="el-h6 heading-wrapper"><h6 data-heading="Import Address Table" dir="auto" class="heading" id="Import_Address_Table"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Import Address Table</h6><div class="heading-children"><div class="el-p"><p dir="auto">El <em>Import Address Table</em> es una estructura de datos que contiene información sobre direcciones o funciones importadas desde otro archivo ejecutable. Las direcciones son usadas para acceder a funciones y datos alojados en otros ejecutables, por ejemplo <em>Aplication.exe</em> importa <em>CreateFileA</em> desde <em>kernel32.dll</em>. </p></div><div class="el-hr"><hr></div></div></div></div></div><div class="el-h4 heading-wrapper"><h4 data-heading="Section Table (PE Sections)" dir="auto" class="heading" id="Section_Table_(PE_Sections)"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Section Table (PE Sections)</h4><div class="heading-children"><div class="el-p"><p dir="auto">Inmediatamente seguido al Optional Header esta la Section Table, es un array de Headers para cada sección en el archivo PE. Cada Header contiene información sobre la sección a la que hace referencia.</p></div><div class="el-p"><p dir="auto">IMAGE de cada Header Section</p></div><div class="el-pre"><pre class="language-c" tabindex="0"><code data-line="0" class="language-c is-loaded"><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">_IMAGE_SECTION_HEADER</span> <span class="token punctuation">{</span> 
<span class="token number">0x00</span> BYTE Name<span class="token punctuation">[</span>IMAGE_SIZEOF_SHORT_NAME<span class="token punctuation">]</span><span class="token punctuation">;</span> 
	<span class="token keyword">union</span> <span class="token punctuation">{</span> 
<span class="token number">0x08</span> DWORD PhysicalAddress<span class="token punctuation">;</span> 
<span class="token number">0x08</span> DWORD VirtualSize<span class="token punctuation">;</span> 
	<span class="token punctuation">}</span> Misc<span class="token punctuation">;</span> 
<span class="token number">0x0c</span> DWORD VirtualAddress<span class="token punctuation">;</span> 
<span class="token number">0x10</span> DWORD SizeOfRawData<span class="token punctuation">;</span> 
<span class="token number">0x14</span> DWORD PointerToRawData<span class="token punctuation">;</span> 
<span class="token number">0x18</span> DWORD PointerToRelocations<span class="token punctuation">;</span>
<span class="token number">0x1c</span> DWORD PointerToLinenumbers<span class="token punctuation">;</span>
<span class="token number">0x20</span> WORD NumberOfRelocations<span class="token punctuation">;</span> 
<span class="token number">0x22</span> WORD NumberOfLinenumbers<span class="token punctuation">;</span> 
<span class="token number">0x24</span> DWORD Characteristics<span class="token punctuation">;</span> 
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code><button class="copy-code-button">Copy</button></pre></div><div class="el-p"><p dir="auto">Algunos de los elementos más importantes son</p></div><div class="el-ul"><ul>
<li data-line="0" dir="auto"><strong>Name</strong>: El nombre de la sección, por ejemplo <em>.text</em>, <em>.data</em>, etc.</li>
<li data-line="1" dir="auto"><strong>PhysicalAddress</strong> o <strong>VirtualSize</strong>: El tamaño de la sección cuando esta en memoria.</li>
<li data-line="2" dir="auto"><strong>VirtualAddress</strong>: Offset de donde empieza la sección en memoria. </li>
</ul></div><div class="el-hr"><hr></div></div></div></div></div><div class="el-h1 heading-wrapper"><h1 data-heading="Secciones" dir="auto" class="heading" id="Secciones">Secciones</h1><div class="heading-children"><div class="el-p"><p dir="auto">Las secciones son una parte fundamental de la estructura del archivo PE. Las secciones son divisiones lógicas dentro de un archivo PE que almacenan datos específicos relacionados con el programa o la biblioteca. Cada sección tiene un propósito particular y contiene información relevante para la carga y ejecución del programa.</p></div><div class="el-p"><p dir="auto">Estas secciones contienen código y datos usados para crear un archivo ejecutable. Cada sección recibe un nombre único y mayormente contiene el código del ejecutable, datos o información de recursos. No existe un número constante de secciones ya que un compilador puede agregar, remover o mergear secciones dependiendo de la configuración. Algunas secciones también pueden ser agregadas más tarde de manera manual, por lo tanto son dinamicas y el campo <em>IMAGE_FILE_HEADER.NumberOfSections</em> ayuda a determinar la cantidad de secciones que existen.</p></div><div class="el-p"><p dir="auto">Algunas de las secciones habituales más importantes que existe en la mayoría de arhicvos PE son:</p></div><div class="el-ul"><ul>
<li data-line="0" dir="auto"><strong>.text</strong>: Contiene el código del ejecutable, es decir, el código que fue escrito.</li>
<li data-line="1" dir="auto"><strong>.data</strong>: Contiene los datos inicializados, es decir, las variables inicializadas en el código.</li>
<li data-line="2" dir="auto"><strong>.rdata</strong>: Contiene únicamente la data <em>read-only</em>, es decir, las variables <em>constant</em> declaradas con el prefijo <strong>const</strong>. </li>
<li data-line="3" dir="auto"><strong>.idata</strong>: Contiene las <em>Import Tables</em>. Estas son tablas de información relacionada a funciones llamadas durante el código. Esto es usado por el cargador de Windows (<em>PE Windows Loader</em>) que determina que DLL's serán cargadas al proceso, así como que funciones comenzaran a ser usadas de cada DLL. </li>
<li data-line="4" dir="auto"><strong>.reloc</strong>: Contiene información sobre cómo arreglar las direcciones de memoria para que los programas puedan cargarse en la memoria sin errores.</li>
<li data-line="5" dir="auto"><strong>.rsrc</strong>: Usado para restaurar recursos como iconos y bitmaps.</li>
</ul></div><div class="el-hr"><hr></div></div></div><div class="el-h1 heading-wrapper"><h1 data-heading="Referencias" dir="auto" class="heading" id="Referencias">Referencias</h1><div class="heading-children"><div></div><div></div><div></div><div>
</div><div class="el-section"><section class="footnotes"><hr><ol>
<li data-line="-2" data-footnote-id="fn-1-deedc4a96e077d7b" id="fn-1-deedc4a96e077d7b" dir="auto"><p><strong>Dynamic Linker/Enlazador Dinámico</strong>: Parte esencial del sistema operativo que se encarga de resolver y cinvular referencias a DLL en tiempo de ejecución cuando un porgrma se carga en memoria.<a href="#fnref-1-deedc4a96e077d7b" class="footnote-backref footnote-link" target="_self" rel="noopener nofollow">↩︎</a></p></li>
<li data-line="-1" data-footnote-id="fn-2-deedc4a96e077d7b" id="fn-2-deedc4a96e077d7b" dir="auto"><p><strong>DOS</strong>: Término utilizado para referirse a <em>Disk Operative System</em>, sistema operativo que se utiliza para gestionar y controlar el acceso a dispositivos de almacenamiento, como discos duros, unidades de disquete y unidades de CD/DVD en un equipo. Dos sistemas operativos conocidos con el nombre DOS son <em>MS-DOS</em> y <em>PC-DOS</em>. <a href="#fnref-2-deedc4a96e077d7b" class="footnote-backref footnote-link" target="_self" rel="noopener nofollow">↩︎</a></p></li>
<li data-line="0" data-footnote-id="fn-3-deedc4a96e077d7b" id="fn-3-deedc4a96e077d7b" dir="auto"><p><strong>IMAGE</strong>: En el contexto de arhcivos PE, IMAGE se utiliza en las estructuras de datos y encabezados en archivos PE para indicar que están relacionados con la implementación interna del formato PE y son parte del formato de archivo.<a href="#fnref-3-deedc4a96e077d7b" class="footnote-backref footnote-link" target="_self" rel="noopener nofollow">↩︎</a></p></li>
</ol></section></div><div class="mod-footer mod-ui"></div></div></div></div></div></div><div class="sidebar-right sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content"><div class="graph-view-wrapper"><div class="sidebar-section-header">Interactive Graph</div><div class="graph-view-placeholder">
		<div class="graph-view-container">
			<div class="graph-icon graph-expand" role="button" aria-label="Expand" data-tooltip-position="top"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><line x1="7" y1="17" x2="17" y2="7"></line><polyline points="7 7 17 7 17 17"></polyline></svg></div>
			<canvas id="graph-canvas" class="hide" width="512px" height="512px"></canvas>
		</div>
		</div></div><div class="tree-container mod-root nav-folder tree-item outline-tree" data-depth="0"><div class="tree-header"><span class="sidebar-section-header">Table Of Contents</span><button class="clickable-icon collapse-tree-button" aria-label="Collapse All"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></svg></button></div><div class="tree-scroll-area tree-item-children nav-folder-children"><div class="tree-item mod-tree-folder nav-folder mod-collapsible is-collapsed" style="display: none;"></div><div class="tree-item" data-depth="1"><a class="tree-link" href="notes\3.-system\global-concepts\executable-formats\windows\portable-executable-formato-pe.html#Portable Executable - Formato PE"><div class="tree-item-contents heading-link" heading-name="Portable Executable - Formato PE"><span class="tree-item-title">Portable Executable - Formato PE</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="1"><a class="tree-link" href="notes\3.-system\global-concepts\executable-formats\windows\portable-executable-formato-pe.html#Portable_Executable"><div class="tree-item-contents heading-link" heading-name="Portable Executable"><span class="tree-item-title">Portable Executable</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="1"><a class="tree-link" href="notes\3.-system\global-concepts\executable-formats\windows\portable-executable-formato-pe.html#[Estructura](http://www.openrce.org/reference_library/files/reference/PE%20Format.pdf)"><div class="tree-item-contents heading-link" heading-name="[Estructura](http://www.openrce.org/reference_library/files/reference/PE%20Format.pdf)"><span class="tree-item-title"><a data-tooltip-position="top" aria-label="http://www.openrce.org/reference_library/files/reference/PE%20Format.pdf" rel="noopener nofollow" class="external-link" href="http://www.openrce.org/reference_library/files/reference/PE%20Format.pdf" target="_blank">Estructura</a></span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="4"><a class="tree-link" href="notes\3.-system\global-concepts\executable-formats\windows\portable-executable-formato-pe.html#**DOS**[^2]_Header:"><div class="tree-item-contents heading-link" heading-name="**DOS**[^2] Header:"><span class="tree-item-title"><strong>DOS</strong>2 Header:</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-link" href="notes\3.-system\global-concepts\executable-formats\windows\portable-executable-formato-pe.html#DOS_Stub"><div class="tree-item-contents heading-link" heading-name="DOS Stub"><span class="tree-item-title">DOS Stub</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-link" href="notes\3.-system\global-concepts\executable-formats\windows\portable-executable-formato-pe.html#NT_Headers"><div class="tree-item-contents heading-link" heading-name="NT Headers"><span class="tree-item-title">NT Headers</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="5"><a class="tree-link" href="notes\3.-system\global-concepts\executable-formats\windows\portable-executable-formato-pe.html#**File_Header**"><div class="tree-item-contents heading-link" heading-name="**File Header**"><span class="tree-item-title"><strong>File Header</strong></span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="5"><a class="tree-link" href="notes\3.-system\global-concepts\executable-formats\windows\portable-executable-formato-pe.html#**Optional_Header**:"><div class="tree-item-contents heading-link" heading-name="**Optional Header**:"><span class="tree-item-title"><strong>Optional Header</strong>:</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-link" href="notes\3.-system\global-concepts\executable-formats\windows\portable-executable-formato-pe.html#Data_Directory"><div class="tree-item-contents heading-link" heading-name="Data Directory"><span class="tree-item-title">Data Directory</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="6"><a class="tree-link" href="notes\3.-system\global-concepts\executable-formats\windows\portable-executable-formato-pe.html#Export_Directory"><div class="tree-item-contents heading-link" heading-name="Export Directory"><span class="tree-item-title">Export Directory</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="6"><a class="tree-link" href="notes\3.-system\global-concepts\executable-formats\windows\portable-executable-formato-pe.html#Import_Address_Table"><div class="tree-item-contents heading-link" heading-name="Import Address Table"><span class="tree-item-title">Import Address Table</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-link" href="notes\3.-system\global-concepts\executable-formats\windows\portable-executable-formato-pe.html#Section_Table_(PE_Sections)"><div class="tree-item-contents heading-link" heading-name="Section Table (PE Sections)"><span class="tree-item-title">Section Table (PE Sections)</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div><div class="tree-item" data-depth="1"><a class="tree-link" href="notes\3.-system\global-concepts\executable-formats\windows\portable-executable-formato-pe.html#Secciones"><div class="tree-item-contents heading-link" heading-name="Secciones"><span class="tree-item-title">Secciones</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="1"><a class="tree-link" href="notes\3.-system\global-concepts\executable-formats\windows\portable-executable-formato-pe.html#Referencias"><div class="tree-item-contents heading-link" heading-name="Referencias"><span class="tree-item-title">Referencias</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div></div><script defer="">let rs = document.querySelector(".sidebar-right"); rs.classList.add("is-collapsed"); if (window.innerWidth > 768) rs.classList.remove("is-collapsed"); rs.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-right-width"));</script></div></div></body></html>