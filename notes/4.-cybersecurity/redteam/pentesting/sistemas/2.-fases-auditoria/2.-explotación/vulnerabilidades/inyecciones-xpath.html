<!DOCTYPE html> <html><head>
		<title>Inyecciones XPath</title>
		<base href="..\..\..\..\..\..\..\../">
		<meta id="root-path" root-path="..\..\..\..\..\..\..\../">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=1.0, maximum-scale=5.0">
		<meta charset="UTF-8">
		<meta name="description" content="Hacking - Inyecciones XPath">
		<meta property="og:title" content="Inyecciones XPath">
		<meta property="og:description" content="Hacking - Inyecciones XPath">
		<meta property="og:type" content="website">
		<meta property="og:url" content="notes/4.-cybersecurity/redteam/pentesting/sistemas/2.-fases-auditoria/2.-explotaciÃ³n/vulnerabilidades/inyecciones-xpath.html">
		<meta property="og:image" content="undefined">
		<meta property="og:site_name" content="Hacking">
		<link rel="alternate" type="application/rss+xml" title="RSS Feed" href="lib/rss.xml"><script async="" id="webpage-script" src="lib/scripts/webpage.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script type="module" async="" id="graph-view-script" src="lib/scripts/graph-view.js"></script><script async="" id="graph-wasm-script" src="lib/scripts/graph-wasm.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="graph-render-worker-script" src="lib/scripts/graph-render-worker.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="tinycolor-script" src="lib/scripts/tinycolor.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="pixi-script" src="https://cdnjs.cloudflare.com/ajax/libs/pixi.js/7.4.0/pixi.min.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="minisearch-script" src="https://cdn.jsdelivr.net/npm/minisearch@6.3.0/dist/umd/index.min.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><link rel="icon" href="lib/media/favicon.png"><script async="" id="graph-data-script" src="lib/scripts/graph-data.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><style>body{--line-width:40em;--line-width-adaptive:40em;--file-line-width:40em;--sidebar-width:min(20em, 80vw);--collapse-arrow-size:11px;--tree-horizontal-spacing:0.6em;--tree-vertical-spacing:0.6em;--sidebar-margin:12px}.sidebar{height:100%;min-width:calc(var(--sidebar-width) + var(--divider-width-hover));max-width:calc(var(--sidebar-width) + var(--divider-width-hover));font-size:14px;z-index:10;position:relative;overflow:hidden;transition:min-width ease-in-out,max-width ease-in-out;transition-duration:.2s;contain:size}.sidebar-left{left:0}.sidebar-right{right:0}.sidebar.is-collapsed{min-width:0;max-width:0}body.floating-sidebars .sidebar{position:absolute}.sidebar-content{height:100%;min-width:calc(var(--sidebar-width) - var(--divider-width-hover));top:0;padding:var(--sidebar-margin);padding-top:4em;line-height:var(--line-height-tight);background-color:var(--background-secondary);transition:background-color,border-right,border-left,box-shadow;transition-duration:var(--color-fade-speed);transition-timing-function:ease-in-out;position:absolute;display:flex;flex-direction:column}.sidebar:not(.is-collapsed) .sidebar-content{min-width:calc(max(100%,var(--sidebar-width)) - 3px);max-width:calc(max(100%,var(--sidebar-width)) - 3px)}.sidebar-left .sidebar-content{left:0;border-top-right-radius:var(--radius-l);border-bottom-right-radius:var(--radius-l)}.sidebar-right .sidebar-content{right:0;border-top-left-radius:var(--radius-l);border-bottom-left-radius:var(--radius-l)}.sidebar:has(.sidebar-content:empty):has(.topbar-content:empty){display:none}.sidebar-topbar{height:2em;width:var(--sidebar-width);top:var(--sidebar-margin);padding-inline:var(--sidebar-margin);z-index:1;position:fixed;display:flex;align-items:center;transition:width ease-in-out;transition-duration:inherit}.sidebar.is-collapsed .sidebar-topbar{width:calc(2.3em + var(--sidebar-margin) * 2)}.sidebar .sidebar-topbar.is-collapsed{width:0}.sidebar-left .sidebar-topbar{left:0}.sidebar-right .sidebar-topbar{right:0}.topbar-content{overflow:hidden;overflow:clip;width:100%;height:100%;display:flex;align-items:center;transition:inherit}.sidebar.is-collapsed .topbar-content{width:0;transition:inherit}.clickable-icon.sidebar-collapse-icon{background-color:transparent;color:var(--icon-color-focused);padding:0!important;margin:0!important;height:100%!important;width:2.3em!important;margin-inline:0.14em!important;position:absolute}.sidebar-left .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);right:var(--sidebar-margin)}.sidebar-right .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);left:var(--sidebar-margin)}.clickable-icon.sidebar-collapse-icon svg.svg-icon{width:100%;height:100%}.sidebar-section-header{margin:0 0 1em 0;text-transform:uppercase;letter-spacing:.06em;font-weight:600}body{transition:background-color var(--color-fade-speed) ease-in-out}.webpage-container{display:flex;flex-direction:row;height:100%;width:100%;align-items:stretch;justify-content:center}.document-container{opacity:1;flex-basis:100%;max-width:100%;width:100%;height:100%;display:flex;flex-direction:column;align-items:center;transition:opacity .2s ease-in-out;contain:inline-size}.hide{opacity:0;transition:opacity .2s ease-in-out}.document-container>.markdown-preview-view{margin:var(--sidebar-margin);margin-bottom:0;width:100%;width:-webkit-fill-available;width:-moz-available;width:fill-available;background-color:var(--background-primary);transition:background-color var(--color-fade-speed) ease-in-out;border-top-right-radius:var(--window-radius,var(--radius-m));border-top-left-radius:var(--window-radius,var(--radius-m));overflow-x:hidden!important;overflow-y:auto!important;display:flex!important;flex-direction:column!important;align-items:center!important;contain:inline-size}.document-container>.markdown-preview-view>.markdown-preview-sizer{padding-bottom:80vh!important;width:100%!important;max-width:var(--line-width)!important;flex-basis:var(--line-width)!important;transition:background-color var(--color-fade-speed) ease-in-out;contain:inline-size}.markdown-rendered img:not([width]),.view-content img:not([width]){max-width:100%;outline:0}.document-container>.view-content.embed{display:flex;padding:1em;height:100%;width:100%;align-items:center;justify-content:center}.document-container>.view-content.embed>*{max-width:100%;max-height:100%;object-fit:contain}:has(> :is(.math,table)){overflow-x:auto!important}.document-container>.view-content{overflow-x:auto;contain:content;padding:0;margin:0;height:100%}.scroll-highlight{position:absolute;width:100%;height:100%;pointer-events:none;z-index:1000;background-color:hsla(var(--color-accent-hsl),.25);opacity:0;padding:1em;inset:50%;translate:-50% -50%;border-radius:var(--radius-s)}</style><script defer="">async function loadIncludes(){if("file:"!=location.protocol){let e=document.querySelectorAll("include");for(let t=0;t<e.length;t++){let o=e[t],l=o.getAttribute("src");try{const e=await fetch(l);if(!e.ok){console.log("Could not include file: "+l),o?.remove();continue}let t=await e.text(),n=document.createRange().createContextualFragment(t),i=Array.from(n.children);for(let e of i)e.classList.add("hide"),e.style.transition="opacity 0.5s ease-in-out",setTimeout((()=>{e.classList.remove("hide")}),10);o.before(n),o.remove(),console.log("Included file: "+l)}catch(e){o?.remove(),console.log("Could not include file: "+l,e);continue}}}else{if(document.querySelectorAll("include").length>0){var e=document.createElement("div");e.id="error",e.textContent="Web server exports must be hosted on an http / web server to be viewed correctly.",e.style.position="fixed",e.style.top="50%",e.style.left="50%",e.style.transform="translate(-50%, -50%)",e.style.fontSize="1.5em",e.style.fontWeight="bold",e.style.textAlign="center",document.body.appendChild(e),document.querySelector(".document-container")?.classList.remove("hide")}}}document.addEventListener("DOMContentLoaded",(()=>{loadIncludes()}));let isFileProtocol="file:"==location.protocol;function waitLoadScripts(e,t){let o=e.map((e=>document.getElementById(e+"-script"))),l=0;!function e(){let n=o[l];l++,n&&"true"!=n.getAttribute("loaded")||l<o.length&&e(),l<o.length?n.addEventListener("load",e):t()}()}</script><link rel="stylesheet" href="lib/styles/obsidian.css"><link rel="stylesheet" href="lib/styles/theme.css"><link rel="preload" href="lib/styles/global-variable-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/global-variable-styles.css"></noscript><link rel="preload" href="lib/styles/main-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/main-styles.css"></noscript></head><body class="publish css-settings-manager theme-dark show-inline-title"><script defer="">let theme=localStorage.getItem("theme")||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light");"dark"==theme?(document.body.classList.add("theme-dark"),document.body.classList.remove("theme-light")):(document.body.classList.add("theme-light"),document.body.classList.remove("theme-dark")),window.innerWidth<480?document.body.classList.add("is-phone"):window.innerWidth<768?document.body.classList.add("is-tablet"):window.innerWidth<1024?document.body.classList.add("is-small-screen"):document.body.classList.add("is-large-screen")</script><div class="webpage-container workspace"><div class="sidebar-left sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"><label class="theme-toggle-container" for="theme_toggle"><input class="theme-toggle-input" type="checkbox" id="theme_toggle"><div class="toggle-background"></div></label></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content"><div class="search-input-container"><input enterkeyhint="search" type="search" spellcheck="false" placeholder="Search..."><div class="search-input-clear-button" aria-label="Clear search"></div></div><include src="lib/html/file-tree.html"></include></div><script defer="">let ls = document.querySelector(".sidebar-left"); ls.classList.add("is-collapsed"); if (window.innerWidth > 768) ls.classList.remove("is-collapsed"); ls.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-left-width"));</script></div><div class="document-container markdown-reading-view hide"><div class="markdown-preview-view markdown-rendered allow-fold-headings allow-fold-lists is-readable-line-width"><style id="MJX-CHTML-styles"></style><div class="markdown-preview-sizer markdown-preview-section"><h1 class="page-title heading inline-title" id="Inyecciones XPath"><p>Inyecciones XPath</p></h1><div><hr></div><div><ul>
<li data-line="0">Tags: <a href="?query=tag:ataques" class="tag" target="_blank" rel="noopener">#ataques</a> <a href="?query=tag:teoria" class="tag" target="_blank" rel="noopener">#teoria</a> <a href="?query=tag:practica" class="tag" target="_blank" rel="noopener">#practica</a> <a href="?query=tag:basico" class="tag" target="_blank" rel="noopener">#basico</a> </li>
</ul></div><div><hr></div><div class="heading-wrapper"><h1 data-heading="Â¿ Que es **XPath** ?" class="heading" id="Â¿_Que_es_**XPath**_?">Â¿ Que es <strong>XPath</strong> ?</h1><div class="heading-children"><div><p><strong>XPath</strong> es un lenguaje de consultas utilizado en <strong>XML</strong> que permite buscar y recuperar informaciÃ³n especÃ­fica de <strong>documentos XML</strong>. Sin embargo, al igual que otros lenguajes de programaciÃ³n y consultas, XPath tmabiÃ©n puede tener <strong>vulnerabilidades</strong> que los atacantes pueden aprovechar para comprometer la seguridad de una aplicaciÃ³n web. </p></div><div><p>Las <strong>vulnerabilidades XPath</strong> son aquellas que se aprovechan de las debilidades en la implementaciÃ³n de consultas XPath en una aplicaciÃ³n web. A continuaciÃ³n, se describen algunos tipos de vulnerabilidades comunes en XPath: </p></div><div><ul>
<li data-line="0">
<h3 data-heading="**InyecciÃ³n XPath:** Los atacantes pueden utilizar inyecciÃ³n de cÃ³digo malicioso en las consultas XPath para alterar el comportamiento de la aplicaciÃ³n. Por ejemplo, pueden agregar una consulta maliciosa que recupere toda la informaciÃ³n del usuario, incluso informaciÃ³n confidencial como contraseÃ±as." class="heading" id="**InyecciÃ³n_XPath:**_Los_atacantes_pueden_utilizar_inyecciÃ³n_de_cÃ³digo_malicioso_en_las_consultas_XPath_para_alterar_el_comportamiento_de_la_aplicaciÃ³n._Por_ejemplo,_pueden_agregar_una_consulta_maliciosa_que_recupere_toda_la_informaciÃ³n_del_usuario,_incluso_informaciÃ³n_confidencial_como_contraseÃ±as."><strong>InyecciÃ³n XPath:</strong> Los atacantes pueden utilizar inyecciÃ³n de cÃ³digo malicioso en las consultas XPath para alterar el comportamiento de la aplicaciÃ³n. Por ejemplo, pueden agregar una consulta maliciosa que recupere toda la informaciÃ³n del usuario, incluso informaciÃ³n confidencial como contraseÃ±as.</h3>
</li>
<li data-line="1">
<h3 data-heading="**Fuerza bruta de XPath:** Los atacantes pueden utilizar tÃ©cnicas de fuerza bruta para adivinar las rutas de XPat y recuperar informaciÃ³n confidencail. Esta tÃ©cnica se basa en intentar diferentes rutas XPath hasta encontrar una que devuelva informaciÃ³n confidencial." class="heading" id="**Fuerza_bruta_de_XPath:**_Los_atacantes_pueden_utilizar_tÃ©cnicas_de_fuerza_bruta_para_adivinar_las_rutas_de_XPat_y_recuperar_informaciÃ³n_confidencail._Esta_tÃ©cnica_se_basa_en_intentar_diferentes_rutas_XPath_hasta_encontrar_una_que_devuelva_informaciÃ³n_confidencial."><strong>Fuerza bruta de XPath:</strong> Los atacantes pueden utilizar tÃ©cnicas de fuerza bruta para adivinar las rutas de XPat y recuperar informaciÃ³n confidencail. Esta tÃ©cnica se basa en intentar diferentes rutas XPath hasta encontrar una que devuelva informaciÃ³n confidencial.</h3>
</li>
<li data-line="2">
<h3 data-heading="**RecuperaciÃ³n de informaciÃ³n del servidor:** Los atacantes pueden utilizar consultas XPath maliciosas para obtener informaciÃ³n sobre el servidor, como el tipo de base de datos, la versiÃ³ mde la aplicaciÃ³n, etc. Esta informaciÃ³n puede ayudar a los atacantes a planear ataque smÃ¡s sofisticados." class="heading" id="**RecuperaciÃ³n_de_informaciÃ³n_del_servidor:**_Los_atacantes_pueden_utilizar_consultas_XPath_maliciosas_para_obtener_informaciÃ³n_sobre_el_servidor,_como_el_tipo_de_base_de_datos,_la_versiÃ³_mde_la_aplicaciÃ³n,_etc._Esta_informaciÃ³n_puede_ayudar_a_los_atacantes_a_planear_ataque_smÃ¡s_sofisticados."><strong>RecuperaciÃ³n de informaciÃ³n del servidor:</strong> Los atacantes pueden utilizar consultas XPath maliciosas para obtener informaciÃ³n sobre el servidor, como el tipo de base de datos, la versiÃ³ mde la aplicaciÃ³n, etc. Esta informaciÃ³n puede ayudar a los atacantes a planear ataque smÃ¡s sofisticados.</h3>
</li>
<li data-line="3">
<h3 data-heading="**ManipulaciÃ³n de respuestas XPath:** Los atacantes pueden manipular las respuestas XPath de la aplicaciÃ³n web para obtener informaciÃ³n adicional o alterar el comportamiento de la aplicaciÃ³n. Por ejemplo, pueden modificar una respuesta XPath para crear una cuenta de usuario sin permiso." class="heading" id="**ManipulaciÃ³n_de_respuestas_XPath:**_Los_atacantes_pueden_manipular_las_respuestas_XPath_de_la_aplicaciÃ³n_web_para_obtener_informaciÃ³n_adicional_o_alterar_el_comportamiento_de_la_aplicaciÃ³n._Por_ejemplo,_pueden_modificar_una_respuesta_XPath_para_crear_una_cuenta_de_usuario_sin_permiso."><strong>ManipulaciÃ³n de respuestas XPath:</strong> Los atacantes pueden manipular las respuestas XPath de la aplicaciÃ³n web para obtener informaciÃ³n adicional o alterar el comportamiento de la aplicaciÃ³n. Por ejemplo, pueden modificar una respuesta XPath para crear una cuenta de usuario sin permiso.</h3>
</li>
</ul></div><div><hr></div></div></div><div class="heading-wrapper"><h1 data-heading="Evitar estos ataques" class="heading" id="Evitar_estos_ataques">Evitar estos ataques</h1><div class="heading-children"><div><p>Para protegerse contra las vulnerabilidades XPath, es importante validar todas las entradas de usuario y evitar la construcciÃ³n dinÃ¡mica de consultas XPath. AdemÃ¡s, se recomienda restringir los permisos de acceso a los recursos de la aplicaciÃ³n web y mantener actualizado el software y los sistemas operativos. Por Ãºltimo, se recomienda utilizar herramientas de anÃ¡lisis de seguridad y realizar pruebas de penetraciÃ³n regulares para identificar y corregir cualquie rvulnerabilidad en la aplicaciÃ³n web. </p></div><div><hr></div></div></div><div class="heading-wrapper"><h1 data-heading="ExplotaciÃ³n" class="heading" id="ExplotaciÃ³n">ExplotaciÃ³n</h1><div class="heading-children"><div><p>Como en las <a data-href="SQLI - (Inyecciones SQL)" href="notes/4.-cybersecurity/redteam/pentesting/sistemas/2.-fases-auditoria/2.-explotaciÃ³n/vulnerabilidades/sqli-(inyecciones-sql).html" class="internal-link" target="_self" rel="noopener">SQLI - (Inyecciones SQL)</a> y en las <a data-href="NoSQLI - (NoSQL Injections)" href="notes/4.-cybersecurity/redteam/pentesting/sistemas/2.-fases-auditoria/2.-explotaciÃ³n/vulnerabilidades/nosqli-(nosql-injections).html" class="internal-link" target="_self" rel="noopener">NoSQLI - (NoSQL Injections)</a>, esto comienza por un campo que parece posiblemente vulnerable a alugna inyeccion de estas, por lo que de primeras provariamos tanto SQLI como NoSQLI, pero podrÃ­a ser el caso de que la query <strong>' or '1'='1</strong> funcione aumentando aun mÃ¡s las sospechas de una posbile inyecciÃ³n, pero al continuar probando multiples querys maliciosas de SQLI y NoSQLI veriamos que no llegamos a nada.</p></div><div><p>En este punto, podrÃ­amos empezar a barajar la posiblidad de estar enfrente a una <strong>XPath Injection</strong>. Por lo que sabemos, XPath es un lenguaje de consultas dirigido hacia un archivo en formato XML, por lo cual la idea principal serÃ­a comenzar a tramitar inyecciones XPath para dumpear el archivo XML. </p></div><div><p>Lo primero es intentar verificar cuantes etiquetas PRIMARIAS existen, es decir, en una estructura XML tal que asÃ­: </p></div><div><pre class="language-xml" tabindex="0"><code class="language-xml is-loaded"><span class="token prolog">&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>data</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>user</span><span class="token punctuation">&gt;</span></span>
	    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>pepe<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
	    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>password</span><span class="token punctuation">&gt;</span></span>peponcio<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>password</span><span class="token punctuation">&gt;</span></span>
	    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>account</span><span class="token punctuation">&gt;</span></span>admin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>account</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>user</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>user</span><span class="token punctuation">&gt;</span></span>
	    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>mark<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
	    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>password</span><span class="token punctuation">&gt;</span></span>m12345<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>password</span><span class="token punctuation">&gt;</span></span>
	    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>account</span><span class="token punctuation">&gt;</span></span>regular<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>account</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>user</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>user</span><span class="token punctuation">&gt;</span></span>
	    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>fino<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
	    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>password</span><span class="token punctuation">&gt;</span></span>fino2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>password</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>account</span><span class="token punctuation">&gt;</span></span>regular<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>account</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>user</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>data</span><span class="token punctuation">&gt;</span></span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p>TendrÃ­amos una etiqueta primarÃ­a la cual serÃ­a DATA.  Por lo que para verificar esto, existe la query: </p></div><div><p><code>1' and count(/*)='1</code></p></div><div><p>De esta manera, le indicamos que si la suma de todas las etiquetas raizes (PRIMARIAS), es igual a 1, la query se convierta a TRUE. Pudiendo asÃ­, verificar que las etiquetas primarias son (en este caso) 1. </p></div><div><p>Una vez sabiendo la cantidad de etiquetas primarias, tocaria comenzar a descifrar el valor de esta misma. </p></div><div><p>Con la query <code>1' and name(/*[1])='data</code> estariamos indicando que el valor de la primera etiqueta es data, de manera que donde pone [ 1 ] prodrÃ­amos cambiarlo por otros valores en caso de existir otra etiqueta, ahora bien, esto sirve para saber el nombre COMPLETO, pero si quisieramos dumpear este valor que de primer no conocemos, deberiamos hacer de una menera similar a las <a data-href="SQLI - (Inyecciones SQL)" href="notes/4.-cybersecurity/redteam/pentesting/sistemas/2.-fases-auditoria/2.-explotaciÃ³n/vulnerabilidades/sqli-(inyecciones-sql).html" class="internal-link" target="_self" rel="noopener">SQLI - (Inyecciones SQL)</a>, jugando con substring <code>1' and substring(name(/*[1]),1,1)='a</code> para que al igual que en las SQLI, podemos mediante fuerza bruta, extraer los valores correctos. </p></div><div><p>Tambien podrÃ­amos extraer la longitud de la etiqueta en cuestion con la query <code>1' and string-length(name(/*[1]))&gt;'2</code> .</p></div><div><p>Una vez que tengamos las etiquetas principales, podriamos verificar la cantidad de etiquetas dentro de cada una de estas etiquetas primarias (En este caso hay 1), con la query <code>1' and count(/*[1]/*)='1</code>. </p></div><div><p>Y el mismo proceso, prodrÃ­amos ver el valor con <code>1' and name(/*[1]/*[1])='user</code> o con <code>1' and substring(name(/*[1]/*[1]),1,1)='u</code>.</p></div><div><p>Y de esta manera se vuelve constante, tanto para saber el la cantidad de etiquetas hijas que tiene una etiqueta padre, con <em>count</em>, como la longitud de una determinada etiqueta con <em>string-length</em>, como el nombre de una etiqueta con <em>name</em> o el primer, segundo, tercer, etc caracter con <em>substring</em>. Y para variar los niveles de las etiquetas <code>/*[1]/*[1]/*[1]</code>, en este caso estariamos referenciando a la etiqueta <strong>&lt;name&gt;</strong>. </p></div><div><p>Por ultimo, para que en base a determinada etiqueta podamos obtener los valores, usariamos la query <code>1' and substring(name,1,1)='n</code>, el primer 1 nos hace que las cosas sean un poco mÃ¡s faciles ya que apunta al primer producto. </p></div><div class="mod-footer"></div></div></div></div></div></div><div class="sidebar-right sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content"><div class="graph-view-wrapper"><div class="sidebar-section-header">Interactive Graph</div><div class="graph-view-placeholder">
		<div class="graph-view-container">
			<div class="graph-icon graph-expand" role="button" aria-label="Expand" data-tooltip-position="top"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><line x1="7" y1="17" x2="17" y2="7"></line><polyline points="7 7 17 7 17 17"></polyline></svg></div>
			<canvas id="graph-canvas" class="hide" width="512px" height="512px"></canvas>
		</div>
		</div></div><div class="tree-container mod-root nav-folder tree-item outline-tree" data-depth="0"><div class="tree-header"><span class="sidebar-section-header">Table Of Contents</span><button class="clickable-icon collapse-tree-button" aria-label="Collapse All"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></svg></button></div><div class="tree-scroll-area tree-item-children nav-folder-children"><div class="tree-item mod-tree-folder nav-folder mod-collapsible is-collapsed" style="display: none;"></div><div class="tree-item" data-depth="1"><a class="tree-link" href="notes\4.-cybersecurity\redteam\pentesting\sistemas\2.-fases-auditoria\2.-explotaciÃ³n\vulnerabilidades\inyecciones-xpath.html#Inyecciones XPath"><div class="tree-item-contents heading-link" heading-name="Inyecciones XPath"><span class="tree-item-title">Inyecciones XPath</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="1"><a class="tree-link" href="notes\4.-cybersecurity\redteam\pentesting\sistemas\2.-fases-auditoria\2.-explotaciÃ³n\vulnerabilidades\inyecciones-xpath.html#Â¿_Que_es_**XPath**_?"><div class="tree-item-contents heading-link" heading-name="Â¿ Que es **XPath** ?"><span class="tree-item-title">Â¿ Que es <strong>XPath</strong> ?</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="3"><a class="tree-link" href="notes\4.-cybersecurity\redteam\pentesting\sistemas\2.-fases-auditoria\2.-explotaciÃ³n\vulnerabilidades\inyecciones-xpath.html#**InyecciÃ³n_XPath:**_Los_atacantes_pueden_utilizar_inyecciÃ³n_de_cÃ³digo_malicioso_en_las_consultas_XPath_para_alterar_el_comportamiento_de_la_aplicaciÃ³n._Por_ejemplo,_pueden_agregar_una_consulta_maliciosa_que_recupere_toda_la_informaciÃ³n_del_usuario,_incluso_informaciÃ³n_confidencial_como_contraseÃ±as."><div class="tree-item-contents heading-link" heading-name="**InyecciÃ³n XPath:** Los atacantes pueden utilizar inyecciÃ³n de cÃ³digo malicioso en las consultas XPath para alterar el comportamiento de la aplicaciÃ³n. Por ejemplo, pueden agregar una consulta maliciosa que recupere toda la informaciÃ³n del usuario, incluso informaciÃ³n confidencial como contraseÃ±as."><span class="tree-item-title"><strong>InyecciÃ³n XPath:</strong> Los atacantes pueden utilizar inyecciÃ³n de cÃ³digo malicioso en las consultas XPath para alterar el comportamiento de la aplicaciÃ³n. Por ejemplo, pueden agregar una consulta maliciosa que recupere toda la informaciÃ³n del usuario, incluso informaciÃ³n confidencial como contraseÃ±as.</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="notes\4.-cybersecurity\redteam\pentesting\sistemas\2.-fases-auditoria\2.-explotaciÃ³n\vulnerabilidades\inyecciones-xpath.html#**Fuerza_bruta_de_XPath:**_Los_atacantes_pueden_utilizar_tÃ©cnicas_de_fuerza_bruta_para_adivinar_las_rutas_de_XPat_y_recuperar_informaciÃ³n_confidencail._Esta_tÃ©cnica_se_basa_en_intentar_diferentes_rutas_XPath_hasta_encontrar_una_que_devuelva_informaciÃ³n_confidencial."><div class="tree-item-contents heading-link" heading-name="**Fuerza bruta de XPath:** Los atacantes pueden utilizar tÃ©cnicas de fuerza bruta para adivinar las rutas de XPat y recuperar informaciÃ³n confidencail. Esta tÃ©cnica se basa en intentar diferentes rutas XPath hasta encontrar una que devuelva informaciÃ³n confidencial."><span class="tree-item-title"><strong>Fuerza bruta de XPath:</strong> Los atacantes pueden utilizar tÃ©cnicas de fuerza bruta para adivinar las rutas de XPat y recuperar informaciÃ³n confidencail. Esta tÃ©cnica se basa en intentar diferentes rutas XPath hasta encontrar una que devuelva informaciÃ³n confidencial.</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="notes\4.-cybersecurity\redteam\pentesting\sistemas\2.-fases-auditoria\2.-explotaciÃ³n\vulnerabilidades\inyecciones-xpath.html#**RecuperaciÃ³n_de_informaciÃ³n_del_servidor:**_Los_atacantes_pueden_utilizar_consultas_XPath_maliciosas_para_obtener_informaciÃ³n_sobre_el_servidor,_como_el_tipo_de_base_de_datos,_la_versiÃ³_mde_la_aplicaciÃ³n,_etc._Esta_informaciÃ³n_puede_ayudar_a_los_atacantes_a_planear_ataque_smÃ¡s_sofisticados."><div class="tree-item-contents heading-link" heading-name="**RecuperaciÃ³n de informaciÃ³n del servidor:** Los atacantes pueden utilizar consultas XPath maliciosas para obtener informaciÃ³n sobre el servidor, como el tipo de base de datos, la versiÃ³ mde la aplicaciÃ³n, etc. Esta informaciÃ³n puede ayudar a los atacantes a planear ataque smÃ¡s sofisticados."><span class="tree-item-title"><strong>RecuperaciÃ³n de informaciÃ³n del servidor:</strong> Los atacantes pueden utilizar consultas XPath maliciosas para obtener informaciÃ³n sobre el servidor, como el tipo de base de datos, la versiÃ³ mde la aplicaciÃ³n, etc. Esta informaciÃ³n puede ayudar a los atacantes a planear ataque smÃ¡s sofisticados.</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="notes\4.-cybersecurity\redteam\pentesting\sistemas\2.-fases-auditoria\2.-explotaciÃ³n\vulnerabilidades\inyecciones-xpath.html#**ManipulaciÃ³n_de_respuestas_XPath:**_Los_atacantes_pueden_manipular_las_respuestas_XPath_de_la_aplicaciÃ³n_web_para_obtener_informaciÃ³n_adicional_o_alterar_el_comportamiento_de_la_aplicaciÃ³n._Por_ejemplo,_pueden_modificar_una_respuesta_XPath_para_crear_una_cuenta_de_usuario_sin_permiso."><div class="tree-item-contents heading-link" heading-name="**ManipulaciÃ³n de respuestas XPath:** Los atacantes pueden manipular las respuestas XPath de la aplicaciÃ³n web para obtener informaciÃ³n adicional o alterar el comportamiento de la aplicaciÃ³n. Por ejemplo, pueden modificar una respuesta XPath para crear una cuenta de usuario sin permiso."><span class="tree-item-title"><strong>ManipulaciÃ³n de respuestas XPath:</strong> Los atacantes pueden manipular las respuestas XPath de la aplicaciÃ³n web para obtener informaciÃ³n adicional o alterar el comportamiento de la aplicaciÃ³n. Por ejemplo, pueden modificar una respuesta XPath para crear una cuenta de usuario sin permiso.</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div><div class="tree-item" data-depth="1"><a class="tree-link" href="notes\4.-cybersecurity\redteam\pentesting\sistemas\2.-fases-auditoria\2.-explotaciÃ³n\vulnerabilidades\inyecciones-xpath.html#Evitar_estos_ataques"><div class="tree-item-contents heading-link" heading-name="Evitar estos ataques"><span class="tree-item-title">Evitar estos ataques</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="1"><a class="tree-link" href="notes\4.-cybersecurity\redteam\pentesting\sistemas\2.-fases-auditoria\2.-explotaciÃ³n\vulnerabilidades\inyecciones-xpath.html#ExplotaciÃ³n"><div class="tree-item-contents heading-link" heading-name="ExplotaciÃ³n"><span class="tree-item-title">ExplotaciÃ³n</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div></div><script defer="">let rs = document.querySelector(".sidebar-right"); rs.classList.add("is-collapsed"); if (window.innerWidth > 768) rs.classList.remove("is-collapsed"); rs.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-right-width"));</script></div></div></body></html>