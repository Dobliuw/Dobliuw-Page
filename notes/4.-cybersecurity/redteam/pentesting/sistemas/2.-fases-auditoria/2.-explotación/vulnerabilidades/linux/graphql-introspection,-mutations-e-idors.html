<!DOCTYPE html> <html><head>
		<title>GraphQL Introspection, Mutations e IDORs</title>
		<base href="..\..\..\..\..\..\..\..\../">
		<meta id="root-path" root-path="..\..\..\..\..\..\..\..\../">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=1.0, maximum-scale=5.0">
		<meta charset="UTF-8">
		<meta name="description" content="Hacking - GraphQL Introspection, Mutations e IDORs">
		<meta property="og:title" content="GraphQL Introspection, Mutations e IDORs">
		<meta property="og:description" content="Hacking - GraphQL Introspection, Mutations e IDORs">
		<meta property="og:type" content="website">
		<meta property="og:url" content="notes/4.-cybersecurity/redteam/pentesting/sistemas/2.-fases-auditoria/2.-explotación/vulnerabilidades/linux/graphql-introspection,-mutations-e-idors.html">
		<meta property="og:image" content="lib\media\graphql.png">
		<meta property="og:site_name" content="Hacking">
		<link rel="alternate" type="application/rss+xml" title="RSS Feed" href="lib/rss.xml"><script async="" id="webpage-script" src="lib/scripts/webpage.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script type="module" async="" id="graph-view-script" src="lib/scripts/graph-view.js"></script><script async="" id="graph-wasm-script" src="lib/scripts/graph-wasm.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="graph-render-worker-script" src="lib/scripts/graph-render-worker.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="tinycolor-script" src="lib/scripts/tinycolor.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="pixi-script" src="https://cdnjs.cloudflare.com/ajax/libs/pixi.js/7.4.0/pixi.min.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="minisearch-script" src="https://cdn.jsdelivr.net/npm/minisearch@6.3.0/dist/umd/index.min.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><link rel="icon" href="lib/media/favicon.png"><script async="" id="graph-data-script" src="lib/scripts/graph-data.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><style>body{--line-width:40em;--line-width-adaptive:40em;--file-line-width:40em;--sidebar-width:min(20em, 80vw);--collapse-arrow-size:11px;--tree-horizontal-spacing:0.6em;--tree-vertical-spacing:0.6em;--sidebar-margin:12px}.sidebar{height:100%;min-width:calc(var(--sidebar-width) + var(--divider-width-hover));max-width:calc(var(--sidebar-width) + var(--divider-width-hover));font-size:14px;z-index:10;position:relative;overflow:hidden;transition:min-width ease-in-out,max-width ease-in-out;transition-duration:.2s;contain:size}.sidebar-left{left:0}.sidebar-right{right:0}.sidebar.is-collapsed{min-width:0;max-width:0}body.floating-sidebars .sidebar{position:absolute}.sidebar-content{height:100%;min-width:calc(var(--sidebar-width) - var(--divider-width-hover));top:0;padding:var(--sidebar-margin);padding-top:4em;line-height:var(--line-height-tight);background-color:var(--background-secondary);transition:background-color,border-right,border-left,box-shadow;transition-duration:var(--color-fade-speed);transition-timing-function:ease-in-out;position:absolute;display:flex;flex-direction:column}.sidebar:not(.is-collapsed) .sidebar-content{min-width:calc(max(100%,var(--sidebar-width)) - 3px);max-width:calc(max(100%,var(--sidebar-width)) - 3px)}.sidebar-left .sidebar-content{left:0;border-top-right-radius:var(--radius-l);border-bottom-right-radius:var(--radius-l)}.sidebar-right .sidebar-content{right:0;border-top-left-radius:var(--radius-l);border-bottom-left-radius:var(--radius-l)}.sidebar:has(.sidebar-content:empty):has(.topbar-content:empty){display:none}.sidebar-topbar{height:2em;width:var(--sidebar-width);top:var(--sidebar-margin);padding-inline:var(--sidebar-margin);z-index:1;position:fixed;display:flex;align-items:center;transition:width ease-in-out;transition-duration:inherit}.sidebar.is-collapsed .sidebar-topbar{width:calc(2.3em + var(--sidebar-margin) * 2)}.sidebar .sidebar-topbar.is-collapsed{width:0}.sidebar-left .sidebar-topbar{left:0}.sidebar-right .sidebar-topbar{right:0}.topbar-content{overflow:hidden;overflow:clip;width:100%;height:100%;display:flex;align-items:center;transition:inherit}.sidebar.is-collapsed .topbar-content{width:0;transition:inherit}.clickable-icon.sidebar-collapse-icon{background-color:transparent;color:var(--icon-color-focused);padding:0!important;margin:0!important;height:100%!important;width:2.3em!important;margin-inline:0.14em!important;position:absolute}.sidebar-left .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);right:var(--sidebar-margin)}.sidebar-right .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);left:var(--sidebar-margin)}.clickable-icon.sidebar-collapse-icon svg.svg-icon{width:100%;height:100%}.sidebar-section-header{margin:0 0 1em 0;text-transform:uppercase;letter-spacing:.06em;font-weight:600}body{transition:background-color var(--color-fade-speed) ease-in-out}.webpage-container{display:flex;flex-direction:row;height:100%;width:100%;align-items:stretch;justify-content:center}.document-container{opacity:1;flex-basis:100%;max-width:100%;width:100%;height:100%;display:flex;flex-direction:column;align-items:center;transition:opacity .2s ease-in-out;contain:inline-size}.hide{opacity:0;transition:opacity .2s ease-in-out}.document-container>.markdown-preview-view{margin:var(--sidebar-margin);margin-bottom:0;width:100%;width:-webkit-fill-available;width:-moz-available;width:fill-available;background-color:var(--background-primary);transition:background-color var(--color-fade-speed) ease-in-out;border-top-right-radius:var(--window-radius,var(--radius-m));border-top-left-radius:var(--window-radius,var(--radius-m));overflow-x:hidden!important;overflow-y:auto!important;display:flex!important;flex-direction:column!important;align-items:center!important;contain:inline-size}.document-container>.markdown-preview-view>.markdown-preview-sizer{padding-bottom:80vh!important;width:100%!important;max-width:var(--line-width)!important;flex-basis:var(--line-width)!important;transition:background-color var(--color-fade-speed) ease-in-out;contain:inline-size}.markdown-rendered img:not([width]),.view-content img:not([width]){max-width:100%;outline:0}.document-container>.view-content.embed{display:flex;padding:1em;height:100%;width:100%;align-items:center;justify-content:center}.document-container>.view-content.embed>*{max-width:100%;max-height:100%;object-fit:contain}:has(> :is(.math,table)){overflow-x:auto!important}.document-container>.view-content{overflow-x:auto;contain:content;padding:0;margin:0;height:100%}.scroll-highlight{position:absolute;width:100%;height:100%;pointer-events:none;z-index:1000;background-color:hsla(var(--color-accent-hsl),.25);opacity:0;padding:1em;inset:50%;translate:-50% -50%;border-radius:var(--radius-s)}</style><script defer="">async function loadIncludes(){if("file:"!=location.protocol){let e=document.querySelectorAll("include");for(let t=0;t<e.length;t++){let o=e[t],l=o.getAttribute("src");try{const e=await fetch(l);if(!e.ok){console.log("Could not include file: "+l),o?.remove();continue}let t=await e.text(),n=document.createRange().createContextualFragment(t),i=Array.from(n.children);for(let e of i)e.classList.add("hide"),e.style.transition="opacity 0.5s ease-in-out",setTimeout((()=>{e.classList.remove("hide")}),10);o.before(n),o.remove(),console.log("Included file: "+l)}catch(e){o?.remove(),console.log("Could not include file: "+l,e);continue}}}else{if(document.querySelectorAll("include").length>0){var e=document.createElement("div");e.id="error",e.textContent="Web server exports must be hosted on an http / web server to be viewed correctly.",e.style.position="fixed",e.style.top="50%",e.style.left="50%",e.style.transform="translate(-50%, -50%)",e.style.fontSize="1.5em",e.style.fontWeight="bold",e.style.textAlign="center",document.body.appendChild(e),document.querySelector(".document-container")?.classList.remove("hide")}}}document.addEventListener("DOMContentLoaded",(()=>{loadIncludes()}));let isFileProtocol="file:"==location.protocol;function waitLoadScripts(e,t){let o=e.map((e=>document.getElementById(e+"-script"))),l=0;!function e(){let n=o[l];l++,n&&"true"!=n.getAttribute("loaded")||l<o.length&&e(),l<o.length?n.addEventListener("load",e):t()}()}</script><link rel="stylesheet" href="lib/styles/obsidian.css"><link rel="stylesheet" href="lib/styles/theme.css"><link rel="preload" href="lib/styles/global-variable-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/global-variable-styles.css"></noscript><link rel="preload" href="lib/styles/main-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/main-styles.css"></noscript></head><body class="publish css-settings-manager theme-dark show-inline-title"><script defer="">let theme=localStorage.getItem("theme")||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light");"dark"==theme?(document.body.classList.add("theme-dark"),document.body.classList.remove("theme-light")):(document.body.classList.add("theme-light"),document.body.classList.remove("theme-dark")),window.innerWidth<480?document.body.classList.add("is-phone"):window.innerWidth<768?document.body.classList.add("is-tablet"):window.innerWidth<1024?document.body.classList.add("is-small-screen"):document.body.classList.add("is-large-screen")</script><div class="webpage-container workspace"><div class="sidebar-left sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"><label class="theme-toggle-container" for="theme_toggle"><input class="theme-toggle-input" type="checkbox" id="theme_toggle"><div class="toggle-background"></div></label></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content"><div class="search-input-container"><input enterkeyhint="search" type="search" spellcheck="false" placeholder="Search..."><div class="search-input-clear-button" aria-label="Clear search"></div></div><include src="lib/html/file-tree.html"></include></div><script defer="">let ls = document.querySelector(".sidebar-left"); ls.classList.add("is-collapsed"); if (window.innerWidth > 768) ls.classList.remove("is-collapsed"); ls.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-left-width"));</script></div><div class="document-container markdown-reading-view hide"><div class="markdown-preview-view markdown-rendered allow-fold-headings allow-fold-lists is-readable-line-width"><style id="MJX-CHTML-styles"></style><div class="markdown-preview-sizer markdown-preview-section"><h1 class="page-title heading inline-title" id="GraphQL Introspection, Mutations e IDORs"><p>GraphQL Introspection, Mutations e IDORs</p></h1><div><hr></div><div><ul>
<li data-line="0">Tags: <a href="?query=tag:basico" class="tag" target="_blank" rel="noopener">#basico</a> <a href="?query=tag:teoria" class="tag" target="_blank" rel="noopener">#teoria</a> <a href="?query=tag:practica" class="tag" target="_blank" rel="noopener">#practica</a> <a href="?query=tag:ataques" class="tag" target="_blank" rel="noopener">#ataques</a> </li>
</ul></div><div><hr></div><div class="heading-wrapper"><h1 data-heading="¿ Que es **GraphQL** ?" class="heading" id="¿_Que_es_**GraphQL**_?">¿ Que es <strong>GraphQL</strong> ?</h1><div class="heading-children"><div><p><strong>GraphQL</strong> es un lenguaje de consultas para <strong>APIs (Application Programming Interfaces)</strong> que se ha vuelto cada vez más popular en los últimos años. A diferencia de las APIs tradicionales que tiene endpoints fijos, GraphQL permite a los clientes solicitar sólo la información que necesita y obtener una respuesta personalizada en función de sus necesidades. </p></div><div><hr></div></div></div><div class="heading-wrapper"><h1 data-heading="¿ Que es **Introspection** ?" class="heading" id="¿_Que_es_**Introspection**_?">¿ Que es <strong>Introspection</strong> ?</h1><div class="heading-children"><div><p><strong>Introspection</strong> en GraphQL es un mecanismo que permite a los clientes <strong>obtener información</strong> sobre el esquema GraphQL de una API. Esto significa que los clientes pueden explorar y descubrir los tipos de datos, los campos y las relaciones que existen en la API, lo que puede ser muy útil para los desarrolladores que necesitan construir clientes GraphQL. Sin embargo, la introspección también puede ser utilizada por los atacantes para obtener información sensible sobre la estructura y los datos que existen en la API, lo que puede ser utilizado para llevar a cabo ataques más sofisticados. </p></div><div><hr></div></div></div><div class="heading-wrapper"><h1 data-heading="¿ Que son las **Mutations** ?" class="heading" id="¿_Que_son_las_**Mutations**_?">¿ Que son las <strong>Mutations</strong> ?</h1><div class="heading-children"><div><p>Las <strong>Mutations</strong> en GraphQL son operaciones que permiten a los clientes <strong>modificar los datos</strong> en la API. A diferencia de las consultas, que sólo permiten la lectura de los datos, las mutaciones permiten a los clientes agregar, actualizar o eliminar datos .Esto significa que las mutaciones tiene el potencial de ser utilizadas para realizar cambios importantes en la base de datos subyacente de la API. Si no se protegen adecuadamente, las mutaciones pueden ser explotadas por los atacantes para realizar cambios malintencionados en la API, como la eliminación de datos importantes o la creación de nuevos registros. </p></div><div><hr></div></div></div><div class="heading-wrapper"><h1 data-heading="¿ Que son los **IDORs** en GraphQL ?" class="heading" id="¿_Que_son_los_**IDORs**_en_GraphQL_?">¿ Que son los <strong>IDORs</strong> en GraphQL ?</h1><div class="heading-children"><div><p>En el contexto de GraphQL, los <a data-href="IDORs - ( Insecure Direct Object Reference )" href="notes/4.-cybersecurity/redteam/pentesting/sistemas/2.-fases-auditoria/2.-explotación/vulnerabilidades/linux/idors-(-insecure-direct-object-reference-).html" class="internal-link" target="_self" rel="noopener">IDORs - ( Insecure Direct Object Reference )</a> pueden ocurrir cuando un atacantes es capaz de adivinar o enumerar identificadores (<strong>IDs</strong>) de objetos dentro de la API, y puede utilizar esos IDs para acceder a objetos a los que no debería tener acceso. Esto puede ocurrir porque los desarrolladores de la API pueden no haber implementado adecuadamente los mecanismos de autenticación y autorización en su API. </p></div><div><hr></div></div></div><div class="heading-wrapper"><h1 data-heading="Explotación" class="heading" id="Explotación">Explotación</h1><div class="heading-children"><div><ul>
<li data-line="0">
<h2 data-heading="IDORs:" class="heading" id="IDORs:">IDORs:</h2>
</li>
</ul></div><div><p>Por ejemplo a la hora de explotar un <a data-href="IDORs - ( Insecure Direct Object Reference )" href="notes/4.-cybersecurity/redteam/pentesting/sistemas/2.-fases-auditoria/2.-explotación/vulnerabilidades/linux/idors-(-insecure-direct-object-reference-).html" class="internal-link" target="_self" rel="noopener">IDORs - ( Insecure Direct Object Reference )</a> en el contexto de GraphQL, se puede dar debido a una mala configuración de los desarrolladores permitiendo a un usuario enumerar información privada de otros usuarios, por ejemplo...</p></div><div><p>Nos encontramos en una aplicación en donde con una de las <a data-href="⚒ Herramientas ⚒" href="notes/4.-cybersecurity/redteam/pentesting/sistemas/herramientas/⚒-herramientas-⚒.html" class="internal-link" target="_self" rel="noopener">⚒ Herramientas ⚒</a> de enumeración como <strong>gobuster</strong> encontramos una ruta, supongamos que <em>/settings</em>, en esta lo que vemos es información de nuestra cuenta ( Estando logueados como un usuario ). Si interceptamos esta petición con <a data-href="Burpsuite" href="notes/4.-cybersecurity/redteam/pentesting/sistemas/herramientas/burpsuite.html" class="internal-link" target="_self" rel="noopener">Burpsuite</a> veremos que se tramita una petición de tipo POST a una API de GraphQL en donde por body se envía algo tal que así: </p></div><div><pre class="language-json" tabindex="0"><code class="language-json is-loaded"><span class="token punctuation">{</span><span class="token property">"query"</span><span class="token operator">:</span><span class="token string">"{ UserInfo (id: 43) {\n          \t\t\t\tapi_key\n          \t\t\t\tname\n          \t\t\t\tsurname\n          \t\t\t\tdate_of_birth\n        \t\t\t\t}\n      \t\t\t}\n        \t\t\t\t"</span><span class="token punctuation">}</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p>Por lo que deducimos que se esta solicitando los campos <strong>api_key, name, surname y date_of_birth</strong> del user donde el <strong>id</strong> es <strong>43</strong>, por lo que este ID haría referencia a nuestro ID de usuario, por lo que si cambiamos dicho ID por el <strong>1</strong> u otros y recibo los datos de vuelta, estaríamos explotando un <a data-href="IDORs - ( Insecure Direct Object Reference )" href="notes/4.-cybersecurity/redteam/pentesting/sistemas/2.-fases-auditoria/2.-explotación/vulnerabilidades/linux/idors-(-insecure-direct-object-reference-).html" class="internal-link" target="_self" rel="noopener">IDORs - ( Insecure Direct Object Reference )</a> ya que como un usuario no debería poder tener acceso a datos personales de un usuario ajeno. </p></div><div><hr></div><div><ul>
<li data-line="0">
<h2 data-heading="Introspection:" class="heading" id="Introspection:">Introspection:</h2>
</li>
</ul></div><div><p>En la <strong>introspection</strong> como mencionamos anteriormente, podemos <strong>obtener información</strong> acerca de la base de datos mediante peticiones de GraphQL, por lo que si viéramos como en el caso anterior, una petición que se lanza hacía una ruta <strong>/graphql</strong>, ya que esto no deja de ser una API podríamos ver si tenemos la posibilidad de ingresar a esta ruta para interactuar con el apartado de búsqueda de GraphQL: </p></div><div><p><span alt="graphql.png" src="graphql.png" class="internal-embed media-embed image-embed is-loaded"><img alt="graphql.png" src="lib/media/graphql.png"></span></p></div><div><p>En donde, si hiciéramos uso de páginas como <a data-tooltip-position="top" aria-label="https://book.hacktricks.xyz/network-services-pentesting/pentesting-web/graphql" rel="noopener" class="external-link" href="https://book.hacktricks.xyz/network-services-pentesting/pentesting-web/graphql" target="_blank">Hack Tricks</a> podríamos obtener querys para enumerar toda la información acerca de la base da datos  (Tablas, campos, etc) como la siguiente query: </p></div><div><pre class="language-json" tabindex="0"><code class="language-json is-loaded">fragment FullType on __Type <span class="token punctuation">{</span>
  kind
  name
  description
  fields <span class="token punctuation">{</span>
    name
    description
    args <span class="token punctuation">{</span>
      ...InputValue
    <span class="token punctuation">}</span>
    type <span class="token punctuation">{</span>
      ...TypeRef
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  inputFields <span class="token punctuation">{</span>
    ...InputValue
  <span class="token punctuation">}</span>
  interfaces <span class="token punctuation">{</span>
    ...TypeRef
  <span class="token punctuation">}</span>
  enumValues <span class="token punctuation">{</span>
    name
    description
  <span class="token punctuation">}</span>
  possibleTypes <span class="token punctuation">{</span>
    ...TypeRef
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

fragment InputValue on __InputValue <span class="token punctuation">{</span>
  name
  description
  type <span class="token punctuation">{</span>
    ...TypeRef
  <span class="token punctuation">}</span>
  defaultValue
<span class="token punctuation">}</span>

fragment TypeRef on __Type <span class="token punctuation">{</span>
  kind
  name
  ofType <span class="token punctuation">{</span>
    kind
    name
    ofType <span class="token punctuation">{</span>
      kind
      name
      ofType <span class="token punctuation">{</span>
        kind
        name
        ofType <span class="token punctuation">{</span>
          kind
          name
          ofType <span class="token punctuation">{</span>
            kind
            name
            ofType <span class="token punctuation">{</span>
              kind
              name
              ofType <span class="token punctuation">{</span>
                kind
                name
              <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>hicieramos
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

query IntrospectionQuery <span class="token punctuation">{</span>
  __schema <span class="token punctuation">{</span>
    queryType <span class="token punctuation">{</span>
      name
    <span class="token punctuation">}</span>
    mutationType <span class="token punctuation">{</span>
      name
    <span class="token punctuation">}</span>
    types <span class="token punctuation">{</span>
      ...FullType
    <span class="token punctuation">}</span>
    directives <span class="token punctuation">{</span>
      name
      description
      locations
      args <span class="token punctuation">{</span>
        ...InputValue
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code><button class="copy-code-button">Copy</button></pre></div><div class="heading-wrapper"><h4 data-heading="PD: Esta query suele estar mal en **Hack Tricks** por lo que hay que modificar agregando __ en los apartados de **Type, InputValue y schema**." class="heading" id="PD:_Esta_query_suele_estar_mal_en_**Hack_Tricks**_por_lo_que_hay_que_modificar_agregando____en_los_apartados_de_**Type,_InputValue_y_schema**."><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>PD: Esta query suele estar mal en <strong>Hack Tricks</strong> por lo que hay que modificar agregando __ en los apartados de <strong>Type, InputValue y schema</strong>.</h4><div class="heading-children"><div><p>Una vez tengamos la respuesta de GraphQL con toda la información acerca de las base de datos, simplemente deberíamos copiar dicha información devuelta, para pasarla a un <a data-tooltip-position="top" aria-label="https://github.com/graphql-kit/graphql-voyager" rel="noopener" class="external-link" href="https://github.com/graphql-kit/graphql-voyager" target="_blank">proyecto de GitHub</a> (El cual tiene <a data-tooltip-position="top" aria-label="https://graphql-kit.com/graphql-voyager/" rel="noopener" class="external-link" href="https://graphql-kit.com/graphql-voyager/" target="_blank">Live Mode</a>) donde podríamos ver de una manera más visual la administración de la/s base de dato/s: </p></div><div><p><span alt="LiveMode_graphql-kit.png" src="LiveMode_graphql-kit.png" class="internal-embed media-embed image-embed is-loaded"><img alt="LiveMode_graphql-kit.png" src="lib/media/livemode_graphql-kit.png"></span></p></div><div><p>Una vez entendida la administración de la/s base/s de dato/s, podríamos realizar peticiones más especificas para enumerar información sensible de usuarios, obtener contraseñas, ID's , etc. </p></div><div><pre class="language-json" tabindex="0"><code class="language-json is-loaded"># Si me interesara ver el ID<span class="token punctuation">,</span> username y si es administrador en base al ejemplo anterior dado<span class="token operator">:</span> 
<span class="token punctuation">{</span><span class="token property">"query"</span><span class="token operator">:</span><span class="token string">"{Users{id, username, isAdmin}}"</span><span class="token punctuation">}</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><hr></div><div><ul>
<li data-line="0">
<h2 data-heading="Mutation:" class="heading" id="Mutation:">Mutation:</h2>
</li>
</ul></div><div><p>Por ultimo, como vimos, las <strong>mutations</strong> son interacciones con GraphQL que permiten al usuario modificar, agregar o eliminar datos, por ejemplo, si siguiendo el ejemplo dado tuviéramos un botón de crear post, en donde podríamos crear un "post" con un titulo, mensaje, etc. si lo interceptáramos con <a data-href="Burpsuite" href="notes/4.-cybersecurity/redteam/pentesting/sistemas/herramientas/burpsuite.html" class="internal-link" target="_self" rel="noopener">Burpsuite</a> veríamos algo como lo siguiente: </p></div><div><pre class="language-json" tabindex="0"><code class="language-json is-loaded"><span class="token punctuation">{</span>
	<span class="token property">"query"</span><span class="token operator">:</span><span class="token string">"mutation { createPost(title: \"I'm the best hacker in this fucking life\", body: \"Bye\", author_id: 1) { id, title, body, author_id }}"</span>
<span class="token punctuation">}</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p>Podríamos probar alterar, en este caso, el ID para intentar crear un nuevo post como otro usuario, de esta manera estaríamos abusando de <strong>mutations</strong> para realizar acciones que no deberían estar permitidas. </p></div><div class="mod-footer"></div></div></div></div></div></div></div></div><div class="sidebar-right sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content"><div class="graph-view-wrapper"><div class="sidebar-section-header">Interactive Graph</div><div class="graph-view-placeholder">
		<div class="graph-view-container">
			<div class="graph-icon graph-expand" role="button" aria-label="Expand" data-tooltip-position="top"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><line x1="7" y1="17" x2="17" y2="7"></line><polyline points="7 7 17 7 17 17"></polyline></svg></div>
			<canvas id="graph-canvas" class="hide" width="512px" height="512px"></canvas>
		</div>
		</div></div><div class="tree-container mod-root nav-folder tree-item outline-tree" data-depth="0"><div class="tree-header"><span class="sidebar-section-header">Table Of Contents</span><button class="clickable-icon collapse-tree-button" aria-label="Collapse All"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></svg></button></div><div class="tree-scroll-area tree-item-children nav-folder-children"><div class="tree-item mod-tree-folder nav-folder mod-collapsible is-collapsed" style="display: none;"></div><div class="tree-item" data-depth="1"><a class="tree-link" href="notes\4.-cybersecurity\redteam\pentesting\sistemas\2.-fases-auditoria\2.-explotación\vulnerabilidades\linux\graphql-introspection,-mutations-e-idors.html#GraphQL Introspection, Mutations e IDORs"><div class="tree-item-contents heading-link" heading-name="GraphQL Introspection, Mutations e IDORs"><span class="tree-item-title">GraphQL Introspection, Mutations e IDORs</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="1"><a class="tree-link" href="notes\4.-cybersecurity\redteam\pentesting\sistemas\2.-fases-auditoria\2.-explotación\vulnerabilidades\linux\graphql-introspection,-mutations-e-idors.html#¿_Que_es_**GraphQL**_?"><div class="tree-item-contents heading-link" heading-name="¿ Que es **GraphQL** ?"><span class="tree-item-title">¿ Que es <strong>GraphQL</strong> ?</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="1"><a class="tree-link" href="notes\4.-cybersecurity\redteam\pentesting\sistemas\2.-fases-auditoria\2.-explotación\vulnerabilidades\linux\graphql-introspection,-mutations-e-idors.html#¿_Que_es_**Introspection**_?"><div class="tree-item-contents heading-link" heading-name="¿ Que es **Introspection** ?"><span class="tree-item-title">¿ Que es <strong>Introspection</strong> ?</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="1"><a class="tree-link" href="notes\4.-cybersecurity\redteam\pentesting\sistemas\2.-fases-auditoria\2.-explotación\vulnerabilidades\linux\graphql-introspection,-mutations-e-idors.html#¿_Que_son_las_**Mutations**_?"><div class="tree-item-contents heading-link" heading-name="¿ Que son las **Mutations** ?"><span class="tree-item-title">¿ Que son las <strong>Mutations</strong> ?</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="1"><a class="tree-link" href="notes\4.-cybersecurity\redteam\pentesting\sistemas\2.-fases-auditoria\2.-explotación\vulnerabilidades\linux\graphql-introspection,-mutations-e-idors.html#¿_Que_son_los_**IDORs**_en_GraphQL_?"><div class="tree-item-contents heading-link" heading-name="¿ Que son los **IDORs** en GraphQL ?"><span class="tree-item-title">¿ Que son los <strong>IDORs</strong> en GraphQL ?</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="1"><a class="tree-link" href="notes\4.-cybersecurity\redteam\pentesting\sistemas\2.-fases-auditoria\2.-explotación\vulnerabilidades\linux\graphql-introspection,-mutations-e-idors.html#Explotación"><div class="tree-item-contents heading-link" heading-name="Explotación"><span class="tree-item-title">Explotación</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="2"><a class="tree-link" href="notes\4.-cybersecurity\redteam\pentesting\sistemas\2.-fases-auditoria\2.-explotación\vulnerabilidades\linux\graphql-introspection,-mutations-e-idors.html#IDORs:"><div class="tree-item-contents heading-link" heading-name="IDORs:"><span class="tree-item-title">IDORs:</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-link" href="notes\4.-cybersecurity\redteam\pentesting\sistemas\2.-fases-auditoria\2.-explotación\vulnerabilidades\linux\graphql-introspection,-mutations-e-idors.html#Introspection:"><div class="tree-item-contents heading-link" heading-name="Introspection:"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">Introspection:</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="4"><a class="tree-link" href="notes\4.-cybersecurity\redteam\pentesting\sistemas\2.-fases-auditoria\2.-explotación\vulnerabilidades\linux\graphql-introspection,-mutations-e-idors.html#PD:_Esta_query_suele_estar_mal_en_**Hack_Tricks**_por_lo_que_hay_que_modificar_agregando____en_los_apartados_de_**Type,_InputValue_y_schema**."><div class="tree-item-contents heading-link" heading-name="PD: Esta query suele estar mal en **Hack Tricks** por lo que hay que modificar agregando __ en los apartados de **Type, InputValue y schema**."><span class="tree-item-title">PD: Esta query suele estar mal en <strong>Hack Tricks</strong> por lo que hay que modificar agregando __ en los apartados de <strong>Type, InputValue y schema</strong>.</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div><div class="tree-item" data-depth="2"><a class="tree-link" href="notes\4.-cybersecurity\redteam\pentesting\sistemas\2.-fases-auditoria\2.-explotación\vulnerabilidades\linux\graphql-introspection,-mutations-e-idors.html#Mutation:"><div class="tree-item-contents heading-link" heading-name="Mutation:"><span class="tree-item-title">Mutation:</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div></div></div></div><script defer="">let rs = document.querySelector(".sidebar-right"); rs.classList.add("is-collapsed"); if (window.innerWidth > 768) rs.classList.remove("is-collapsed"); rs.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-right-width"));</script></div></div></body></html>