<!DOCTYPE html> <html><head>
		<title>Detección y explotación de tareas Cron</title>
		<base href="..\..\..\..\..\..\../">
		<meta id="root-path" root-path="..\..\..\..\..\..\../">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=1.0, maximum-scale=5.0">
		<meta charset="UTF-8">
		<meta name="description" content="Hacking - Detección y explotación de tareas Cron">
		<meta property="og:title" content="Detección y explotación de tareas Cron">
		<meta property="og:description" content="Hacking - Detección y explotación de tareas Cron">
		<meta property="og:type" content="website">
		<meta property="og:url" content="notes/4.-cybersecurity/redteam/pentesting/sistemas/2.-fases-auditoria/3.-escalada-de-privilegios/detección-y-explotación-de-tareas-cron.html">
		<meta property="og:image" content="undefined">
		<meta property="og:site_name" content="Hacking">
		<link rel="alternate" type="application/rss+xml" title="RSS Feed" href="lib/rss.xml"><script async="" id="webpage-script" src="lib/scripts/webpage.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script type="module" async="" id="graph-view-script" src="lib/scripts/graph-view.js"></script><script async="" id="graph-wasm-script" src="lib/scripts/graph-wasm.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="graph-render-worker-script" src="lib/scripts/graph-render-worker.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="tinycolor-script" src="lib/scripts/tinycolor.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="pixi-script" src="https://cdnjs.cloudflare.com/ajax/libs/pixi.js/7.4.0/pixi.min.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="minisearch-script" src="https://cdn.jsdelivr.net/npm/minisearch@6.3.0/dist/umd/index.min.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><link rel="icon" href="lib/media/favicon.png"><script async="" id="graph-data-script" src="lib/scripts/graph-data.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><style>body{--line-width:40em;--line-width-adaptive:40em;--file-line-width:40em;--sidebar-width:min(20em, 80vw);--collapse-arrow-size:11px;--tree-horizontal-spacing:0.6em;--tree-vertical-spacing:0.6em;--sidebar-margin:12px}.sidebar{height:100%;min-width:calc(var(--sidebar-width) + var(--divider-width-hover));max-width:calc(var(--sidebar-width) + var(--divider-width-hover));font-size:14px;z-index:10;position:relative;overflow:hidden;transition:min-width ease-in-out,max-width ease-in-out;transition-duration:.2s;contain:size}.sidebar-left{left:0}.sidebar-right{right:0}.sidebar.is-collapsed{min-width:0;max-width:0}body.floating-sidebars .sidebar{position:absolute}.sidebar-content{height:100%;min-width:calc(var(--sidebar-width) - var(--divider-width-hover));top:0;padding:var(--sidebar-margin);padding-top:4em;line-height:var(--line-height-tight);background-color:var(--background-secondary);transition:background-color,border-right,border-left,box-shadow;transition-duration:var(--color-fade-speed);transition-timing-function:ease-in-out;position:absolute;display:flex;flex-direction:column}.sidebar:not(.is-collapsed) .sidebar-content{min-width:calc(max(100%,var(--sidebar-width)) - 3px);max-width:calc(max(100%,var(--sidebar-width)) - 3px)}.sidebar-left .sidebar-content{left:0;border-top-right-radius:var(--radius-l);border-bottom-right-radius:var(--radius-l)}.sidebar-right .sidebar-content{right:0;border-top-left-radius:var(--radius-l);border-bottom-left-radius:var(--radius-l)}.sidebar:has(.sidebar-content:empty):has(.topbar-content:empty){display:none}.sidebar-topbar{height:2em;width:var(--sidebar-width);top:var(--sidebar-margin);padding-inline:var(--sidebar-margin);z-index:1;position:fixed;display:flex;align-items:center;transition:width ease-in-out;transition-duration:inherit}.sidebar.is-collapsed .sidebar-topbar{width:calc(2.3em + var(--sidebar-margin) * 2)}.sidebar .sidebar-topbar.is-collapsed{width:0}.sidebar-left .sidebar-topbar{left:0}.sidebar-right .sidebar-topbar{right:0}.topbar-content{overflow:hidden;overflow:clip;width:100%;height:100%;display:flex;align-items:center;transition:inherit}.sidebar.is-collapsed .topbar-content{width:0;transition:inherit}.clickable-icon.sidebar-collapse-icon{background-color:transparent;color:var(--icon-color-focused);padding:0!important;margin:0!important;height:100%!important;width:2.3em!important;margin-inline:0.14em!important;position:absolute}.sidebar-left .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);right:var(--sidebar-margin)}.sidebar-right .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);left:var(--sidebar-margin)}.clickable-icon.sidebar-collapse-icon svg.svg-icon{width:100%;height:100%}.sidebar-section-header{margin:0 0 1em 0;text-transform:uppercase;letter-spacing:.06em;font-weight:600}body{transition:background-color var(--color-fade-speed) ease-in-out}.webpage-container{display:flex;flex-direction:row;height:100%;width:100%;align-items:stretch;justify-content:center}.document-container{opacity:1;flex-basis:100%;max-width:100%;width:100%;height:100%;display:flex;flex-direction:column;align-items:center;transition:opacity .2s ease-in-out;contain:inline-size}.hide{opacity:0;transition:opacity .2s ease-in-out}.document-container>.markdown-preview-view{margin:var(--sidebar-margin);margin-bottom:0;width:100%;width:-webkit-fill-available;width:-moz-available;width:fill-available;background-color:var(--background-primary);transition:background-color var(--color-fade-speed) ease-in-out;border-top-right-radius:var(--window-radius,var(--radius-m));border-top-left-radius:var(--window-radius,var(--radius-m));overflow-x:hidden!important;overflow-y:auto!important;display:flex!important;flex-direction:column!important;align-items:center!important;contain:inline-size}.document-container>.markdown-preview-view>.markdown-preview-sizer{padding-bottom:80vh!important;width:100%!important;max-width:var(--line-width)!important;flex-basis:var(--line-width)!important;transition:background-color var(--color-fade-speed) ease-in-out;contain:inline-size}.markdown-rendered img:not([width]),.view-content img:not([width]){max-width:100%;outline:0}.document-container>.view-content.embed{display:flex;padding:1em;height:100%;width:100%;align-items:center;justify-content:center}.document-container>.view-content.embed>*{max-width:100%;max-height:100%;object-fit:contain}:has(> :is(.math,table)){overflow-x:auto!important}.document-container>.view-content{overflow-x:auto;contain:content;padding:0;margin:0;height:100%}.scroll-highlight{position:absolute;width:100%;height:100%;pointer-events:none;z-index:1000;background-color:hsla(var(--color-accent-hsl),.25);opacity:0;padding:1em;inset:50%;translate:-50% -50%;border-radius:var(--radius-s)}</style><script defer="">async function loadIncludes(){if("file:"!=location.protocol){let e=document.querySelectorAll("include");for(let t=0;t<e.length;t++){let o=e[t],l=o.getAttribute("src");try{const e=await fetch(l);if(!e.ok){console.log("Could not include file: "+l),o?.remove();continue}let t=await e.text(),n=document.createRange().createContextualFragment(t),i=Array.from(n.children);for(let e of i)e.classList.add("hide"),e.style.transition="opacity 0.5s ease-in-out",setTimeout((()=>{e.classList.remove("hide")}),10);o.before(n),o.remove(),console.log("Included file: "+l)}catch(e){o?.remove(),console.log("Could not include file: "+l,e);continue}}}else{if(document.querySelectorAll("include").length>0){var e=document.createElement("div");e.id="error",e.textContent="Web server exports must be hosted on an http / web server to be viewed correctly.",e.style.position="fixed",e.style.top="50%",e.style.left="50%",e.style.transform="translate(-50%, -50%)",e.style.fontSize="1.5em",e.style.fontWeight="bold",e.style.textAlign="center",document.body.appendChild(e),document.querySelector(".document-container")?.classList.remove("hide")}}}document.addEventListener("DOMContentLoaded",(()=>{loadIncludes()}));let isFileProtocol="file:"==location.protocol;function waitLoadScripts(e,t){let o=e.map((e=>document.getElementById(e+"-script"))),l=0;!function e(){let n=o[l];l++,n&&"true"!=n.getAttribute("loaded")||l<o.length&&e(),l<o.length?n.addEventListener("load",e):t()}()}</script><link rel="stylesheet" href="lib/styles/obsidian.css"><link rel="stylesheet" href="lib/styles/theme.css"><link rel="preload" href="lib/styles/global-variable-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/global-variable-styles.css"></noscript><link rel="preload" href="lib/styles/main-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/main-styles.css"></noscript></head><body class="publish css-settings-manager theme-dark show-inline-title"><script defer="">let theme=localStorage.getItem("theme")||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light");"dark"==theme?(document.body.classList.add("theme-dark"),document.body.classList.remove("theme-light")):(document.body.classList.add("theme-light"),document.body.classList.remove("theme-dark")),window.innerWidth<480?document.body.classList.add("is-phone"):window.innerWidth<768?document.body.classList.add("is-tablet"):window.innerWidth<1024?document.body.classList.add("is-small-screen"):document.body.classList.add("is-large-screen")</script><div class="webpage-container workspace"><div class="sidebar-left sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"><label class="theme-toggle-container" for="theme_toggle"><input class="theme-toggle-input" type="checkbox" id="theme_toggle"><div class="toggle-background"></div></label></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content"><div class="search-input-container"><input enterkeyhint="search" type="search" spellcheck="false" placeholder="Search..."><div class="search-input-clear-button" aria-label="Clear search"></div></div><include src="lib/html/file-tree.html"></include></div><script defer="">let ls = document.querySelector(".sidebar-left"); ls.classList.add("is-collapsed"); if (window.innerWidth > 768) ls.classList.remove("is-collapsed"); ls.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-left-width"));</script></div><div class="document-container markdown-reading-view hide"><div class="markdown-preview-view markdown-rendered allow-fold-headings allow-fold-lists is-readable-line-width"><style id="MJX-CHTML-styles"></style><div class="markdown-preview-sizer markdown-preview-section"><h1 class="page-title heading inline-title" id="Detección y explotación de tareas Cron"><p>Detección y explotación de tareas Cron</p></h1><div><hr></div><div><ul>
<li data-line="0">Tags: <a href="?query=tag:escalada" class="tag" target="_blank" rel="noopener">#escalada</a> <a href="?query=tag:teoria" class="tag" target="_blank" rel="noopener">#teoria</a> <a href="?query=tag:practica" class="tag" target="_blank" rel="noopener">#practica</a></li>
</ul></div><div><hr></div><div class="heading-wrapper"><div class="heading-children"><div><p>Una tarea cron es una tarea programada en sistemas Unix/Linux que se ejecuta en un momento determinado o en intervalos regulares de tiempo. Estas tareas se definen en un archivo <strong>crontab</strong> que especifica qué comandos deben ejecutarse y cuándo deben hacerlo.</p></div><div><p>La detección y explotación de tareas cron es una técnica utilizada por los atacantes para elevar su nivel de acceso en un sistema comprometido. Por ejemplo, si un atacante detecta que un archivo está ejecutado por el usuario "root" a través de una tarea cron que se ejecuta a intervalos regulares de tiempo, y se da cuenta de que los permisos definidos en el archivo están mal configurados, podría manipular el contenido del mismo para incluir instrucciones maliciosas las cuales serían ejecutadas de forma privilegiada como el usuario 'root', dado que corresponde al usuario que está ejecutando dicho archivo. </p></div><div><p>Para detectar tareas cron, los atacantes pueden utilizar <a data-href="⚒ Herramientas ⚒" href="notes/4.-cybersecurity/redteam/pentesting/sistemas/herramientas/⚒-herramientas-⚒.html" class="internal-link" target="_self" rel="noopener">⚒ Herramientas ⚒</a> como <strong>Pspy</strong>. Pspy es un herramienta de línea de comandos que monitorea las tareas que se ejecutan en segundo plano en un sistema Unix/Linux y muestra las nuevas tareas que se inician.</p></div></div></div><div class="heading-wrapper"><h1 data-heading="Evitar la explotación de tareas Cron:" class="heading" id="Evitar_la_explotación_de_tareas_Cron:">Evitar la explotación de tareas Cron:</h1><div class="heading-children"><div><ul>
<li data-line="0">
<h3 data-heading="**Limitar el número de tareas cron:** es importante limitar el número de tareas cron que se ejecutan en el sistema y asegurarse de que solo se otorgan permisos a tareas que requieren permisos especiales para funcionar correctamente. Esto disminuye la superficie de ataque y reduce las posibilidades de que un atacante puede encontrar una tarea cron vulnerable." class="heading" id="**Limitar_el_número_de_tareas_cron:**_es_importante_limitar_el_número_de_tareas_cron_que_se_ejecutan_en_el_sistema_y_asegurarse_de_que_solo_se_otorgan_permisos_a_tareas_que_requieren_permisos_especiales_para_funcionar_correctamente._Esto_disminuye_la_superficie_de_ataque_y_reduce_las_posibilidades_de_que_un_atacante_puede_encontrar_una_tarea_cron_vulnerable."><strong>Limitar el número de tareas cron:</strong> es importante limitar el número de tareas cron que se ejecutan en el sistema y asegurarse de que solo se otorgan permisos a tareas que requieren permisos especiales para funcionar correctamente. Esto disminuye la superficie de ataque y reduce las posibilidades de que un atacante puede encontrar una tarea cron vulnerable.</h3>
</li>
<li data-line="1">
<h3 data-heading="**Verificar los permisos de las tareas cron:** es importante revisar los permisos de las tareas cron para asegurarse de que solo se otorgan permisos a usuarios y grupos autorizados. Además, se recomienda evitar otorgar permisos de superusuario a las tareas cron, a menos que se estrictamente necesario." class="heading" id="**Verificar_los_permisos_de_las_tareas_cron:**_es_importante_revisar_los_permisos_de_las_tareas_cron_para_asegurarse_de_que_solo_se_otorgan_permisos_a_usuarios_y_grupos_autorizados._Además,_se_recomienda_evitar_otorgar_permisos_de_superusuario_a_las_tareas_cron,_a_menos_que_se_estrictamente_necesario."><strong>Verificar los permisos de las tareas cron:</strong> es importante revisar los permisos de las tareas cron para asegurarse de que solo se otorgan permisos a usuarios y grupos autorizados. Además, se recomienda evitar otorgar permisos de superusuario a las tareas cron, a menos que se estrictamente necesario.</h3>
</li>
<li data-line="2">
<h3 data-heading="**Supervisar regularmente el sistema:** es importante monitorear regularmente el sistema para detectar cambios inesperados en las tareas cron y para buscar posibles brechas de seguridad. Además, se recomienda utilizar herramientas de monitoreo de seguridad para detectar actividades sospechosas en el sistema." class="heading" id="**Supervisar_regularmente_el_sistema:**_es_importante_monitorear_regularmente_el_sistema_para_detectar_cambios_inesperados_en_las_tareas_cron_y_para_buscar_posibles_brechas_de_seguridad._Además,_se_recomienda_utilizar_herramientas_de_monitoreo_de_seguridad_para_detectar_actividades_sospechosas_en_el_sistema."><strong>Supervisar regularmente el sistema:</strong> es importante monitorear regularmente el sistema para detectar cambios inesperados en las tareas cron y para buscar posibles brechas de seguridad. Además, se recomienda utilizar herramientas de monitoreo de seguridad para detectar actividades sospechosas en el sistema.</h3>
</li>
<li data-line="3">
<h3 data-heading="**Configurar los registros de la tarea cron:** se recomienda habilitar la opción de registro para las tareas cron, para poder identificar cualquier actividad sospechosa en las tareas definidas y para poder llevar un registro de las actividades  realizadas por cada una de estas." class="heading" id="**Configurar_los_registros_de_la_tarea_cron:**_se_recomienda_habilitar_la_opción_de_registro_para_las_tareas_cron,_para_poder_identificar_cualquier_actividad_sospechosa_en_las_tareas_definidas_y_para_poder_llevar_un_registro_de_las_actividades__realizadas_por_cada_una_de_estas."><strong>Configurar los registros de la tarea cron:</strong> se recomienda habilitar la opción de registro para las tareas cron, para poder identificar cualquier actividad sospechosa en las tareas definidas y para poder llevar un registro de las actividades  realizadas por cada una de estas.</h3>
</li>
</ul></div></div></div><div class="heading-wrapper"><h1 data-heading="Escalada" class="heading" id="Escalada">Escalada</h1><div class="heading-children"><div><p>Para detectar tareas cron podríamos crearnos un propio script como así también hacer uso de <strong>Pspy</strong>, ambas maneras son validas ya que la finalidad de esto es detectar tareas que se ejecutan en segundo plano para de esta manera terminar dando con tareas cron que se pudiesen estar ejecutando en el sistema.</p></div><div><p>Para listar tareas cron también podemos usar el comando <strong>crontab -l</strong> (Esto solo lista las tareas cron del usuario en uso, por lo que tareas cron de otro usuario no nos saldrían), para ver más tareas cron podríamos hacerlo en la ruta <strong>/etc/cron.d</strong> pero en esta ruta tampoco tiene por que estar todas las tareas cron a nivel de sistema </p></div><div class="heading-wrapper"><h4 data-heading="Script de monitoreo" class="heading" id="Script_de_monitoreo"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Script de monitoreo</h4><div class="heading-children"><div><pre class="language-bash" tabindex="0"><code class="language-bash is-loaded"><span class="token shebang important">#!/bin/bash</span>

<span class="token keyword">function</span> <span class="token function-name function">ctrl_c</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token builtin class-name">echo</span> -e <span class="token string">"<span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span><span class="token entity" title="\t">\t</span>[!] Quiting....<span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span>"</span>
	<span class="token builtin class-name">exit</span> <span class="token number">1</span> 
<span class="token punctuation">}</span>

<span class="token builtin class-name">trap</span> ctrl_c SIGINT

<span class="token assign-left variable">old_process</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span>/usr/bin/ps -eo user,command<span class="token variable">)</span></span>

<span class="token keyword">while</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
	<span class="token assign-left variable">new_process</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span>/usr/bin/ps -eo user,command<span class="token variable">)</span></span>
	<span class="token function">diff</span> <span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable">$old_process</span>"</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable">$new_process</span>"</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">"[\&gt;\&lt;]"</span> <span class="token operator">|</span> <span class="token function">grep</span> -vE <span class="token string">"kworker|{nombre_script}|command"</span>
	<span class="token assign-left variable">old_process</span><span class="token operator">=</span><span class="token variable">$new_process</span>
<span class="token keyword">done</span> 

</code><button class="copy-code-button">Copy</button></pre></div></div></div><div class="heading-wrapper"><h4 data-heading="[Pspy](https://github.com/DominicBreuker/pspy)" class="heading" id="[Pspy](https://github.com/DominicBreuker/pspy)"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><a data-tooltip-position="top" aria-label="https://github.com/DominicBreuker/pspy" rel="noopener" class="external-link" href="https://github.com/DominicBreuker/pspy" target="_blank">Pspy</a></h4><div class="heading-children"><div><p>Una vez localizadas las tareas cron que pudiesen estar corriendo por el sistema, solo queda ver si puede llegar a ser vulnerable para posteriormente explotarlas.</p></div><div class="mod-footer"></div></div></div></div></div></div></div></div><div class="sidebar-right sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content"><div class="graph-view-wrapper"><div class="sidebar-section-header">Interactive Graph</div><div class="graph-view-placeholder">
		<div class="graph-view-container">
			<div class="graph-icon graph-expand" role="button" aria-label="Expand" data-tooltip-position="top"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><line x1="7" y1="17" x2="17" y2="7"></line><polyline points="7 7 17 7 17 17"></polyline></svg></div>
			<canvas id="graph-canvas" class="hide" width="512px" height="512px"></canvas>
		</div>
		</div></div><div class="tree-container mod-root nav-folder tree-item outline-tree" data-depth="0"><div class="tree-header"><span class="sidebar-section-header">Table Of Contents</span><button class="clickable-icon collapse-tree-button" aria-label="Collapse All"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></svg></button></div><div class="tree-scroll-area tree-item-children nav-folder-children"><div class="tree-item mod-tree-folder nav-folder mod-collapsible is-collapsed" style="display: none;"></div><div class="tree-item" data-depth="1"><a class="tree-link" href="notes\4.-cybersecurity\redteam\pentesting\sistemas\2.-fases-auditoria\3.-escalada-de-privilegios\detección-y-explotación-de-tareas-cron.html#Detección y explotación de tareas Cron"><div class="tree-item-contents heading-link" heading-name="Detección y explotación de tareas Cron"><span class="tree-item-title">Detección y explotación de tareas Cron</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="1"><a class="tree-link" href="notes\4.-cybersecurity\redteam\pentesting\sistemas\2.-fases-auditoria\3.-escalada-de-privilegios\detección-y-explotación-de-tareas-cron.html#Evitar_la_explotación_de_tareas_Cron:"><div class="tree-item-contents heading-link" heading-name="Evitar la explotación de tareas Cron:"><span class="tree-item-title">Evitar la explotación de tareas Cron:</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="3"><a class="tree-link" href="notes\4.-cybersecurity\redteam\pentesting\sistemas\2.-fases-auditoria\3.-escalada-de-privilegios\detección-y-explotación-de-tareas-cron.html#**Limitar_el_número_de_tareas_cron:**_es_importante_limitar_el_número_de_tareas_cron_que_se_ejecutan_en_el_sistema_y_asegurarse_de_que_solo_se_otorgan_permisos_a_tareas_que_requieren_permisos_especiales_para_funcionar_correctamente._Esto_disminuye_la_superficie_de_ataque_y_reduce_las_posibilidades_de_que_un_atacante_puede_encontrar_una_tarea_cron_vulnerable."><div class="tree-item-contents heading-link" heading-name="**Limitar el número de tareas cron:** es importante limitar el número de tareas cron que se ejecutan en el sistema y asegurarse de que solo se otorgan permisos a tareas que requieren permisos especiales para funcionar correctamente. Esto disminuye la superficie de ataque y reduce las posibilidades de que un atacante puede encontrar una tarea cron vulnerable."><span class="tree-item-title"><strong>Limitar el número de tareas cron:</strong> es importante limitar el número de tareas cron que se ejecutan en el sistema y asegurarse de que solo se otorgan permisos a tareas que requieren permisos especiales para funcionar correctamente. Esto disminuye la superficie de ataque y reduce las posibilidades de que un atacante puede encontrar una tarea cron vulnerable.</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="notes\4.-cybersecurity\redteam\pentesting\sistemas\2.-fases-auditoria\3.-escalada-de-privilegios\detección-y-explotación-de-tareas-cron.html#**Verificar_los_permisos_de_las_tareas_cron:**_es_importante_revisar_los_permisos_de_las_tareas_cron_para_asegurarse_de_que_solo_se_otorgan_permisos_a_usuarios_y_grupos_autorizados._Además,_se_recomienda_evitar_otorgar_permisos_de_superusuario_a_las_tareas_cron,_a_menos_que_se_estrictamente_necesario."><div class="tree-item-contents heading-link" heading-name="**Verificar los permisos de las tareas cron:** es importante revisar los permisos de las tareas cron para asegurarse de que solo se otorgan permisos a usuarios y grupos autorizados. Además, se recomienda evitar otorgar permisos de superusuario a las tareas cron, a menos que se estrictamente necesario."><span class="tree-item-title"><strong>Verificar los permisos de las tareas cron:</strong> es importante revisar los permisos de las tareas cron para asegurarse de que solo se otorgan permisos a usuarios y grupos autorizados. Además, se recomienda evitar otorgar permisos de superusuario a las tareas cron, a menos que se estrictamente necesario.</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="notes\4.-cybersecurity\redteam\pentesting\sistemas\2.-fases-auditoria\3.-escalada-de-privilegios\detección-y-explotación-de-tareas-cron.html#**Supervisar_regularmente_el_sistema:**_es_importante_monitorear_regularmente_el_sistema_para_detectar_cambios_inesperados_en_las_tareas_cron_y_para_buscar_posibles_brechas_de_seguridad._Además,_se_recomienda_utilizar_herramientas_de_monitoreo_de_seguridad_para_detectar_actividades_sospechosas_en_el_sistema."><div class="tree-item-contents heading-link" heading-name="**Supervisar regularmente el sistema:** es importante monitorear regularmente el sistema para detectar cambios inesperados en las tareas cron y para buscar posibles brechas de seguridad. Además, se recomienda utilizar herramientas de monitoreo de seguridad para detectar actividades sospechosas en el sistema."><span class="tree-item-title"><strong>Supervisar regularmente el sistema:</strong> es importante monitorear regularmente el sistema para detectar cambios inesperados en las tareas cron y para buscar posibles brechas de seguridad. Además, se recomienda utilizar herramientas de monitoreo de seguridad para detectar actividades sospechosas en el sistema.</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="notes\4.-cybersecurity\redteam\pentesting\sistemas\2.-fases-auditoria\3.-escalada-de-privilegios\detección-y-explotación-de-tareas-cron.html#**Configurar_los_registros_de_la_tarea_cron:**_se_recomienda_habilitar_la_opción_de_registro_para_las_tareas_cron,_para_poder_identificar_cualquier_actividad_sospechosa_en_las_tareas_definidas_y_para_poder_llevar_un_registro_de_las_actividades__realizadas_por_cada_una_de_estas."><div class="tree-item-contents heading-link" heading-name="**Configurar los registros de la tarea cron:** se recomienda habilitar la opción de registro para las tareas cron, para poder identificar cualquier actividad sospechosa en las tareas definidas y para poder llevar un registro de las actividades  realizadas por cada una de estas."><span class="tree-item-title"><strong>Configurar los registros de la tarea cron:</strong> se recomienda habilitar la opción de registro para las tareas cron, para poder identificar cualquier actividad sospechosa en las tareas definidas y para poder llevar un registro de las actividades  realizadas por cada una de estas.</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div><div class="tree-item" data-depth="1"><a class="tree-link" href="notes\4.-cybersecurity\redteam\pentesting\sistemas\2.-fases-auditoria\3.-escalada-de-privilegios\detección-y-explotación-de-tareas-cron.html#Escalada"><div class="tree-item-contents heading-link" heading-name="Escalada"><span class="tree-item-title">Escalada</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="4"><a class="tree-link" href="notes\4.-cybersecurity\redteam\pentesting\sistemas\2.-fases-auditoria\3.-escalada-de-privilegios\detección-y-explotación-de-tareas-cron.html#Script_de_monitoreo"><div class="tree-item-contents heading-link" heading-name="Script de monitoreo"><span class="tree-item-title">Script de monitoreo</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-link" href="notes\4.-cybersecurity\redteam\pentesting\sistemas\2.-fases-auditoria\3.-escalada-de-privilegios\detección-y-explotación-de-tareas-cron.html#[Pspy](https://github.com/DominicBreuker/pspy)"><div class="tree-item-contents heading-link" heading-name="[Pspy](https://github.com/DominicBreuker/pspy)"><span class="tree-item-title"><a data-tooltip-position="top" aria-label="https://github.com/DominicBreuker/pspy" rel="noopener" class="external-link" href="https://github.com/DominicBreuker/pspy" target="_blank">Pspy</a></span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div></div></div></div><script defer="">let rs = document.querySelector(".sidebar-right"); rs.classList.add("is-collapsed"); if (window.innerWidth > 768) rs.classList.remove("is-collapsed"); rs.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-right-width"));</script></div></div></body></html>